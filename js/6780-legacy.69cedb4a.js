"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[6780],{8417:function(e,t,n){var r=n(50124),s=n(48534),a=n(13087),o=n(62833),i=(n(60228),n(47522),n(34338),n(24150)),u=n(66252),l=n(79940),c=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,[{key:"create",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new FormData,n.append("body",t.body),n.append("type",t.type),n.append("timeline_id",t.timeline_id),t.media&&t.media.forEach((function(e){n.append("media[]",e)})),t.tags&&t.tags.forEach((function(e){n.append("tags[]",e)})),t.votes&&t.votes.forEach((function(e){n.append("votes[]",e)})),e.prev=7,e.next=10,i.hi.post("/posts",n,{headers:{"Content-type":"multipart/form-data"}});case 10:return s=e.sent,e.abrupt("return",s.data);case 14:e.prev=14,e.t0=e["catch"](7),(0,u.S3)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[7,14]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.delete("/posts/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getPostById",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,l.F)(e.t0,"PostService.getPostById");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updatePostById",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n,s,a,o){var u;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return u=new FormData,u.append("image",o),u.append("type",s),u.append("timeline_id",a),u.append("body",t),u.append("user_id",n),e.prev=6,e.next=9,i.hi.post("/post/update",{formData:u});case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e["catch"](6),e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));function t(t,n,r,s,a){return e.apply(this,arguments)}return t}()},{key:"getPostsForMainPage",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/home?page=".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCurrentWeekSupportPost",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/current-week-support");case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"postsByTimelineId",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var s;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/timeline/".concat(t,"?page=").concat(n));case 3:return s=e.sent,e.abrupt("return",s.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getAnnouncements",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/announcements?page=".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSupportPosts",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/support?page=".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"contolComments",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.patch("/posts/".concat(t,"/control-comments"));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"pinPost",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.patch("/posts/pin/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getLastSupportPost",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.get("/posts/support/latest");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getPendingPosts",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s,a=arguments;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",e.prev=1,e.next=4,i.hi.get("/posts/pending/timeline/".concat(t,"/").concat(n));case 4:return s=e.sent,e.abrupt("return",s.data);case 8:e.prev=8,e.t0=e["catch"](1),(0,l.F)(e.t0,"PostService.getPendingPosts");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"acceptPost",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.patch("/posts/accept/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"declinePost",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.hi.patch("/posts/decline/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t.Z=new c},12174:function(e,t,n){var r=n(50124),s=n(48534),a=n(13087),o=n(62833),i=(n(34338),n(66252)),u=n(24150),l=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,[{key:"create",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.post("/poll-votes",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,i.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getPostVotesUsers",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s,a=arguments;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",e.prev=1,e.next=4,u.hi.get("/poll-votes/posts/".concat(t,"/users/").concat(n));case 4:return s=e.sent,e.abrupt("return",s.data);case 8:e.prev=8,e.t0=e["catch"](1),(0,i.S3)(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t.Z=new l},66107:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(66252),s=n(3577),a=n(49963),o={class:"mt-3"},i=["innerHTML"],u={key:0,class:"mt-3"},l={class:"poll-input d-flex justify-content-around align-items-center w-100 h-100"},c=["id","value","disabled"],d=["for"],p={class:"me-2 text-primary bold-600"};function v(e,t,n,v,h,f){var g,m=(0,r.up)("progressbar");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",o,[(0,r._)("p",{style:{"white-space":"pre-wrap",direction:"rtl"},innerHTML:f.urlifyFn(h.shortPostText)},null,8,i),f.isMore?((0,r.wg)(),(0,r.iD)("a",{key:0,dir:"ltr",role:"button",class:"load-btn",onClick:t[0]||(t[0]=function(){return f.loadMoreBriefText&&f.loadMoreBriefText.apply(f,arguments)})},"...قراءة المزيد")):(0,r.kq)("",!0),f.isLess?((0,r.wg)(),(0,r.iD)("a",{key:1,dir:"ltr",role:"button",class:"load-btn",onClick:t[1]||(t[1]=function(){return f.loadLessBriefText&&f.loadLessBriefText.apply(f,arguments)})},"قراءة أقل")):(0,r.kq)("",!0)]),null!==(g=f.post.pollOptions)&&void 0!==g&&g.length?((0,r.wg)(),(0,r.iD)("div",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(f.post.pollOptions,(function(e){return(0,r.wg)(),(0,r.iD)("div",{class:"progress my-2 border border-light rounded bg-transparent",key:e.id},[(0,r.Wm)(m,{style:(0,s.j5)({width:f.getOptionVotesPercentage(e.id)}),class:"progress-bar",className:"rounded","aria-valuemin":"0","aria-valuemax":"100"},null,8,["style"]),(0,r._)("div",l,[(0,r.wy)((0,r._)("input",{type:"radio",id:e.id,value:e.id,"onUpdate:modelValue":t[2]||(t[2]=function(e){return h.choosedOption=e}),class:"ms-1 mt-0",onChange:t[3]||(t[3]=function(){return f.vote&&f.vote.apply(f,arguments)}),disabled:!f.post.allow_comments},null,40,c),[[a.G2,h.choosedOption]]),(0,r._)("label",{for:e.id,class:"form-check-label flex-grow-1 text-truncate ms-2 align-right"},(0,s.zw)(e.option),9,d),(0,r._)("span",p,(0,s.zw)(f.getOptionVotesPercentage(e.id)),1)])])})),128))])):(0,r.kq)("",!0)],64)}var h=n(50124),f=n(48534),g=(n(89730),n(25728),n(60228),n(64043),n(57267),n(12174)),m=n(31025),w={name:"PostBody",inject:{voteOnPost:{default:function(){}},post:{required:!0}},data:function(){return{choosedOption:"",errorMessage:"",fullPostText:"",shortPostText:""}},mounted:function(){this.post.pollOptions.length>0&&(this.choosedOption=this.getSelectedOptionId())},created:function(){var e,t;this.fullPostText=null===(e=this.post)||void 0===e?void 0:e.body,this.shortPostText=null===(t=this.fullPostText)||void 0===t?void 0:t.slice(0,200)},methods:{vote:function(){var e=this;return(0,f.Z)((0,h.Z)().mark((function t(){var n,r,s,a,o;return(0,h.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={option_id:e.choosedOption,post_id:e.post.id},t.prev=1,t.next=4,g.Z.create(n);case 4:if(r=t.sent,200===r.statusCode){t.next=8;break}return m.Z.toggleToast("حدث خطأ ما, حاول مرة أخرى","error"),t.abrupt("return");case 8:if(s=r.data,s){t.next=11;break}return t.abrupt("return");case 11:a=e.getSelectedOptionId(),e.voteOnPost({option_id:e.choosedOption,post_id:e.post.id,old_option_id:a,status:s}),t.next=26;break;case 15:if(t.prev=15,t.t0=t["catch"](1),console.log("[vote error]",t.t0),e.choosedOption="",null===(o=t.t0.response)||void 0===o||null===(o=o.data)||void 0===o||!o.message){t.next=24;break}return m.Z.toggleToast(t.t0.response.data.message,"error"),t.abrupt("return");case 24:return m.Z.toggleToast("حدث خطأ ما, حاول مرة أخرى","error"),t.abrupt("return");case 26:case"end":return t.stop()}}),t,null,[[1,15]])})))()},getOptionVotesPercentage:function(e){var t=this.post.votes_count,n=this.post.pollOptions.find((function(t){return t.id===e})).votes_count;if(0===t)return"0%";var r=Math.round(n/t*100);return"".concat(r,"%")},getSelectedOptionId:function(){var e=this.post.pollOptions.find((function(e){return!0===e.selected_by_user}));return e?e.id:""},urlifyFn:function(e){if(e){var t=/(https?:\/\/[^\s]+)/g;return e.replace(t,(function(e){return'<a href="'+e+'"  target="_blank" direction: rtl;">'+e+"</a>"}))}},loadMoreBriefText:function(){this.shortPostText=this.fullPostText},loadLessBriefText:function(){var e;this.shortPostText=null===(e=this.fullPostText)||void 0===e?void 0:e.slice(0,200)}},computed:{isMore:function(){var e,t;return(null===(e=this.shortPostText)||void 0===e?void 0:e.length)<(null===(t=this.fullPostText)||void 0===t?void 0:t.length)},isLess:function(){var e,t,n;return(null===(e=this.shortPostText)||void 0===e?void 0:e.length)>=(null===(t=this.fullPostText)||void 0===t?void 0:t.length)&&(null===(n=this.fullPostText)||void 0===n?void 0:n.length)>200}}},y=n(83744);const b=(0,y.Z)(w,[["render",v],["__scopeId","data-v-a8465150"]]);var k=b},11035:function(e,t,n){n.d(t,{Z:function(){return W}});var r=n(66252),s=n(3577),a=n(49963),o=function(e){return(0,r.dD)("data-v-881e41a6"),e=e(),(0,r.Cn)(),e},i={key:0,class:"user-post"},u={class:"row g-2"},l=["onClick"],c=["src"],d={key:0,class:"overlay",role:"button"},p=o((function(){return(0,r._)("span",{class:"material-symbols-outlined"}," add ",-1)})),v=o((function(){return(0,r._)("span",{class:"ms-1"}," المزيد",-1)}));function h(e,t,n,o,h,f){var g=(0,r.up)("PostMediaModal");return(0,r.wg)(),(0,r.iD)(r.HY,null,[f.slicedMedia?((0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(f.slicedMedia,(function(e,t){var n,o;return(0,r.wg)(),(0,r.iD)("div",{class:(0,s.C_)(["position-relative",f.col]),key:e.path,onClick:(0,a.iM)((function(e){return f.showPostMedia(t)}),["prevent"])},[(0,r._)("img",{src:e.path,alt:"post-image",class:"rounded w-100 h-100 post-image",style:{"object-fit":"cover"}},null,8,c),(null===(n=f.post.media)||void 0===n?void 0:n.length)>f.slicedMedia.length&&t===f.slicedMedia.length-1?((0,r.wg)(),(0,r.iD)("div",d,[p,(0,r._)("span",null,(0,s.zw)((null===(o=f.post.media)||void 0===o?void 0:o.length)-f.slicedMedia.length),1),v])):(0,r.kq)("",!0)],10,l)})),128))])])):(0,r.kq)("",!0),(0,r.Wm)(g,{ref:"postMediaModal"},null,512)],64)}n(89730);var f={href:"javascript:void(0);",class:"lh-1","data-bs-dismiss":"modal",ref:"galleryModalCloseBtn"},g=(0,r._)("span",{class:"material-symbols-outlined"},"close",-1),m=[g],w={class:"col-12"},y=["id"],b={class:"carousel-indicators"},k=["data-bs-target","data-bs-slide-to","aria-current","aria-label"],x={class:"carousel-inner h-100"},_={class:"d-flex justify-content-center align-items-center h-100"},Z=["href"],P=["src","alt"],M=["data-bs-target"],T=(0,r._)("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),C=(0,r._)("span",{class:"visually-hidden"},"Previous",-1),D=[T,C],S=["data-bs-target"],O=(0,r._)("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),B=(0,r._)("span",{class:"visually-hidden"},"Next",-1),U=[O,B];function I(e,t,n,a,o,i){var u=(0,r.up)("model-header"),l=(0,r.up)("model-body"),c=(0,r.up)("modal");return(0,r.wg)(),(0,r.j4)(c,{ref:"galleryModalRef",id:"galleryModal-".concat(i.post.id),dialogClass:"modal-lg modal-dialog-centered",tabindex:"-1","aria-labelledby":"galleryModalLabel-".concat(i.post.id),"aria-hidden":!0},{default:(0,r.w5)((function(){return[(0,r.Wm)(u,null,{default:(0,r.w5)((function(){return[(0,r._)("a",f,m,512)]})),_:1}),(0,r.Wm)(l,{style:{"background-color":"#eee"}},{default:(0,r.w5)((function(){return[(0,r._)("div",w,[(0,r._)("div",{id:"gallery-".concat(i.post.id),class:"carousel slide carousel-dark","data-bs-ride":"carousel",style:{height:"60vh"}},[(0,r._)("div",b,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.post.media,(function(e,t){return(0,r.wg)(),(0,r.iD)("button",{key:e.id,type:"button","data-bs-target":"#gallery-".concat(i.post.id),"data-bs-slide-to":t,"aria-current":t===o.currentMediaIndex,"aria-label":"Slide ".concat(t+1),class:(0,s.C_)({active:t===o.currentMediaIndex})},null,10,k)})),128))]),(0,r._)("div",x,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.post.media,(function(e,t){return(0,r.wg)(),(0,r.iD)("div",{class:(0,s.C_)(["carousel-item mx-auto h-100",{active:t===o.currentMediaIndex}]),key:e.id},[(0,r._)("div",_,[(0,r._)("a",{href:e.path,target:"_blank"},[(0,r._)("img",{src:e.path,class:"d-block h-100 img-fluid",alt:"Post Image ".concat(t+1)},null,8,P)],8,Z)])],2)})),128))]),(0,r._)("button",{class:"carousel-control-prev",type:"button","data-bs-target":"#gallery-".concat(i.post.id),"data-bs-slide":"next"},D,8,M),(0,r._)("button",{class:"carousel-control-next",type:"button","data-bs-target":"#gallery-".concat(i.post.id),"data-bs-slide":"prev"},U,8,S)],8,y)])]})),_:1})]})),_:1},8,["id","aria-labelledby"])}var q=n(79909),F={name:"PostMediaModal",inject:["post"],data:function(){return{galleryModal:null,currentMediaIndex:0}},mounted:function(){this.galleryModal=new q.u_(this.$refs.galleryModalRef.$el)},methods:{showPostMedia:function(e){this.galleryModal.show(),this.currentMediaIndex=e}}},z=n(83744);const L=(0,z.Z)(F,[["render",I]]);var j=L,H={name:"PostMedia",components:{PostMediaModal:j},inject:["post"],computed:{col:function(){return this.post.media.length>1?"col-6":"col-12"},slicedMedia:function(){return this.post.media?this.post.media.slice(0,4):[]}},methods:{showPostMedia:function(e){this.$refs.postMediaModal.showPostMedia(e)}}};const $=(0,z.Z)(H,[["render",h],["__scopeId","data-v-881e41a6"]]);var W=$},34932:function(e,t,n){n.d(t,{Z:function(){return S}});var r=n(66252),s=n(3577),a=n(49963),o={class:"user-post-data"},i={class:"d-flex justify-content-between"},u={class:"d-flex align-items-center"},l={key:0,class:"material-symbols-outlined ms-1"},c={key:1,class:"ms-1 text-white badge bg-danger rounded-pill px-2"},d={key:0,class:"card-post-toolbar"},p=(0,r._)("span",{class:"material-symbols-outlined"}," more_horiz ",-1),v=[p],h=(0,r._)("span",{class:"material-symbols-outlined me-2 md-18"}," push_pin ",-1),f={class:"material-symbols-outlined me-2 md-18"},g=["aria-disabled"],m=(0,r._)("span",{class:"material-symbols-outlined me-2 md-18"}," delete ",-1),w=(0,r._)("span",{class:"material-symbols-outlined me-2 md-18"}," cancel ",-1);function y(e,t,n,p,y,b){var k=(0,r.up)("tooltip"),x=(0,r.up)("PostUser");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r._)("div",i,[(0,r.Wm)(x,{post:b.post},{date:(0,r.w5)((function(){return[(0,r._)("div",u,[(0,r.Wm)(k,{tag:"p",class:"mb-0 text-primary",tooltipPlacement:"bottom","data-bs-toggle":"tooltip",title:e.formatFullDate(b.post.created_at),style:{width:"fit-content"},onClick:b.sendToPostPage},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,s.zw)(e.formatDateToWritten(b.post.created_at)),1)]})),_:1},8,["title","onClick"]),b.post.is_pinned?((0,r.wg)(),(0,r.iD)("span",l," push_pin ")):(0,r.kq)("",!0),"announcement"===b.post.type.toLowerCase()?((0,r.wg)(),(0,r.iD)("span",c,"إعلان")):(0,r.kq)("",!0)])]})),_:1},8,["post"]),b.byAuth||b.isAdmin?((0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("div",{class:"dropdown-toggle",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",role:"button",onClick:t[0]||(t[0]=function(e){return y.show=!y.show})},v),(0,r._)("div",{class:(0,s.C_)("dropdown-menu dropdown-menu-right ".concat(y.show?"show":"")),"aria-labelledby":"dropdownMenuButton",style:{}},[n.showPin?((0,r.wg)(),(0,r.iD)("a",{key:0,class:"dropdown-item d-flex align-items-center text-primary",href:"#",onClick:t[1]||(t[1]=(0,a.iM)((function(){return b.pin&&b.pin.apply(b,arguments)}),["prevent"]))},[h,(0,r.Uk)(" "+(0,s.zw)(b.post.is_pinned?"فك التثبيت":"تثبيت"),1)])):(0,r.kq)("",!0),(0,r._)("a",{class:"dropdown-item d-flex align-items-center text-primary",href:"#",onClick:t[2]||(t[2]=(0,a.iM)((function(){return b.closeComments&&b.closeComments.apply(b,arguments)}),["prevent"]))},[(0,r._)("span",f,(0,s.zw)(b.post.allow_comments?"comments_disabled":"comment"),1),(0,r.Uk)(" "+(0,s.zw)(b.post.allow_comments?"إغلاق":"فتح")+" التعليقات ",1)]),(0,r._)("a",{class:"dropdown-item d-flex align-items-center",href:"#",role:"button","aria-disabled":y.deleteLoading,onClick:t[3]||(t[3]=(0,a.iM)((function(){return b.deletePost&&b.deletePost.apply(b,arguments)}),["prevent"]))},[m,(0,r.Uk)("حذف")],8,g),(0,r._)("a",{class:"dropdown-item d-flex align-items-center",href:"#",onClick:t[4]||(t[4]=(0,a.iM)((function(e){return y.show=!1}),["prevent"]))},[w,(0,r.Uk)("إغلاق")])],2)])):(0,r.kq)("",!0)])])}var b=n(50124),k=n(48534),x=n(95082),_=(n(70560),n(31025)),Z=n(19947),P=n(8417),M=n(49579),T={name:"PostHeader",inject:{closePostComments:{default:function(){}},pinPost:{default:function(){}},postDelete:{default:function(){}},post:{required:!0}},components:{PostUser:Z.Z},props:{showPin:{type:Boolean,default:!1}},data:function(){return{show:!1,deleteLoading:!1}},computed:{byAuth:function(){return this.post.user.id===this.$store.getters.getUser.id},isAdmin:function(){return M.Z.hasRole(this.$store.getters.getUser,"admin")}},methods:(0,x.Z)((0,x.Z)({},_.Z),{},{closeComments:function(){var e=this;return(0,k.Z)((0,b.Z)().mark((function t(){return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P.Z.contolComments(e.post.id);case 3:e.closePostComments(e.post.id),e.post.allow_comments?e.toggleToast("تم فتح التعليقات","success"):e.toggleToast("تم إغلاق التعليقات","success"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.toggleToast("حدث خطأ ما, حاول مرة أخرى","error");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},pin:function(){var e=this;return(0,k.Z)((0,b.Z)().mark((function t(){var n,r;return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P.Z.pinPost(e.post.id);case 3:if(n=t.sent,200===n.statusCode){t.next=7;break}return e.toggleToast("حدث خطأ ما, حاول مرة أخرى","error"),t.abrupt("return");case 7:r="pinned"===n.data,e.pinPost(e.post.id,r),r?e.toggleToast("تم تثبيت المنشور","success"):e.toggleToast("تم فك التثبيت","success"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),e.toggleToast("حدث خطأ ما, حاول مرة أخرى","error");case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},deletePost:function(){var e=this;return(0,k.Z)((0,b.Z)().mark((function t(){var n;return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.deleteLoading){t.next=2;break}return t.abrupt("return");case 2:n=e.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-danger btn-lg ms-2"},buttonsStyling:!1}),n.fire({title:"هل أنت متأكد؟",text:"سيتم حذف هذا المنشور نهائياً!",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم, احذف!",cancelButtonText:"تراجع",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then(function(){var t=(0,k.Z)((0,b.Z)().mark((function t(n){return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.isConfirmed){t.next=15;break}return e.deleteLoading=!0,t.prev=2,t.next=5,P.Z.delete(e.post.id);case 5:e.postDelete(e.post.id),_.Z.handleSuccessSwal("تم حذف المنشور بنجاح"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),_.Z.handleErrorSwal("حدث خطأ أثناء الحذف, يرجى المحاولة مرة أخرى!");case 12:return t.prev=12,e.deleteLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[2,9,12,15]])})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})))()},sendToPostPage:function(){this.post.is_approved?this.$router.push({name:"osboha.post",params:{post_id:this.post.id}}):this.$router.push({name:"osboha.pendingPosts",params:{timeline_id:this.post.timeline.id,post_id:this.post.id}})}})},C=n(83744);const D=(0,C.Z)(T,[["render",y]]);var S=D},19947:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(66252),s=n(3577),a=n(49963),o=function(e){return(0,r.dD)("data-v-95a6144a"),e=e(),(0,r.Cn)(),e},i={class:"mx-2 flex-grow-1"},u={class:"author-friends p-0 m-0"},l={class:"mx-1"},c=o((function(){return(0,r._)("span",{class:"mx-1"}," مع ",-1)})),d=["onClick"],p={key:0,class:"mx-1"},v={key:1};function h(e,t,n,o,h,f){var g,m,w,y,b,k,x,_,Z,P,M,T=(0,r.up)("BaseAvatar");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(T,{profileImg:null===(g=f.userProfile)||void 0===g?void 0:g.profile_picture,profile_id:null===(m=f.userProfile)||void 0===m?void 0:m.id,title:null===(w=n.post.user)||void 0===w?void 0:w.name,gender:null===(y=n.post.user)||void 0===y?void 0:y.gender,avatarClass:"avatar-50 rounded-circle"},null,8,["profileImg","profile_id","title","gender"]),(0,r._)("div",i,[(0,r._)("div",u,[(0,r._)("span",{class:(0,s.C_)(["author-name",{"hover-undelined":f.authUser.id!=(null===(b=n.post.user)||void 0===b?void 0:b.id)}]),role:"button",onClick:t[0]||(t[0]=(0,a.iM)((function(e){var t,r;return f.authUser.id!=(null===(t=n.post.user)||void 0===t?void 0:t.id)?f.sendToProfile(null===(r=n.post.user)||void 0===r?void 0:r.id):null}),["prevent"]))},(0,s.zw)(null===(k=n.post.user)||void 0===k?void 0:k.name),3),n.post.timeline&&(n.post.timeline.user&&n.post.timeline.user.id!=(null===(x=n.post.user)||void 0===x?void 0:x.id)||n.post.timeline.group)?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[(0,r._)("span",l,(0,s.zw)(n.post.timeline.user?"عند":"في"),1),n.post.timeline.user&&n.post.timeline.user.id!=(null===(_=n.post.user)||void 0===_?void 0:_.id)?((0,r.wg)(),(0,r.iD)("span",{key:0,class:"author-name hover-undelined",role:"button",onClick:t[1]||(t[1]=(0,a.iM)((function(e){var t;return f.sendToProfile(null===(t=n.post.timeline)||void 0===t||null===(t=t.user)||void 0===t?void 0:t.id)}),["prevent"]))},(0,s.zw)(null!==(Z=n.post.timeline.user.name)&&void 0!==Z?Z:""),1)):n.post.timeline.group?((0,r.wg)(),(0,r.iD)("span",{key:1,class:"author-name hover-undelined",role:"button",onClick:t[2]||(t[2]=(0,a.iM)((function(e){return f.sendToGroup(n.post.timeline.group.id)}),["prevent"]))},(0,s.zw)(null!==(P=n.post.timeline.group.name)&&void 0!==P?P:""),1)):(0,r.kq)("",!0)],64)):(0,r.kq)("",!0),null!==(M=n.post.taggedUsers)&&void 0!==M&&M.length?((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[c,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(f.slicedTaggedFriends,(function(o,i){var u,l,c,h,g;return(0,r.wg)(),(0,r.iD)("span",{key:o.id},[(0,r._)("span",{class:"author-name hover-undelined",role:"button",onClick:(0,a.iM)((function(e){return f.sendToProfile(o.user.id)}),["prevent"])},(0,s.zw)(null!==(u=null===(l=o.user)||void 0===l?void 0:l.name)&&void 0!==u?u:""),9,d),i!==f.slicedTaggedFriends.length-1||(null===(c=n.post.taggedUsers)||void 0===c?void 0:c.length)>f.slicedTaggedFriends.length?((0,r.wg)(),(0,r.iD)("span",p,"و")):(0,r.kq)("",!0),i===f.slicedTaggedFriends.length-1?((0,r.wg)(),(0,r.iD)("span",v,[(null===(h=n.post.taggedUsers)||void 0===h?void 0:h.length)>f.slicedTaggedFriends.length?((0,r.wg)(),(0,r.iD)("span",{key:0,class:"author-name hover-undelined",role:"button",onClick:t[3]||(t[3]=(0,a.iM)((function(){return e.getFriends&&e.getFriends.apply(e,arguments)}),["prevent"]))},(0,s.zw)((null===(g=n.post.taggedUsers)||void 0===g?void 0:g.length)-f.slicedTaggedFriends.length)+" أكثر",1)):(0,r.kq)("",!0)])):(0,r.kq)("",!0)])})),128))],64)):(0,r.kq)("",!0)]),(0,r.WI)(e.$slots,"date",{},void 0,!0)])],64)}n(89730),n(70560);var f={name:"PostUser",props:{post:{type:Object,required:!0}},computed:{slicedTaggedFriends:function(){var e;return null===(e=this.post.taggedUsers)||void 0===e?void 0:e.slice(0,3)},profile_picture:function(){var e,t=n(29822),r=n(48934),s=null===(e=this.post.user)||void 0===e||null===(e=e.gender)||void 0===e?void 0:e.toLowerCase();return"female"===s?t:r},authUser:function(){return this.$store.getters.getUser},userProfile:function(){var e,t,n;return null!==(e=null===(t=this.post)||void 0===t||null===(t=t.user)||void 0===t?void 0:t.profile)&&void 0!==e?e:null===(n=this.post)||void 0===n||null===(n=n.user)||void 0===n?void 0:n.user_profile}},methods:{sendToProfile:function(e){this.$router.push({name:"user.profile",params:{user_id:e}})},sendToGroup:function(e){this.$router.push({name:"group.group-detail",params:{group_id:e}})}}},g=n(83744);const m=(0,g.Z)(f,[["render",h],["__scopeId","data-v-95a6144a"]]);var w=m},29822:function(e,t,n){e.exports=n.p+"img/avatar-04.f7603e1d.jpg"},48934:function(e,t,n){e.exports=n.p+"img/avatar-05.5d33d3c7.jpg"}}]);
//# sourceMappingURL=6780-legacy.69cedb4a.js.map