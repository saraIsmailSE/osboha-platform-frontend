(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[3210],{20425:function(e){!function(t,o){e.exports=o()}(0,(function(){var e="__v-click-outside",t="undefined"!=typeof window,o="undefined"!=typeof navigator,n=t&&("ontouchstart"in window||o&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],i=function(e){var t=e.event,o=e.handler;(0,e.middleware)(t)&&o(t)},a=function(t,o){var a=function(e){var t="function"==typeof e;if(!t&&"object"!=typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||function(e){return e},events:e.events||n,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}}(o.value),s=a.handler,m=a.middleware,r=a.detectIframe,d=a.capture;if(a.isActive){if(t[e]=a.events.map((function(e){return{event:e,srcTarget:document.documentElement,handler:function(e){return function(e){var t=e.el,o=e.event,n=e.handler,a=e.middleware,s=o.path||o.composedPath&&o.composedPath();(s?s.indexOf(t)<0:!t.contains(o.target))&&i({event:o,handler:n,middleware:a})}({el:t,event:e,handler:s,middleware:m})},capture:d}})),r){var l={event:"blur",srcTarget:window,handler:function(e){return function(e){var t=e.el,o=e.event,n=e.handler,a=e.middleware;setTimeout((function(){var e=document.activeElement;e&&"IFRAME"===e.tagName&&!t.contains(e)&&i({event:o,handler:n,middleware:a})}),0)}({el:t,event:e,handler:s,middleware:m})},capture:d};t[e]=[].concat(t[e],[l])}t[e].forEach((function(o){var n=o.event,i=o.srcTarget,a=o.handler;return setTimeout((function(){t[e]&&i.addEventListener(n,a,d)}),0)}))}},s=function(t){(t[e]||[]).forEach((function(e){return e.srcTarget.removeEventListener(e.event,e.handler,e.capture)})),delete t[e]},m=t?{beforeMount:a,updated:function(e,t){var o=t.value,n=t.oldValue;JSON.stringify(o)!==JSON.stringify(n)&&(s(e),a(e,{value:o}))},unmounted:s}:{};return{install:function(e){e.directive("click-outside",m)},directive:m}}))},27522:function(e,t,o){"use strict";o(76265);var n=o(66252),i=o(24150);class a{async create(e){const t=new FormData;if(t.append("type",e.type),e.post_id&&t.append("post_id",e.post_id),e.book_id&&t.append("book_id",e.book_id),e.comment_id&&t.append("comment_id",e.comment_id),e.body&&t.append("body",e.body),e.screenShots&&e.screenShots.length>0)for(let n=0;n<e.screenShots.length;n++)t.append("screenShots[]",e.screenShots[n]);e.start_page&&t.append("start_page",e.start_page),e.end_page&&t.append("end_page",e.end_page),e.image&&t.append("image",e.image);try{const e=await i.hi.post("/comments",t,{headers:{"Content-type":"multipart/form-data"}});return e.data}catch(o){(0,n.S3)(o)}}async getPostComments(e,t,o=""){try{const n=await i.hi.get(`/comments/post/${e}/${o}?page=${t}`);return n.data}catch(a){(0,n.S3)(a)}}async getPostCommentsUsers(e){try{const t=await i.hi.get(`/comments/post/${e}/users`);return t.data}catch(t){(0,n.S3)(t)}}async update(e){const t=new FormData;if(t.append("u_comment_id",e.u_comment_id),e.body&&t.append("body",e.body),e.screenShots&&e.screenShots.length>0)for(let n=0;n<e.screenShots.length;n++)t.append("screenShots[]",e.screenShots[n]);e.start_page&&t.append("start_page",e.start_page),e.end_page&&t.append("end_page",e.end_page),e.image&&t.append("image",e.image);for(const n of t.entries())console.log(`${n[0]}, ${n[1]}`);try{const e=await i.hi.post("/comments/update",t,{"Content-type":"multipart/form-data"});return e.data}catch(o){(0,n.S3)(o)}}async delete(e){try{return await i.hi.delete(`/comments/${e}`)}catch(t){(0,n.S3)(t)}}}t.Z=new a},80932:function(e,t,o){"use strict";var n=o(66252),i=o(24150);class a{async getAllReactionTypes(){try{const e=await i.hi.get("/reactions/types");return e.data}catch(e){(0,n.S3)(e)}}getStoredReactions(){return JSON.parse(localStorage.getItem("reactions"))}async reactOnPost(e,t){try{const o=await i.hi.get(`/reactions/posts/${e}/types/${t}`);return o.data}catch(o){(0,n.S3)(o)}}async reactOnComment(e,t){try{const o=await i.hi.get(`/reactions/comments/${e}/types/${t}`);return o.data}catch(o){(0,n.S3)(o)}}async getPostReactionsUsers(e,t=""){try{const o=await i.hi.get(`/reactions/posts/${e}/users/${t}`);return o.data}catch(o){(0,n.S3)(o)}}}t.Z=new a},60351:function(e,t,o){"use strict";o.d(t,{So:function(){return n},Wx:function(){return a},b5:function(){return m},gg:function(){return s},jx:function(){return i}});const n={ambassador:"سفير",leader:"قائد",supervisor:"مراقب",advisor:"موجه",consultant:"مستشار",admin:"ادارة",book_quality_team:"جودة الكتب"},i={arabic:"اللغة العربية",english:"اللغة الانجليزية"},a={normal:"منهج",ramadan:"رمضان",young:"يافعين",kids:"أطفال",tafseer:"تفسير",free:"كتاب حر"},s={January:"يناير",February:"فبراير",March:"مارس",April:"ابريل",May:"مايو",June:"يونيو",July:"يوليو",August:"أغسطس",September:"سبتمبر",October:"أكتوبر",November:"نوفمبر",December:"ديسمبر"},m={"01":"يناير","02":"فبراير","03":"مارس","04":"ابريل","05":"مايو","06":"يونيو","07":"يوليو","08":"أغسطس","09":"سبتمبر",10:"أكتوبر",11:"نوفمبر",12:"ديسمبر"}},73210:function(e,t,o){"use strict";o.d(t,{Z:function(){return X}});o(76265);var n=o(66252),i=o(3577),a=o(49963);const s=e=>((0,n.dD)("data-v-460b2d5e"),e=e(),(0,n.Cn)(),e),m={class:"blog-description"},r={class:"row"},d={key:0,class:"row"},l={class:"col-6 form-group"},c={class:"form-control-plaintext"},u={class:"col-6 form-group"},h={class:"form-control-plaintext"},p={key:0},g={key:0,class:"text-muted text-sm ms-1",style:{"font-size":"0.7rem"}},v={key:0,style:{"white-space":"pre-wrap",direction:"rtl"}},f=["data-bs-target"],y={class:"d-flex flex-wrap align-items-center comment-activity"},w={href:"javascript:void();"},b={key:0,class:"me-1"},_={key:0,class:"comment-list"},C={class:"post-comments list-inline p-0 m-0"},k=s((()=>(0,n._)("a",{href:"javascript:void(0);",class:"lh-1","data-bs-dismiss":"modal"},[(0,n._)("span",{class:"material-symbols-outlined"},"close")],-1)));function D(e,t,o,s,D,x){const $=(0,n.up)("CommentHeader"),R=(0,n.up)("CreateComment"),E=(0,n.up)("BaseImage"),S=(0,n.up)("tooltip"),T=(0,n.up)("Comment",!0),B=(0,n.up)("model-header"),I=(0,n.up)("model-body"),Z=(0,n.up)("modal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)($,{comment:o.comment,onTriggerEditBox:x.triggerEditBox},null,8,["comment","onTriggerEditBox"]),(0,n._)("div",m,[(0,n._)("div",r,[o.comment.thesis?((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("div",l,[(0,n._)("label",c,"صفحة البداية: "+(0,i.zw)(o.comment.thesis.start_page),1)]),(0,n._)("div",u,[(0,n._)("label",h,"صفحة النهاية: "+(0,i.zw)(o.comment.thesis.end_page),1)])])):(0,n.kq)("",!0)]),o.totalThesisPages>0?((0,n.wg)(),(0,n.iD)("h6",p,[(0,n.Uk)(" الصفحات المنجزة: "+(0,i.zw)(o.totalThesisPages)+" ",1),o.comment.body||o.comment.media?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",g,"قراءة فقط"))])):(0,n.kq)("",!0),D.showEditBox?((0,n.wg)(),(0,n.j4)(R,{key:1,isEdit:!0,ref:"commentEditRef",comment:o.comment,onEditComment:x.editComment,onCancelEdit:x.cancelEdit},null,8,["comment","onEditComment","onCancelEdit"])):((0,n.wg)(),(0,n.iD)(n.HY,{key:2},[o.comment.body?((0,n.wg)(),(0,n.iD)("p",v,[(0,n.Uk)((0,i.zw)(D.briefBody)+" ",1),o.comment.body.length>D.briefBody.length?((0,n.wg)(),(0,n.iD)("a",{key:0,class:"load-btn",href:"#",onClick:t[0]||(t[0]=(0,a.iM)((e=>D.briefBody=o.comment.body),["prevent"]))},"عرض المزيد")):(0,n.kq)("",!0)])):(0,n.kq)("",!0),o.comment.media?((0,n.wg)(),(0,n.iD)("div",{key:1,class:"image-block mt-3 mb-3","data-bs-toggle":"modal","data-bs-target":`#imgModal-${o.comment.id}`},[(0,n.Wm)(E,{mediaID:o.comment.media.id,classes:"img-fluid rounded w-50 comment-image",alt:"blog-img"},null,8,["mediaID"])],8,f)):(0,n.kq)("",!0),(0,n._)("div",y,[(0,n.Wm)(S,{tag:"span",class:"text-muted small",tooltipPlacement:"bottom","data-bs-toggle":"tooltip",title:e.formatFullDate(o.comment.created_at)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(e.formatDateToWritten(o.comment.created_at)),1)])),_:1},8,["title"]),(0,n.Uk)("    "),(0,n._)("a",w,[o.comment.reactions_count>0?((0,n.wg)(),(0,n.iD)("span",b,(0,i.zw)(o.comment.reactions_count),1)):(0,n.kq)("",!0),(0,n._)("span",{style:(0,i.j5)({color:"like"===D.selectedReaction.type?o.comment.is_liked?D.selectedReaction.text_color:"#555770":D.selectedReaction.text_color}),onClick:t[1]||(t[1]=(0,a.iM)((e=>x.reactOnComment(D.selectedReaction.id)),["prevent"]))},(0,i.zw)(D.selectedReaction.title),5)]),o.allowComment?((0,n.wg)(),(0,n.iD)("a",{key:0,href:"javascript:void();",onClick:t[2]||(t[2]=(...e)=>x.showReply&&x.showReply(...e)),style:{color:"#555770"}},(0,i.zw)(D.showReplyBox?"إخفاء":"رد"),1)):(0,n.kq)("",!0)]),x.hasReplies?((0,n.wg)(),(0,n.iD)("a",{key:2,role:"button",class:"load-btn",onClick:t[3]||(t[3]=(...e)=>x.toggleShowReplies&&x.toggleShowReplies(...e))},(0,i.zw)(D.showReplies?`إخفاء ${x.totalReplies} من الردود`:`عرض ${x.totalReplies} من الردود`),1)):(0,n.kq)("",!0)],64))]),o.comment.replies&&D.showReplies?((0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("ul",C,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.comment.replies,(e=>((0,n.wg)(),(0,n.iD)("li",{class:"mb-2",key:e.id},[(0,n.Wm)(T,{allowComment:o.allowComment,comment:e,onAddComment:x.addComment,onEditComment:x.editComment,onReactToComment:x.reactToComment},null,8,["allowComment","comment","onAddComment","onEditComment","onReactToComment"])])))),128))])])):(0,n.kq)("",!0),D.showReplyBox?((0,n.wg)(),(0,n.j4)(R,{key:1,ref:"commentReplyRef",comment:o.comment,type:"reply",onAddComment:x.addComment},null,8,["comment","onAddComment"])):(0,n.kq)("",!0),(0,n.Wm)(Z,{id:`imgModal-${o.comment.id}`,dialogClass:"modal-dialog-centered modal-lg",tabindex:"-1","aria-labelledby":"displayImageLabel","aria-hidden":!1},{default:(0,n.w5)((()=>[(0,n.Wm)(B,null,{default:(0,n.w5)((()=>[k])),_:1}),(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[o.comment.media?((0,n.wg)(),(0,n.j4)(E,{key:0,mediaID:o.comment.media.id,class:"img-fluid rounded w-100",alt:"blog-img"},null,8,["mediaID"])):(0,n.kq)("",!0)])),_:1})])),_:1},8,["id"])],64)}var x=o(43144);var $=o(83744);var R=o(19250);var E=o(20425),S=o.n(E);S().directive;o(28436);const T=e=>((0,n.dD)("data-v-535f7722"),e=e(),(0,n.Cn)(),e),B={class:"d-flex align-items-center justify-content-center mb-3"},I={class:"ms-3 flex-grow-1"},Z={key:0,class:"mt-1"},q={key:0,class:"card-post-toolbar d-flex align-items-center"},O=["data-bs-target"],j=T((()=>(0,n._)("span",{class:"material-symbols-outlined me-2 md-18"}," edit ",-1))),M=[j],z=T((()=>(0,n._)("span",{class:"material-symbols-outlined me-2 md-18"}," edit ",-1))),A=[z],P=T((()=>(0,n._)("span",{class:"material-symbols-outlined me-2 md-18"}," delete ",-1))),U=[P];function L(e,t,o,s,m,r){var d,l,c,u,h,p,g;const v=(0,n.up)("BaseAvatar");return(0,n.wg)(),(0,n.iD)("div",B,[(0,n.Wm)(v,{profileImg:null===(d=o.comment.user)||void 0===d?void 0:d.user_profile.profile_picture,profile_id:null===(l=o.comment.user)||void 0===l?void 0:l.user_profile.id,title:null===(c=o.comment.user)||void 0===c?void 0:c.name,gender:null===(u=o.comment.user)||void 0===u?void 0:u.gender,avatarClass:"rounded-circle avatar-50"},null,8,["profileImg","profile_id","title","gender"]),(0,n._)("div",I,[(0,n._)("h5",{role:"button",class:"author-name hover-undelined",onClick:t[0]||(t[0]=(0,a.iM)((e=>r.sendToProfile(o.comment.user.id)),["prevent"]))},(0,i.zw)(null===(h=o.comment.user)||void 0===h?void 0:h.name),1),(null===(p=o.comment.user)||void 0===p||null===(p=p.roles)||void 0===p?void 0:p.length)>0?((0,n.wg)(),(0,n.iD)("div",Z,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(null===(g=o.comment.user)||void 0===g?void 0:g.roles,(e=>((0,n.wg)(),(0,n.iD)("span",{class:"badge bg-primary rounded-pill ms-1 px-2",key:e.name},(0,i.zw)(m.ARABIC_ROLES[e.name]),1)))),128))])):(0,n.kq)("",!0)]),r.authorized&&r.showOptions?((0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("div",null,[r.canEdit?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},["thesis"===o.comment.type||"screenshot"===o.comment.type?((0,n.wg)(),(0,n.iD)("a",{key:0,class:"d-flex align-items-center",href:"#","data-bs-toggle":"modal","data-bs-target":`#editThesis-${"screenshot"===o.comment.type.trim()?o.comment.comment_id:o.comment.id}`},M,8,O)):((0,n.wg)(),(0,n.iD)("a",{key:1,class:"d-flex align-items-center",href:"#",onClick:t[1]||(t[1]=(0,a.iM)(((...e)=>r.editCmnt&&r.editCmnt(...e)),["prevent"]))},A))],64)):(0,n.kq)("",!0),r.canDelete?((0,n.wg)(),(0,n.iD)("a",{key:1,class:"d-flex align-items-center",href:"#",onClick:t[2]||(t[2]=(0,a.iM)(((...e)=>r.deleteCmnt&&r.deleteCmnt(...e)),["prevent"]))},U)):(0,n.kq)("",!0)])])):(0,n.kq)("",!0)])}o(70560);var W=o(49579),F=o(8209),H=o(27522),N=o(60351),J={name:"CommentUser",inject:{deleteComment:{default:()=>{}}},props:{comment:{type:Object,required:!0}},emits:["triggerEditBox"],data(){return{showDropdown:!1,deleteLoading:!1,confirmationText:"",successText:"",ARABIC_ROLES:N.So}},computed:{authorized(){return this.canEdit||this.canDelete},canEdit(){var e;return(null===(e=this.comment)||void 0===e||null===(e=e.user)||void 0===e?void 0:e.id)==this.$store.getters.getUser.id},canDelete(){var e;const t=this.$store.getters.getUser;return(null===(e=this.comment)||void 0===e||null===(e=e.user)||void 0===e?void 0:e.id)===t.id&&W.Z.hasPermission(t,"delete comment")||W.Z.hasRole(t,"admin")},showOptions(){var e,t,o;const n="thesis"===(null===(e=this.comment)||void 0===e?void 0:e.type)||"screenshot"===(null===(t=this.comment)||void 0===t?void 0:t.type);if(!n)return!0;const i=new Date(null===(o=this.comment)||void 0===o?void 0:o.created_at),a=new Date(this.$store.state.week_start_date),s=new Date(this.$store.state.main_timer);return i>=a&&i<=s}},created(){this.confirmationText="thesis"===this.comment.type||"screenshot"===this.comment.type?"سيتم حذف الأطروحة نهائياً, وخصم علامتها!":"سيتم حذف التعليق نهائياً!",this.successText="thesis"===this.comment.type||"screenshot"===this.comment.type?"تم حذف الأطروحة نهائياً, وخصم علامتها!":"تم حذف التعليق!"},methods:{resolve_img_url(e){return e||o(23062)},toggleDropdown(){this.showDropdown=!this.showDropdown},hideDropdown(){this.showDropdown=!1},async deleteCmnt(){const e=this.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-danger btn-lg ms-2"},buttonsStyling:!1});this.canDelete?this.deleteLoading||e.fire({title:"هل أنت متأكد؟",text:this.confirmationText,icon:"warning",showCancelButton:!0,confirmButtonText:"نعم, احذف!",cancelButtonText:"تراجع",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then((async e=>{if(e.isConfirmed){this.deleteLoading=!0;try{await H.Z.delete(this.comment.id),this.deleteComment(this.comment.id),F.Z.handleSuccessSwal(this.successText),"thesis"!==this.comment.type&&"screenshot"!==this.comment.type||setTimeout((()=>location.reload()),1800)}catch(t){F.Z.handleErrorSwal("حدث خطأ أثناء الحذف, يرجى المحاولة مرة أخرى!")}finally{this.deleteLoading=!1}}})):F.Z.toggleToast("لا يمكنك حذف هذا التعليق","error")},async editCmnt(){this.showDropdown=!1,this.$emit("triggerEditBox")},sendToProfile(e){this.$router.push({name:"user.profile",params:{user_id:e}})}}};const Y=(0,$.Z)(J,[["render",L],["__scopeId","data-v-535f7722"]]);var K=Y,V=o(80932),G={name:"Comment",components:{CreateComment:R.Z,CommentHeader:K},emits:["addComment","editComment","reactToComment"],props:{comment:{type:Object,required:!0},totalThesisPages:{type:Number,required:!1},allowComment:{type:[Boolean,Number],default:!0}},data(){return{showReplies:!1,showReplyBox:!1,showEditBox:!1,selectedReaction:{id:1,title:"إعجاب",type:"like",text_color:"#278036"},pendingRequest:!1,briefBody:""}},computed:{hasReplies(){var e,t;return(null===(e=this.comment)||void 0===e?void 0:e.replies)&&(null===(t=this.comment)||void 0===t?void 0:t.replies.length)>0},totalReplies(){var e;const t=(e,o)=>(o=o||0,e.length>0&&(o+=e.length,e.forEach((e=>{e.replies.length>0&&(o=t(e.replies,o))}))),o);return t(null===(e=this.comment)||void 0===e?void 0:e.replies)}},created(){this.briefBody=this.comment.body?this.comment.body.length>200?this.comment.body.substring(0,200)+"...":this.comment.body:""},methods:(0,x.Z)((0,x.Z)({},F.Z),{},{toggleShowReplies(){this.showReplies=!this.showReplies},showReply(){this.showReplyBox=!this.showReplyBox,this.showReplyBox&&this.$nextTick((()=>{this.$refs.commentReplyRef.focusInput()}))},addComment(e,t){this.$emit("addComment",e,t),this.showReplies=!0,this.showReplyBox=!1},triggerEditBox(){this.showEditBox||(this.showEditBox=!0,this.$nextTick((()=>{this.$refs.commentEditRef.focusInput()})))},async editComment(e){this.$emit("editComment",e),this.showEditBox=!1},cancelEdit(){this.showEditBox=!1},reactToComment(e,t){this.$emit("reactToComment",e,t)},async reactOnComment(e){if(!this.pendingRequest){this.pendingRequest=!0;try{const t=await V.Z.reactOnComment(this.comment.id,e);if(200!==t.statusCode)return void F.Z.toggleToast("حدث خطأ ما, يرجى المحاولة لاحقاً","error");this.$emit("reactToComment",this.comment.id,t.data)}catch(t){console.log("[comment reaction error]",t.response),F.Z.toggleToast("حدث خطأ ما, يرجى المحاولة لاحقاً","error")}finally{this.pendingRequest=!1}}}})};const Q=(0,$.Z)(G,[["render",D],["__scopeId","data-v-460b2d5e"]]);var X=Q},19250:function(e,t,o){"use strict";o.d(t,{Z:function(){return R}});o(76265);var n=o(66252),i=o(49963),a=o(3577);const s=e=>((0,n.dD)("data-v-64cfee5d"),e=e(),(0,n.Cn)(),e),m={class:"d-flex flex-column"},r=["rows"],d={key:0,class:"comment-attagement right d-flex mb-1"},l=["disabled"],c={class:"comment-attagement d-flex mb-1"},u={key:0,class:"preview-images"},h={class:"image-container"},p=s((()=>(0,n._)("span",null," x ",-1))),g=[p],v=["src"],f={key:1,class:"mt-2"},y=["disabled"];function w(e,t,o,s,p,w){return(0,n.wg)(),(0,n.iD)("div",m,[(0,n._)("form",{class:"comment-text d-flex align-items-end mt-3",onSubmit:t[3]||(t[3]=(0,i.iM)(((...e)=>w.addComment&&w.addComment(...e)),["prevent"]))},[(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.v$.commentData.body.$model=e),class:"form-control rounded",placeholder:"أضف تعليق",style:(0,a.j5)([{"padding-right":o.isEdit?"1rem !important":"3rem !important"},{direction:"rtl","max-height":"120px",resize:"none",overflow:"auto"}]),rows:o.isEdit?4:1,ref:"bodyRef"},null,12,r),[[i.nr,s.v$.commentData.body.$model,void 0,{trim:!0}]]),o.isEdit?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("button",{type:"submit",class:(0,a.C_)(["material-symbols-outlined ms-2 border-0 bg-transparent",{"text-primary":!s.v$.commentData.$invalid,disabled:s.v$.commentData.$invalid}]),disabled:s.v$.commentData.$invalid||p.loading}," Send ",10,l)])),(0,n._)("div",c,[(0,n._)("input",{type:"file",ref:"imageInput",class:"d-none",onChange:t[1]||(t[1]=(...e)=>w.uploadImage&&w.uploadImage(...e)),accept:"image/*"},null,544),(0,n._)("a",{href:"javascript:void(0);",class:"material-symbols-outlined me-3",onClick:t[2]||(t[2]=(...e)=>w.chooseImage&&w.chooseImage(...e))}," photo_camera ")])],32),p.fileSrc?((0,n.wg)(),(0,n.iD)("div",u,[(0,n._)("div",h,[(0,n._)("div",{class:"delete-image",onClick:t[4]||(t[4]=(...e)=>w.removeMedia&&w.removeMedia(...e))},g),(0,n._)("img",{src:p.fileSrc},null,8,v)])])):(0,n.kq)("",!0),o.isEdit?((0,n.wg)(),(0,n.iD)("div",f,[(0,n._)("button",{class:"btn btn-primary btn-sm me-2",onClick:t[5]||(t[5]=(0,i.iM)(((...e)=>w.editComment&&w.editComment(...e)),["prevent"])),disabled:p.loading}," تعديل ",8,y),(0,n._)("button",{class:"btn btn-danger btn-sm",onClick:t[6]||(t[6]=(0,i.iM)((t=>e.$emit("cancelEdit")),["prevent"]))}," إلغاء ")])):(0,n.kq)("",!0)])}var b=o(5705),_=o(10760),C=o(27522),k=o(8209),D={name:"CreateComment",setup(){const e=(0,b.ZP)();return{v$:e}},emits:["addComment","editComment","cancelEdit"],props:{comment:{type:Object,default:()=>({})},type:{type:String,default:""},post_id:{type:Number,default:null},isEdit:{type:Boolean,default:!1}},data(){var e,t,o,n,i;return{fileSrc:this.isEdit&&null!==(e=null===(t=this.comment)||void 0===t||null===(t=t.media)||void 0===t?void 0:t.path)&&void 0!==e?e:"",loading:!1,commentData:{body:this.isEdit&&null!==(o=null===(n=this.comment)||void 0===n?void 0:n.body)&&void 0!==o?o:"",image:null,book_id:this.$route.params.book_id,comment_id:this.comment.id,post_id:null!==(i=this.comment.post_id)&&void 0!==i?i:this.post_id,type:this.type}}},computed:{commentBody(){return this.commentData.body}},watch:{commentBody(){this.$refs.bodyRef.style.height="auto",this.$nextTick((()=>{this.$refs.bodyRef.style.height=this.$refs.bodyRef.scrollHeight+"px"}))}},methods:{focusInput(){this.$refs.commentInput.focus()},chooseImage(){this.$refs.imageInput.click()},uploadImage(e){const t=e.target.files[0];this.commentData.image=t;const o=new FileReader;o.onload=()=>{this.fileSrc=o.result},o.readAsDataURL(t)},removeMedia(){this.fileSrc="",this.$refs.imageInput.value=null},async addComment(){if(!this.loading)if(this.v$.$touch(),this.v$.commentData.$invalid)k.Z.toggleToast("يرجى إدخال البيانات","error");else{this.loading=!0;try{var e;const t=await C.Z.create(this.commentData);if(200!==t.statusCode)return void k.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى");this.$emit("addComment",t.data,null===(e=this.comment)||void 0===e?void 0:e.id),this.commentData.body="",this.commentData.image=null,this.$refs.imageInput.value="",this.fileSrc="",this.v$.$reset(),k.Z.toggleToast("تم إضافة التعليق ","success")}catch(t){console.log("[add comment error]",t),k.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى")}finally{this.loading=!1}}},async editComment(){if(!this.loading)if(this.v$.$touch(),this.v$.commentData.$invalid)k.Z.toggleToast("يرجى إدخال البيانات","error");else{this.loading=!0;try{const e={body:this.commentData.body,u_comment_id:this.comment.id,image:this.commentData.image},t=await C.Z.update(e);if(200!==t.statusCode)return void k.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى");this.$emit("editComment",t.data)}catch(e){k.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى")}finally{this.loading=!1}k.Z.toggleToast("تم تعديل التعليق ","success")}}},validations(){return{commentData:{body:{required:(0,_.CF)((()=>!this.commentData.image))},image:{required:(0,_.CF)((()=>!this.commentData.body))}}}}},x=o(83744);const $=(0,x.Z)(D,[["render",w],["__scopeId","data-v-64cfee5d"]]);var R=$},23062:function(e,t,o){"use strict";e.exports=o.p+"img/avatar-01.304828cc.jpg"}}]);
//# sourceMappingURL=3210.da2b7e20.js.map