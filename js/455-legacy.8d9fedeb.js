"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[455],{94268:function(e,t,r){var n=r(50124),a=r(48534),s=r(13087),o=r(62833),u=(r(34338),r(24150)),c=function(){function e(){(0,s.Z)(this,e),this.prefix="audit-marks"}return(0,o.Z)(e,[{key:"groupAuditMarks",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("".concat(this.prefix,"/group-audit-marks/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"markForAudit",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("".concat(this.prefix,"/mark-for-audit/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateMarkForAuditStatus",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=u.hi.patch("".concat(this.prefix,"/update-mark-for-audit-status/").concat(r),{status:t}).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)})),e.abrupt("return",a.data.data);case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"addNote",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.post("/".concat(this.prefix,"/add-note"),t,{headers:{"Content-type":"multipart/form-data"}}).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"groupsAudit",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("/".concat(this.prefix,"/groups-audit/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"supervisorsAudit",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("/".concat(this.prefix,"/supervisors-audit/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"advisorMainAudit",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("/".concat(this.prefix,"/advisor-main-audit/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getNotes",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("/".concat(this.prefix,"/get-notes/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"pendingTheses",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.hi.get("/".concat(this.prefix,"/pending-theses/").concat(t)).catch((function(e){e.response?(0,u.LO)(e.response.status):e.request?console.log(e.request):console.log("Error",e.message)}));case 3:return r=e.sent,e.abrupt("return",r.data.data);case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t.Z=new c},63543:function(e,t,r){r.r(t),r.d(t,{default:function(){return oe}});r(69358);var n=r(66252),a=r(3577),s={class:"col-sm-12 mt-3"},o={class:"iq-card-header-toolbar d-flex align-items-center mx-auto"},u={key:0,class:"text-center mt-3 mb-3",style:{direction:"rtl"}},c={class:"text-center"},i={class:"iq-card-body p-3"},l={class:"d-flex align-items-center mt-3"},d={key:1,class:"alert alert-secondary w-100 text-center",role:"alert"},p={class:"d-flex align-items-center mt-3 row"},m={key:0,class:"text-center mb-3"},f={key:0,class:"alert alert-primary mt-2"},h={class:"d-flex align-items-center mt-3 row"},v={class:"d-inline-block w-100 text-center col-12"},k=(0,n._)("span",null,"عودة",-1),g=(0,n._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),w=[k,g];function b(e,t,r,k,g,b){var _=(0,n.up)("count-down"),y=(0,n.up)("AchievementCard"),x=(0,n.up)("Check"),Z=(0,n.up)("Note"),q=(0,n.up)("iq-card");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",s,[g.week&&g.authorized?((0,n.wg)(),(0,n.j4)(_,{key:0,week:g.week,timer_type:"audit_timer"},null,8,["week"])):(0,n.kq)("",!0),(0,n.Wm)(q,{class:"iq-card"},{default:(0,n.w5)((function(){return[(0,n._)("div",o,[g.mark&&g.week?((0,n.wg)(),(0,n.iD)("h3",u,(0,a.zw)(g.mark.user.name)+" - الأسبوع "+(0,a.zw)(g.week.title),1)):(0,n.kq)("",!0)]),(0,n._)("div",c,[g.mark_for_audit?((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,a.C_)("ms-2 rounded badge text-white ".concat(b.statusClass(g.mark_for_audit.status)))},(0,a.zw)(g.audit_status[g.mark_for_audit.status]),3)):(0,n.kq)("",!0)]),(0,n._)("div",i,[g.mark?((0,n.wg)(),(0,n.j4)(y,{key:0,mark:g.mark,group:g.group},null,8,["mark","group"])):(0,n.kq)("",!0),(0,n._)("div",l,[Object.keys(g.theses).length>0?((0,n.wg)(),(0,n.j4)(x,{key:0,theses:g.theses},null,8,["theses"])):((0,n.wg)(),(0,n.iD)("div",d," لا يوجد انجاز "))]),(0,n._)("div",p,[!g.expired&&g.authorized?((0,n.wg)(),(0,n.iD)("div",m,[(0,n._)("button",{class:"btn btn-primary ms-1 me-1",onClick:t[0]||(t[0]=function(e){return b.updateStatus("acceptable")})},"مقبول"),(0,n._)("button",{class:"btn btn-danger ms-1 me-1",onClick:t[1]||(t[1]=function(e){return b.updateStatus("unacceptable")})},"مرفوض"),g.msg?((0,n.wg)(),(0,n.iD)("div",f,(0,a.zw)(g.msg),1)):(0,n.kq)("",!0)])):(0,n.kq)("",!0),g.mark_for_audit?((0,n.wg)(),(0,n.j4)(Z,{key:1})):(0,n.kq)("",!0),(0,n._)("div",h,[(0,n._)("div",v,[(0,n._)("a",{role:"button",onClick:t[2]||(t[2]=function(t){return e.$router.go(-1)}),class:"d-block mt-3 mb-3 w-75 mx-auto"},w)])])])])]})),_:1})])])}var _=r(50124),y=r(48534),x=(r(278),r(60228),r(70560),r(74615)),Z=r(16319),q=r(26667),$=r(49963),C=r(79885),D=function(e){return(0,n.dD)("data-v-21bdfcf4"),e=e(),(0,n.Cn)(),e},A={class:"col-12"},F={class:"card"},z=D((function(){return(0,n._)("div",{class:"card-header",style:{background:"#cae0cd"}},[(0,n._)("h4",{class:"card-title"}," ملاحظات حول الانجاز ")],-1)})),O={class:"card-content"},E={class:"card-body"},L={class:"row rounded-lg overflow-hidden shadow"},N={class:"col-12 px-0"},S={key:0,class:"px-4 py-5 chat-box bg-white",id:"notes_container"},j={class:"media-body ml-3"},M={key:0,class:"font-weight-bold"},T={class:"text-small mb-0 text-muted"},U={class:"small text-muted"},I={key:1,class:"col-sm-12 text-center"},H=D((function(){return(0,n._)("img",{src:C,alt:"loader",style:{height:"100px"}},null,-1)})),R=[H],K={class:"input-group"},P=D((function(){return(0,n._)("div",{class:"input-group-append m-auto"},[(0,n._)("button",{id:"button-addon2",type:"submit",class:"btn btn-link"},[(0,n._)("span",{class:"display-5 text-dark material-symbols-outlined"}," send ")])],-1)})),V={key:0,style:{color:"red"}};function W(e,t,r,s,o,u){var c=(0,n.up)("base-avatar"),i=(0,n.up)("iq-card");return(0,n.wg)(),(0,n.j4)(i,{"body-class":"p-0"},{body:(0,n.w5)((function(){return[(0,n._)("div",A,[(0,n._)("div",F,[z,(0,n._)("div",O,[(0,n._)("div",E,[(0,n._)("div",L,[(0,n._)("div",N,[o.notes?((0,n.wg)(),(0,n.iD)("div",S,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.notes,(function(t){return(0,n.wg)(),(0,n.iD)("div",{key:t.id,class:(0,a.C_)(["media w-auto mb-3",[t.from_id==u.user.id?"ml-auto":"ltrDirection"]])},[t.from_id!=u.user.id?((0,n.wg)(),(0,n.j4)(c,{key:0,profileImg:t.from.user_profile.profile_picture,profile_id:t.from.user_profile.id,title:t.from.name,gender:t.from.gender,avatarClass:"rounded-circle avatar-40",width:"50"},null,8,["profileImg","profile_id","title","gender"])):(0,n.kq)("",!0),(0,n._)("div",j,[(0,n._)("div",{class:(0,a.C_)(["rounded py-2 px-3 mb-2",[t.from_id==u.user.id?"bg-sender":"bg-recipient"]])},[t.from_id!=u.user.id?((0,n.wg)(),(0,n.iD)("small",M,(0,a.zw)(t.from.name),1)):(0,n.kq)("",!0),(0,n._)("p",T,(0,a.zw)(t.body),1)],2),(0,n._)("p",U,(0,a.zw)(e.formatFullDate(t.created_at)),1)])],2)})),128))])):(0,n.kq)("",!0),o.loader?((0,n.wg)(),(0,n.iD)("div",I,R)):(0,n.kq)("",!0),(0,n._)("form",{onSubmit:t[1]||(t[1]=(0,$.iM)((function(e){return u.submitNote()}),["prevent"])),class:"mt-2"},[(0,n._)("div",K,[P,(0,n.wy)((0,n._)("input",{type:"text",placeholder:"اكتب ملاحظة","aria-describedby":"button-addon2",class:"border-bottom form-control rounded-0 border-0 py-4","onUpdate:modelValue":t[0]||(t[0]=function(e){return s.v$.noteForm.body.$model=e})},null,512),[[$.nr,s.v$.noteForm.body.$model]]),s.v$.noteForm.body.$invalid?((0,n.wg)(),(0,n.iD)("small",V," الملاحظة مطلوبة ")):(0,n.kq)("",!0)])],32)])])])])])])]})),_:1})}var Y=r(95082),B=r(5705),G=r(10760),J=r(94268),Q=r(31025),X={name:"Audit Notes",setup:function(){return{v$:(0,B.ZP)()}},created:function(){var e=this;return(0,y.Z)((0,_.Z)().mark((function t(){return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,J.Z.getNotes(e.noteForm.mark_for_audit_id);case 2:e.notes=t.sent;case 3:case"end":return t.stop()}}),t)})))()},data:function(){return{notes:null,loader:!1,noteForm:{body:"",mark_for_audit_id:this.$route.params.mark_for_audit}}},validations:function(){return{noteForm:{body:{required:G.C1}}}},methods:(0,Y.Z)((0,Y.Z)({},Q.Z),{},{submitNote:function(){var e=this;return(0,y.Z)((0,_.Z)().mark((function t(){var r;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.v$.$touch(),e.v$.noteForm.$invalid){t.next=17;break}return e.loader=!0,t.prev=3,t.next=6,J.Z.addNote(e.noteForm);case 6:r=t.sent,e.loader=!1,e.notes.push(r),e.scrollToEnd(),e.noteForm.body="",e.v$.noteForm.$reset(),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](3),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,14]])})))()},scrollToEnd:function(){var e=this.$el.querySelector("#notes_container");console.log("🚀 ~ file: Note.vue:137 ~ container:",e),e.scrollTop=e.scrollHeight}}),computed:{user:function(){return this.$store.getters.getUser}}},ee=r(83744);const te=(0,ee.Z)(X,[["render",W],["__scopeId","data-v-21bdfcf4"]]);var re=te,ne=r(49579),ae={name:"Audit Mark",created:function(){var e=this;return(0,y.Z)((0,_.Z)().mark((function t(){var r;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,J.Z.markForAudit(e.$route.params.mark_for_audit);case 3:r=t.sent,e.mark_for_audit=r.mark_for_audit,e.mark=r.mark_for_audit.mark,e.theses=r.theses.reduce((function(e,t){var r=e[t.book.name]||[];return r["title"]=t.book.name,r.push(t),e[t.book.name]=r,e}),{}),e.group=r.group,e.week=r.week,e.expired=e.time<0,e.authorized=r.authorized,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},components:{Check:Z.Z,AchievementCard:x.Z,CountDown:q.Z,Note:re},data:function(){return{theses:[],group:null,week:null,expired:!0,mark:null,authorized:!1,mark_for_audit:null,audit_status:{acceptable:"مقبول",unacceptable:"مرفوض",not_audited:"لم يتم تدقيقه"},msg:""}},methods:{statusClass:function(e){switch(e){case"acceptable":return"bg-primary";case"unacceptable":return"bg-danger";default:return"bg-dark"}},updateStatus:function(e){var t=this;return(0,y.Z)((0,_.Z)().mark((function r(){return(0,_.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,J.Z.updateMarkForAuditStatus(e,t.$route.params.mark_for_audit);case 2:r.sent,t.mark_for_audit.status=e,t.msg="تم التدقيق";case 5:case"end":return r.stop()}}),r)})))()}},computed:{user:function(){return this.$store.getters.getUser},isAdvisor:function(){return ne.Z.hasRole(this.user,"advisor")},time:function(){var e=(new Date).toLocaleString("en-US",{timeZone:"Asia/Riyadh"}),t=new Date(this.week.audit_timer),r=new Date(e);return this.isAdvisor?t.getTime()+936e5-r:t-r}}};const se=(0,ee.Z)(ae,[["render",b]]);var oe=se}}]);
//# sourceMappingURL=455-legacy.8d9fedeb.js.map