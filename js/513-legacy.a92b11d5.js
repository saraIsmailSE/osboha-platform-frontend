"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[513],{26045:function(e,t,s){var n=s(50124),a=s(48534),r=s(13087),i=s(62833),o=(s(34338),s(24150)),c=s(66252),l=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"getThesisById",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var s;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.hi.get("/theses/".concat(t));case 3:return s=e.sent,e.abrupt("return",s.data.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,c.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getBookThesis",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,s){var a;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.hi.get("/theses/book/".concat(t,"/thesis/").concat(s));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,c.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"getThesesByBookId",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,s){var a,r,i=arguments;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=i.length>2&&void 0!==i[2]?i[2]:"",e.prev=1,e.next=4,o.hi.get("/theses/book/".concat(t,"/user/").concat(a,"?page=").concat(s));case 4:return r=e.sent,e.abrupt("return",r.data);case 8:e.prev=8,e.t0=e["catch"](1),(0,c.S3)(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"getThesisByUser",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,s){var a;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.hi.get("/theses/user/".concat(t,"?page=").concat(s));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,c.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"getThesisByWeek",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var s;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.hi.get("/theses/week/".concat(t));case 3:return s=e.sent,e.abrupt("return",s.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,c.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t.Z=new l},60513:function(e,t,s){s.r(t),s.d(t,{default:function(){return Te}});s(34338);var n=s(66252),a=s(49963),r=s(3577),i=s(55415),o={class:"col-sm-12 mt-3 text-center"},c=(0,n._)("div",{class:"iq-card-header-toolbar d-flex align-items-center mx-auto"},[(0,n._)("h3",{class:"text-center mt-3 mb-3"},"تدقيق أطروحة")],-1),l={class:"iq-card-body p-3"},u=(0,n._)("div",{class:"image-block text-center"},[(0,n._)("img",{src:i,class:"img-fluid rounded w-50",alt:"blog-img"})],-1),d={key:0,class:"d-flex align-items-center mt-3"},h={class:"form-group row"},p={class:"col-4 form-group"},m=(0,n._)("label",{class:"form-label"},"صفحة البداية",-1),f={class:"form-control-plaintext"},g={class:"col-4 form-group"},w=(0,n._)("label",{class:"form-label"},"صفحة النهاية",-1),v={class:"form-control-plaintext"},_={class:"col-4 form-group"},x=(0,n._)("label",{class:"form-label"},"العدد الكلي ",-1),b={class:"form-control-plaintext"},k={class:"form-group row"},y={class:"col-12"},Z={class:"form-control-plaintext"},D={class:"me-2"},C={key:0,class:"col-md-12 form-group"},S={style:{"white-space":"pre-wrap",direction:"rtl"},class:"form-control-plaintext"},z={class:"col-12 row justify-content-center"},B=["href"],T=["src"],q=(0,n._)("hr",null,null,-1),E={key:0,class:"form-group row w-75 m-auto"},U={class:"col-12 col-md-6"},j=(0,n._)("option",{class:"bg-white text-dark",value:"",selected:""}," الحالة ",-1),A=(0,n._)("option",{class:"bg-white text-dark",value:"accepted"}," مقبولة ",-1),O=(0,n._)("option",{class:"bg-white text-dark",value:"rejected"}," خصم علامة الأطروحة كاملة ",-1),I=(0,n._)("option",{class:"bg-white text-dark",value:"one_thesis"}," حساب علامة أطروحة واحدة ",-1),$=[j,A,O,I],M={class:"col-12 col-md-6"},R=["disabled"],W=(0,n._)("option",{class:"bg-white text-dark",value:"",selected:""}," السبب ",-1),F=["value"],L={key:0,class:"col-12 mt-2 text-center"},H=["src"],K={key:1,class:"col-12 mt-2"},N=["disabled"],P={key:2,class:"col-12"},V={class:"form-control-plaintext text-center",style:{color:"#ff0000"}},Y={key:1,class:"alert alert-danger d-flex align-items-center justify-content-center"},G={class:"me-2"},J={key:0},Q={key:1},X={key:2},ee={class:"d-flex align-items-center mt-3 row"},te={class:"d-inline-block w-100 text-center col-12"},se=(0,n._)("span",null,"انجاز القارىء",-1),ne=(0,n._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),ae=[se,ne];function re(e,t,i,j,A,O){var I=(0,n.up)("ExpandedCard"),se=(0,n.up)("font-awesome-icon"),ne=(0,n.up)("iq-card");return(0,n.wg)(),(0,n.iD)("div",o,[(0,n.Wm)(ne,{class:"iq-card"},{default:(0,n.w5)((function(){return[c,(0,n._)("div",l,[u,A.thesis?((0,n.wg)(),(0,n.iD)("div",d,[(0,n._)("form",{onSubmit:t[2]||(t[2]=(0,a.iM)((function(){return O.submitAudit&&O.submitAudit.apply(O,arguments)}),["prevent"])),class:"post-text ml-3 w-100 row"},[(0,n._)("div",h,[(0,n._)("div",p,[m,(0,n._)("label",f,(0,r.zw)(A.thesis.start_page),1)]),(0,n._)("div",g,[w,(0,n._)("label",v,(0,r.zw)(A.thesis.end_page),1)]),(0,n._)("div",_,[x,(0,n._)("label",b,(0,r.zw)(O.totalPages),1)]),(0,n._)("div",k,[(0,n._)("div",y,[(0,n._)("label",Z,[(0,n._)("span",D,(0,r.zw)(O.thesisType),1),(0,n._)("span",{class:(0,r.C_)(["rounded-pill px-2 py-1 text-white",O.thesisStatus.className])},(0,r.zw)(O.thesisStatus.status),3)])])]),A.thesis.comment.body?((0,n.wg)(),(0,n.iD)("div",C,[(0,n._)("p",S,(0,r.zw)(A.thesis.comment.body),1)])):(0,n.kq)("",!0),O.media.length>0?((0,n.wg)(),(0,n.j4)(I,{key:1,title:"الاقتباسات",defaultExpanding:O.media.length<=3},{default:(0,n.w5)((function(){return[(0,n._)("div",z,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(O.media,(function(t,s){return(0,n.wg)(),(0,n.iD)("div",{class:"col-lg-3 col-md-6 col-sm-12 mb-2",key:s},[(0,n._)("a",{href:"".concat(e.getAssetsUrl(),"/").concat(t.media),target:"_blank"},[(0,n._)("img",{class:"img-fluid rounded w-100 h-100",src:"".concat(e.getAssetsUrl(),"/").concat(t.media),alt:"thesis screenshot",style:{"object-fit":"cover"}},null,8,T)],8,B)])})),128))])]})),_:1},8,["defaultExpanding"])):(0,n.kq)("",!0)]),q,!A.expired&&O.pending&&O.authUserAllowed&&!O.readOnly?((0,n.wg)(),(0,n.iD)("div",E,[(0,n._)("div",U,[(0,n.wy)((0,n._)("select",{class:"form-select w-100 mt-2","onUpdate:modelValue":t[0]||(t[0]=function(e){return A.status=e})},$,512),[[a.bM,A.status]])]),(0,n._)("div",M,[(0,n.wy)((0,n._)("select",{class:"form-select w-100 mt-2","onUpdate:modelValue":t[1]||(t[1]=function(e){return A.reason=e}),disabled:"accepted"===A.status},[W,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(A.reasons,(function(e){return(0,n.wg)(),(0,n.iD)("option",{class:"bg-white text-dark",key:e.id,value:e.id},(0,r.zw)(e.reason),9,F)})),128))],8,R),[[a.bM,A.reason]])]),A.loader?((0,n.wg)(),(0,n.iD)("div",L,[(0,n._)("img",{src:s(79885),alt:"loader",style:{height:"50px"}},null,8,H)])):((0,n.wg)(),(0,n.iD)("div",K,[(0,n._)("button",{type:"submit",class:"btn btn-primary w-100",disabled:O.message.length>0}," اعتماد ",8,N)])),O.message?((0,n.wg)(),(0,n.iD)("div",P,[(0,n._)("p",V,(0,r.zw)(O.message),1)])):(0,n.kq)("",!0)])):((0,n.wg)(),(0,n.iD)("div",Y,[(0,n._)("div",G,[(0,n.Wm)(se,{icon:["fas","circle-exclamation"],size:"lg"})]),A.expired?((0,n.wg)(),(0,n.iD)("div",J,"لقد انتهت فترة المراجعة")):O.pending?O.authUserAllowed?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",X,"غير مسموح لك بالمراجعة")):((0,n.wg)(),(0,n.iD)("div",Q,"لقد تمت المراجعة من قبل"))]))],32)])):(0,n.kq)("",!0),(0,n._)("div",ee,[(0,n._)("div",te,[(0,n._)("a",{role:"button",onClick:t[3]||(t[3]=function(t){return e.$router.go(-1)}),class:"d-block mt-3 mb-3 w-75 mx-auto"},ae)])])])]})),_:1})])}var ie=s(95082),oe=s(50124),ce=s(48534),le=(s(60228),s(47522),s(70560),s(32320),s(26045)),ue=s(13087),de=s(62833),he=s(24150),pe=function(){function e(){(0,ue.Z)(this,e)}return(0,de.Z)(e,[{key:"getReasonsForLeader",value:function(){var e=(0,ce.Z)((0,oe.Z)().mark((function e(){var t;return(0,oe.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,he.hi.get("modification-reasons/leader");case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,n.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),me=new pe,fe=function(){function e(){(0,ue.Z)(this,e)}return(0,de.Z)(e,[{key:"create",value:function(){var e=(0,ce.Z)((0,oe.Z)().mark((function e(t){var s,a;return(0,oe.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new FormData,null!==t.reason_id&&s.append("modifier_reason_id",t.reason_id),s.append("thesis_id",t.thesis_id),s.append("status",t.status),s.append("week_id",t.week_id),e.prev=5,e.next=8,he.hi.post("/modified-theses",s);case 8:return a=e.sent,e.abrupt("return",a.data);case 12:e.prev=12,e.t0=e["catch"](5),(0,n.S3)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),ge=new fe,we=s(31025),ve=s(49579),_e={class:"card"},xe={class:"text-light mt-0 text-center",style:{direction:"rtl !important"}},be={class:"d-flex justify-content-center"},ke={key:0,class:"card-body row d-flex justify-content-center",style:{"box-shadow":"none"}};function ye(e,t,s,a,i,o){return(0,n.wg)(),(0,n.iD)("div",_e,[(0,n._)("div",{class:"card-header rounded-0 p-1",style:(0,r.j5)({backgroundColor:s.bgColor})},[(0,n._)("h5",xe,[(0,n._)("div",be,[(0,n._)("span",{role:"button",class:"material-symbols-outlined",onClick:t[0]||(t[0]=function(e){return i.expanding=!i.expanding})},(0,r.zw)(i.expanding?"expand_less":"expand_more"),1),(0,n.Uk)(" "+(0,r.zw)(s.title),1)])])],4),i.expanding?((0,n.wg)(),(0,n.iD)("div",ke,[(0,n.WI)(e.$slots,"default")])):(0,n.kq)("",!0)])}var Ze={name:"ExpandedCard",data:function(){return{expanding:!1}},props:{title:{type:String,required:!0},bgColor:{type:String,default:"#1d1a55"},defaultExpanding:{type:Boolean,default:!1}},created:function(){this.expanding=this.defaultExpanding}},De=s(83744);const Ce=(0,De.Z)(Ze,[["render",ye]]);var Se=Ce,ze={name:"List One Thesis",components:{ExpandedCard:Se},created:function(){var e=this;return(0,ce.Z)((0,oe.Z)().mark((function t(){var s,n,a;return(0,oe.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,le.Z.getThesisById(e.$route.params.thesis_id);case 2:return a=t.sent,t.next=5,me.getReasonsForLeader();case 5:e.reasons=t.sent,e.thesis=a,e.week=null===(s=a.mark)||void 0===s?void 0:s.week,e.expired=new Date(null===(n=e.week)||void 0===n?void 0:n.modify_timer)<new Date;case 9:case"end":return t.stop()}}),t)})))()},data:function(){return{thesis:null,reasons:[],loader:!1,status:"",reason:"",week:null,expired:!1,expand:!1}},computed:{authUserAllowed:function(){return ve.Z.hasRoles(this.$store.getters.getUser,["leader","supervisor","advisor","admin","consultant"])},thesisStatus:function(){var e="",t="bg-primary";return"pending"===this.thesis.status||""===this.thesis.status||null===this.thesis.status?(e="بحاجة للمراجعة",t="bg-warning"):"accepted"===this.thesis.status?(e="مقبول",t="bg-success"):"rejected"===this.thesis.status?(e="مرفوض",t="bg-danger"):"one_thesis"===this.thesis.status&&(e="علامة أطروحة واحدة",t="bg-info"),{status:e,className:t}},pending:function(){return"pending"===this.thesis.status||null===this.thesis.status||""===this.thesis.status},readOnly:function(){return"accepted"===this.thesis.status&&0==this.thesis.max_length&&0==this.thesis.total_screenshots},message:function(){return"accepted"===this.status||this.reason?"":"لا يمكنك الاعتماد بدون اختيار السبب والحالة في حالة الرفض"},media:function(){var e,t=[],s=function e(s){s.forEach((function(s){var n;s.media&&"screenshot"===s.type&&t.push(s.media),(null===(n=s.replies)||void 0===n?void 0:n.length)>0&&e(s.replies)}))};this.thesis&&(this.thesis.comment.media&&t.push(this.thesis.comment.media),(null===(e=this.thesis.comment.replies)||void 0===e?void 0:e.length)>0&&s(this.thesis.comment.replies));return t},thesisType:function(){var e="";return this.thesis.max_length>0&&this.thesis.max_length>400?e="شاملة":this.thesis.max_length>0&&this.thesis.max_length<400?e="غير شاملة":0==this.thesis.max_length&&this.thesis.total_screenshots>0?e="اقتباسات":0==this.thesis.max_length&&0==this.thesis.total_screenshots&&(e="قراءة فقط"),e},totalPages:function(){var e=this.thesis.end_page-this.thesis.start_page;return e>0?e+1:0}},methods:(0,ie.Z)((0,ie.Z)({},we.Z),{},{submitAudit:function(){var e=this;return(0,ce.Z)((0,oe.Z)().mark((function t(){var s;return(0,oe.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.message.length>0)){t.next=2;break}return t.abrupt("return");case 2:s=e.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-danger btn-lg ms-2"},buttonsStyling:!1}),s.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا الإجراء!",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم، قم بالإعتماد!",cancelButtonText:"تراجع",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then(function(){var t=(0,ce.Z)((0,oe.Z)().mark((function t(s){var n;return(0,oe.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s.isConfirmed){t.next=16;break}return e.loader=!0,t.prev=2,t.next=5,ge.create({thesis_id:e.thesis.id,reason_id:e.reason?parseInt(e.reason):null,status:e.status,week_id:e.week.id});case 5:n=t.sent,200===n.statusCode&&(e.handleSuccessSwal(n.data),setTimeout((function(){e.$router.push({name:"group.listOneAmbassadorReading",params:{ambassador_id:e.thesis.comment.user.id,week_id:e.week.id}})}),1800)),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](2),406===t.t0.response.data.statusCode?e.handleErrorSwal(t.t0.response.data.data):e.handleErrorSwal("حدث خطأ ما، حاول مرة أخرى"),console.log("[Modify thesis error]",t.t0);case 13:return t.prev=13,e.loader=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[2,9,13,16]])})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})))()}})};const Be=(0,De.Z)(ze,[["render",re]]);var Te=Be},55415:function(e,t,s){e.exports=s.p+"img/update-forms.03f6433b.png"}}]);
//# sourceMappingURL=513-legacy.a92b11d5.js.map