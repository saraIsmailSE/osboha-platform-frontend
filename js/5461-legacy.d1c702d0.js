"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[5461],{85461:function(e,o,r){r.r(o),r.d(o,{default:function(){return Ue}});var t=r(66252),l=r(3577),i=r(49963),n=r(8584),s=r(79885),a={class:"col-sm-12 mt-3"},u=(0,t._)("div",{class:"iq-card-header-toolbar d-flex text-center align-items-center mx-auto"},[(0,t._)("h1",{class:"text-center mt-3 mb-3"},"تعديل كتاب")],-1),d={class:"iq-card-body p-4"},c={class:"image-block text-center mt-3"},m=["src"],b={key:1,class:"img-fluid rounded w-75",src:n,alt:"add-group"},k={class:"col-12 bg-white pt-2"},p={class:"text-center mb-3"},f={class:"sign-in-from"},g={class:"form-group"},_=(0,t._)("label",{for:"bookName"},"اسم الكتاب",-1),h={key:0,style:{color:"red"}},v={class:"form-group"},y=(0,t._)("label",{for:"bookDescription"},"وصف الكتاب",-1),$={key:0,style:{color:"red"}},F={class:"form-group"},w=(0,t._)("label",{for:"bookAuther"},"الكاتب",-1),x={key:0,style:{color:"red"}},q={class:"form-group"},D=(0,t._)("label",{for:"bookPublisher"},"دار النشر",-1),Z={key:0,style:{color:"red"}},V={class:"form-group"},U=(0,t._)("label",{for:"bookLink"},"رابط الكتاب",-1),C={key:0,style:{color:"red"}},A={class:"form-group"},B=(0,t._)("label",{for:"bookStartPage"},"صفحة البداية",-1),M={key:0,style:{color:"red"}},T={class:"form-group"},L=(0,t._)("label",{for:"bookEndPage"},"صفحة النهاية",-1),z={key:0,style:{color:"red"}},P={class:"form-group"},S=(0,t._)("label",{for:"bookType"},"نوع الكتاب",-1),I=["disabled"],K=(0,t._)("option",{value:"0",selected:""},"اختر نوع الكتاب",-1),O=["value"],R={key:0,style:{color:"red"}},H={class:"form-group"},E=(0,t._)("label",{for:"bookLevel"},"مستوى الكتاب",-1),N=(0,t._)("option",{value:"0",selected:""},"اختر مستوى الكتاب",-1),Y=["value"],W={key:0,style:{color:"red"}},j={class:"form-group col-12"},G=(0,t._)("h4",null,"قسم الكتاب",-1),J=(0,t._)("option",{value:"",selected:""},"اختر قسم الكتاب",-1),Q=["value"],X={key:0,style:{color:"red"}},ee={class:"form-group col-12"},oe=(0,t._)("h4",null,"لغة الكتاب",-1),re=(0,t._)("option",{value:"0",selected:""},"اختر لغة الكتاب",-1),te=["value"],le={class:"form-group col-12"},ie=(0,t._)("h4",null,"صورة الكتاب",-1),ne={key:0,class:"text-center my-2",style:{color:"red"}},se=(0,t._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),ae={key:1,class:"col-sm-12 text-center"},ue=(0,t._)("p",{class:"text-center"},"جاري التعديل",-1),de=(0,t._)("img",{src:s,alt:"loader",style:{height:"100px"}},null,-1),ce=[ue,de],me={key:2,class:"d-inline-block w-100"},be=["disabled"];function ke(e,o,r,n,s,ue){var de=this,ke=(0,t.up)("router-link"),pe=(0,t.up)("iq-card");return(0,t.wg)(),(0,t.iD)("div",a,[(0,t.Wm)(pe,{class:"iq-card"},{default:(0,t.w5)((function(){return[u,(0,t._)("div",d,[(0,t._)("div",c,[s.currentMedia?((0,t.wg)(),(0,t.iD)("img",{key:0,src:s.currentMedia.path,class:"img-fluid rounded w-25",alt:"blog-img"},null,8,m)):((0,t.wg)(),(0,t.iD)("img",b))])]),(0,t._)("div",k,[(0,t._)("h3",p,(0,l.zw)(s.bookForm.name),1),(0,t._)("div",f,[(0,t._)("form",{class:"mt-2",onSubmit:o[12]||(o[12]=(0,i.iM)((function(e){return ue.onSubmit()}),["prevent"]))},[(0,t._)("div",g,[_,(0,t.wy)((0,t._)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=function(e){return n.v$.bookForm.name.$model=e}),class:"form-control mb-0",id:"bookName",placeholder:" اسم الكتاب"},null,512),[[i.nr,n.v$.bookForm.name.$model]]),n.v$.bookForm.name.$error?((0,t.wg)(),(0,t.iD)("small",h," اسم الكتاب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",v,[y,(0,t.wy)((0,t._)("textarea",{type:"text","onUpdate:modelValue":o[1]||(o[1]=function(e){return n.v$.bookForm.brief.$model=e}),class:"form-control mb-0",id:"bookDescription",placeholder:"وصف الكتاب ",style:(0,l.j5)([{"padding-right":"1rem !important"},{direction:"rtl","max-height":"120px",resize:"none",overflow:"auto"}]),rows:1,ref:"bodyRef"},null,512),[[i.nr,n.v$.bookForm.brief.$model]]),n.v$.bookForm.brief.$error?((0,t.wg)(),(0,t.iD)("small",$,"وصف الكتاب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",F,[w,(0,t.wy)((0,t._)("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=function(e){return n.v$.bookForm.writer.$model=e}),class:"form-control mb-0",id:"bookAuther",placeholder:"اسم الكاتب "},null,512),[[i.nr,n.v$.bookForm.writer.$model]]),n.v$.bookForm.writer.$error?((0,t.wg)(),(0,t.iD)("small",x,"اسم الكاتب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",q,[D,(0,t.wy)((0,t._)("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=function(e){return n.v$.bookForm.publisher.$model=e}),class:"form-control mb-0",id:"bookPublisher",placeholder:"دار النشر "},null,512),[[i.nr,n.v$.bookForm.publisher.$model]]),n.v$.bookForm.publisher.$error?((0,t.wg)(),(0,t.iD)("small",Z,"دار النشر مطلوبة")):(0,t.kq)("",!0)]),(0,t._)("div",V,[U,(0,t.wy)((0,t._)("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=function(e){return n.v$.bookForm.link.$model=e}),class:"form-control mb-0",id:"bookLink",placeholder:"رابط الكتاب "},null,512),[[i.nr,n.v$.bookForm.link.$model]]),n.v$.bookForm.link.$error?((0,t.wg)(),(0,t.iD)("small",C,"رابط الكتاب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",A,[B,(0,t.wy)((0,t._)("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=function(e){return n.v$.bookForm.start_page.$model=e}),class:"form-control mb-0",id:"bookStartPage",placeholder:"صفحة البداية "},null,512),[[i.nr,n.v$.bookForm.start_page.$model]]),n.v$.bookForm.start_page.$error?((0,t.wg)(),(0,t.iD)("small",M,"صفحة البداية مطلوبة")):(0,t.kq)("",!0)]),(0,t._)("div",T,[L,(0,t.wy)((0,t._)("input",{type:"number","onUpdate:modelValue":o[6]||(o[6]=function(e){return n.v$.bookForm.end_page.$model=e}),class:"form-control mb-0",id:"bookEndPage",placeholder:"صفحة النهاية "},null,512),[[i.nr,n.v$.bookForm.end_page.$model]]),n.v$.bookForm.end_page.$error?((0,t.wg)(),(0,t.iD)("small",z,"صفحة النهاية مطلوبة")):(0,t.kq)("",!0)]),(0,t._)("div",P,[S,(0,t.wy)((0,t._)("select",{"onUpdate:modelValue":o[7]||(o[7]=function(e){return n.v$.bookForm.type_id.$model=e}),class:"form-select","data-trigger":"",name:"choices-single-default",id:"choices-single-default",disabled:!ue.shouldfFill},[K,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.types,(function(e,o){return(0,t.wg)(),(0,t.iD)("option",{key:o,value:e.id},(0,l.zw)(s.BOOK_Types[e.type]),9,O)})),128))],8,I),[[i.bM,n.v$.bookForm.type_id.$model]]),n.v$.bookForm.type_id.$error?((0,t.wg)(),(0,t.iD)("small",R,"نوع الكتاب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",H,[E,(0,t.wy)((0,t._)("select",{"onUpdate:modelValue":o[8]||(o[8]=function(e){return n.v$.bookForm.level_id.$model=e}),class:"form-select","data-trigger":"",name:"choices-single-default",id:"choices-single-default"},[N,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.bookLevels,(function(e,o){return(0,t.wg)(),(0,t.iD)("option",{key:o,value:e.id},(0,l.zw)(e.arabic_level),9,Y)})),128))],512),[[i.bM,n.v$.bookForm.level_id.$model]]),n.v$.bookForm.level_id.$error?((0,t.wg)(),(0,t.iD)("small",W,"مستوى الكتاب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",j,[G,(0,t.wy)((0,t._)("select",{class:"form-select mt-2","data-trigger":"",name:"section",id:"section","onUpdate:modelValue":o[9]||(o[9]=function(e){return n.v$.bookForm.section_id.$model=e})},[J,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.sections,(function(e){return(0,t.wg)(),(0,t.iD)("option",{key:e.id,value:e.id},(0,l.zw)(e.section),9,Q)})),128))],512),[[i.bM,n.v$.bookForm.section_id.$model]]),n.v$.bookForm.section_id.$error?((0,t.wg)(),(0,t.iD)("small",X,"قسم الكتاب مطلوب")):(0,t.kq)("",!0)]),(0,t._)("div",ee,[oe,(0,t.wy)((0,t._)("select",{class:"form-select mt-2","data-trigger":"",name:"section",id:"section","onUpdate:modelValue":o[10]||(o[10]=function(e){return n.v$.bookForm.language_id.$model=e})},[re,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.languages,(function(e){return(0,t.wg)(),(0,t.iD)("option",{key:e.id,value:e.id},(0,l.zw)(s.LANUAGES[e.language]),9,te)})),128))],512),[[i.bM,n.v$.bookForm.language_id.$model]])]),(0,t._)("div",le,[ie,(0,t._)("input",{class:"form-control mt-2",type:"file",name:"book_media",id:"book_media",ref:"book_media",accept:"image/*",onChange:o[11]||(o[11]=function(){return ue.uploadFile&&ue.uploadFile.apply(ue,arguments)})},null,544)]),s.message?((0,t.wg)(),(0,t.iD)("p",ne,(0,l.zw)(s.message),1)):(0,t.kq)("",!0),(0,t.Wm)(ke,{class:"mb-3 text-center d-block w-100",to:{name:"book.book-details",params:{book_id:de.$route.params.book_id}}},{default:(0,t.w5)((function(){return[(0,t.Uk)(" عرض الكتاب "),se]})),_:1},8,["to"]),s.loading?((0,t.wg)(),(0,t.iD)("div",ae,ce)):((0,t.wg)(),(0,t.iD)("div",me,[(0,t._)("button",{type:"submit",class:"btn btn-primary float-end",disabled:s.loading}," تعديل ",8,be)]))],32)])])]})),_:1})])}var pe=r(50124),fe=r(48534),ge=r(5705),_e=r(10760),he=r(34964),ve=r(45347),ye=r(65913),$e=r(94140),Fe=r(92176),we=r(60351),xe=r(49579),qe=function(e){return e>0},De={name:"Update Book",setup:function(){return{v$:(0,ge.ZP)()}},created:function(){var e=this;return(0,fe.Z)((0,pe.Z)().mark((function o(){return(0,pe.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return e.setBook(),o.next=3,$e.Z.getAll();case 3:return e.bookLevels=o.sent,o.next=6,Fe.Z.getAll();case 6:return e.sections=o.sent,e.sections=e.sections.data,o.next=10,ye.Z.getAll();case 10:return e.languages=o.sent,o.next=13,ve.Z.getAllBookTypes();case 13:e.types=o.sent;case 14:case"end":return o.stop()}}),o)})))()},watch:{bookBrief:function(){var e=this;this.$refs.bodyRef.style.height="auto",this.$nextTick((function(){e.$refs.bodyRef.style.height=e.$refs.bodyRef.scrollHeight+"px"}))}},computed:{shouldfFill:function(){return this.isAdmin||this.inBooksTeam},bookBrief:function(){return this.bookForm.brief},user:function(){return this.$store.getters.getUser},inBooksTeam:function(){return xe.Z.hasRole(this.user,"book_quality_team")},isAdmin:function(){return xe.Z.hasRole(this.user,"admin")}},data:function(){return{types:[],bookLevels:[],sections:[],languages:[],LANUAGES:we.jx,BOOK_Types:we.Wx,bookForm:{book_id:this.$route.params.book_id,book_media:null,name:"",writer:"",publisher:"",brief:"",link:"",start_page:0,end_page:0,section_id:0,level_id:0,type_id:0,language_id:0},message:"",loading:!1,currentMedia:null}},validations:function(){return{bookForm:{name:{required:_e.C1},writer:{required:(0,_e.CF)((function(){return!!this.shouldfFill}))},publisher:{required:(0,_e.CF)((function(){return!!this.shouldfFill}))},brief:{required:(0,_e.CF)((function(){return!!this.shouldfFill}))},link:{required:(0,_e.CF)((function(){return!!this.shouldfFill}))},start_page:{required:_e.C1,maxValue:qe},end_page:{required:_e.C1,maxValue:qe},type_id:{required:(0,_e.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem},level_id:{required:(0,_e.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem},language_id:{required:(0,_e.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem},section_id:{required:(0,_e.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem}}}},methods:{selectItem:function(e){return!this.isAdmin&&!this.inBooksTeam||e>0},setBook:function(){var e=this;return(0,fe.Z)((0,pe.Z)().mark((function o(){var r;return(0,pe.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,he.Z.showBasicInfo(e.$route.params.book_id);case 2:r=o.sent,r&&(e.bookForm.name=r.book.name,e.bookForm.writer=r.book.writer,e.bookForm.publisher=r.book.publisher,e.bookForm.brief=r.book.brief,e.bookForm.link=r.book.link,e.bookForm.start_page=r.book.start_page,e.bookForm.end_page=r.book.end_page,e.bookForm.level_id=r.book.level.id,e.bookForm.language_id=r.book.language.id,e.bookForm.section_id=r.book.section.id,e.bookForm.type_id=r.book.type.id,e.currentMedia=r.book.media);case 4:case"end":return o.stop()}}),o)})))()},uploadFile:function(e){this.bookForm.book_media=e.target.files[0]},onSubmit:function(){var e=this;return(0,fe.Z)((0,pe.Z)().mark((function o(){return(0,pe.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.v$.$touch(),e.v$.bookForm.$invalid){o.next=18;break}return e.loading=!0,o.prev=3,o.next=6,he.Z.update(e.bookForm);case 6:e.setBook(),e.message="تم التعديل",setTimeout((function(){e.message=""}),1800),o.next=15;break;case 11:o.prev=11,o.t0=o["catch"](3),e.message="حصل خطأ - لم يتم التعديل!",console.log(o.t0);case 15:return o.prev=15,e.loading=!1,o.finish(15);case 18:case"end":return o.stop()}}),o,null,[[3,11,15,18]])})))()}}},Ze=r(83744);const Ve=(0,Ze.Z)(De,[["render",ke]]);var Ue=Ve}}]);
//# sourceMappingURL=5461-legacy.d1c702d0.js.map