"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[5461],{94140:function(e,o,t){var a=t(24150);class r{async getAll(){try{const e=await a.hi.get("book-level");return e.data.data}catch(e){return e}}}o.Z=new r},45347:function(e,o,t){var a=t(24150);class r{async getAllBookTypes(){try{const e=await a.hi.get("/book-type");return e.data.data}catch(e){return e}}async create(e){try{return await a.hi.post("/book-type/create",{type:e})}catch(o){return o}}async getBookTypeById(e){try{const o=await a.hi.post("/book-type/show",{id:e});return o.data}catch(o){return o}}async updateBookTypeById(e,o){try{return await a.hi.post("/book-type/update",{id:e,type:o})}catch(t){return t}}async deleteBookTypeById(e){try{return await a.hi.post("/book-type/delete",{id:e})}catch(o){return o}}}o.Z=new r},34964:function(e,o,t){var a=t(24150),r=t(66252),s=t(79940);class l{async create(e){try{const o=await a.hi.post("/books",e,{headers:{"Content-type":"multipart/form-data"}});return o.data.data}catch(o){(0,r.S3)(o)}}async getAll(e){try{const o=await a.hi.get("books?page="+e);return o.data.data}catch(o){(0,r.S3)(o)}}async getById(e){try{const o=await a.hi.get(`/books/${e}`);return o.data}catch(o){(0,s.F)(o,"BookService.getById")}}async deleteById(e){try{return await a.hi.delete(`/books/${e}`)}catch(o){return o}}async getBooksByType(e){try{const o=await a.hi.get(`/books/type/${e}`);return o.data}catch(o){return o}}async getBooksByLevel(e,o){try{const t=await a.hi.get(`/books/level/${e}?page=${o}`);return t.data.data}catch(t){(0,r.S3)(t)}}async getBooksByName(e,o){try{const t=await a.hi.get(`/books/name?page=${o}&name=${e}`);return t.data.data}catch(t){(0,r.S3)(t)}}async getBooksByLanguage(e,o){try{const t=await a.hi.get(`/books/language/${e}?page=${o}`);return t.data.data}catch(t){(0,r.S3)(t)}}async getBooksBySection(e){try{const o=await a.hi.get(`/books/section/${e}`);return o.data}catch(o){return o}}async getRecentAddedBooks(){try{const e=await a.hi.get("/books/recent-added-books");return e.data.data}catch(e){return console.log(e),""}}async getMostReadableBooks(){try{const e=await a.hi.get("/books/most-readable-books");return e.data.data}catch(e){return console.log(e),""}}async getRandomBook(){try{const e=await a.hi.get("/books/random-book");return e.data.data}catch(e){return console.log(e),""}}async latestBooks(){try{const e=await a.hi.get("/books/latest");return e.data.data}catch(e){return console.log(e),""}}async showBasicInfo(e){try{const o=await a.hi.get(`books/${e}`);return o.data.data}catch(o){return o}}async update(e){try{const o=await a.hi.post("/books/update",e,{headers:{"Content-type":"multipart/form-data"}});return o.data.data}catch(o){(0,r.S3)(o)}}}o.Z=new l},65913:function(e,o,t){var a=t(24150);class r{async getAll(){try{const e=await a.hi.get("language");return e.data.data}catch(e){return e}}}o.Z=new r},92176:function(e,o,t){var a=t(24150);class r{async getAll(){try{const e=await a.hi.get("section");return e.data}catch(e){return e}}}o.Z=new r},60351:function(e,o,t){t.d(o,{So:function(){return a},Wx:function(){return s},b5:function(){return i},gg:function(){return l},jx:function(){return r}});const a={ambassador:"سفير",leader:"قائد",supervisor:"مراقب",advisor:"موجه",consultant:"مستشار",admin:"ادارة",book_quality_team:"جودة الكتب"},r={arabic:"اللغة العربية",english:"اللغة الانجليزية"},s={normal:"منهج",ramadan:"رمضان",young:"يافعين",kids:"أطفال",tafseer:"تفسير",free:"كتاب حر"},l={January:"يناير",February:"فبراير",March:"مارس",April:"ابريل",May:"مايو",June:"يونيو",July:"يوليو",August:"أغسطس",September:"سبتمبر",October:"أكتوبر",November:"نوفمبر",December:"ديسمبر"},i={"01":"يناير","02":"فبراير","03":"مارس","04":"ابريل","05":"مايو","06":"يونيو","07":"يوليو","08":"أغسطس","09":"سبتمبر",10:"أكتوبر",11:"نوفمبر",12:"ديسمبر"}},79940:function(e,o,t){t.d(o,{F:function(){return r}});t(70560);var a=t(1120);function r(e,o=""){throw console.log(`[ERROR] ${o} =>`,e.response.data),404===e.response.data.statusCode?a.Z.push({name:"NotFound"}):403===e.response.data.statusCode&&a.Z.push({name:"NotAuthorized"}),e}},85461:function(e,o,t){t.r(o),t.d(o,{default:function(){return De}});t(76265);var a=t(66252),r=t(3577),s=t(49963),l=t(8584),i=t(79885);const n={class:"col-sm-12 mt-3"},d=(0,a._)("div",{class:"iq-card-header-toolbar d-flex text-center align-items-center mx-auto"},[(0,a._)("h1",{class:"text-center mt-3 mb-3"},"تعديل كتاب")],-1),c={class:"iq-card-body p-4"},u={class:"image-block text-center mt-3"},m=["src"],b={key:1,class:"img-fluid rounded w-75",src:l,alt:"add-group"},k={class:"col-12 bg-white pt-2"},g={class:"text-center mb-3"},h={class:"sign-in-from"},p={class:"form-group"},y=(0,a._)("label",{for:"bookName"},"اسم الكتاب",-1),f={key:0,style:{color:"red"}},_={class:"form-group"},v=(0,a._)("label",{for:"bookDescription"},"وصف الكتاب",-1),w={key:0,style:{color:"red"}},$={class:"form-group"},F=(0,a._)("label",{for:"bookAuther"},"الكاتب",-1),B={key:0,style:{color:"red"}},x={class:"form-group"},q=(0,a._)("label",{for:"bookPublisher"},"دار النشر",-1),D={key:0,style:{color:"red"}},A={class:"form-group"},C=(0,a._)("label",{for:"bookLink"},"رابط الكتاب",-1),S={key:0,style:{color:"red"}},V={class:"form-group"},Z=(0,a._)("label",{for:"bookStartPage"},"صفحة البداية",-1),U={key:0,style:{color:"red"}},T={class:"form-group"},I=(0,a._)("label",{for:"bookEndPage"},"صفحة النهاية",-1),M={key:0,style:{color:"red"}},R={class:"form-group"},L=(0,a._)("label",{for:"bookType"},"نوع الكتاب",-1),z=["disabled"],N=(0,a._)("option",{value:"0",selected:""},"اختر نوع الكتاب",-1),O=["value"],P={key:0,style:{color:"red"}},K={class:"form-group"},E=(0,a._)("label",{for:"bookLevel"},"مستوى الكتاب",-1),H=(0,a._)("option",{value:"0",selected:""},"اختر مستوى الكتاب",-1),W=["value"],Y={key:0,style:{color:"red"}},j={class:"form-group col-12"},J=(0,a._)("h4",null,"قسم الكتاب",-1),G=(0,a._)("option",{value:"",selected:""},"اختر قسم الكتاب",-1),Q=["value"],X={key:0,style:{color:"red"}},ee={class:"form-group col-12"},oe=(0,a._)("h4",null,"لغة الكتاب",-1),te=(0,a._)("option",{value:"0",selected:""},"اختر لغة الكتاب",-1),ae=["value"],re={class:"form-group col-12"},se=(0,a._)("h4",null,"صورة الكتاب",-1),le={key:0,class:"text-center my-2",style:{color:"red"}},ie=(0,a._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),ne={key:1,class:"col-sm-12 text-center"},de=(0,a._)("p",{class:"text-center"},"جاري التعديل",-1),ce=(0,a._)("img",{src:i,alt:"loader",style:{height:"100px"}},null,-1),ue=[de,ce],me={key:2,class:"d-inline-block w-100"},be=["disabled"];function ke(e,o,t,l,i,de){const ce=(0,a.up)("router-link"),ke=(0,a.up)("iq-card");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(ke,{class:"iq-card"},{default:(0,a.w5)((()=>[d,(0,a._)("div",c,[(0,a._)("div",u,[i.currentMedia?((0,a.wg)(),(0,a.iD)("img",{key:0,src:i.currentMedia.path,class:"img-fluid rounded w-25",alt:"blog-img"},null,8,m)):((0,a.wg)(),(0,a.iD)("img",b))])]),(0,a._)("div",k,[(0,a._)("h3",g,(0,r.zw)(i.bookForm.name),1),(0,a._)("div",h,[(0,a._)("form",{class:"mt-2",onSubmit:o[12]||(o[12]=(0,s.iM)((e=>de.onSubmit()),["prevent"]))},[(0,a._)("div",p,[y,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>l.v$.bookForm.name.$model=e),class:"form-control mb-0",id:"bookName",placeholder:" اسم الكتاب"},null,512),[[s.nr,l.v$.bookForm.name.$model]]),l.v$.bookForm.name.$error?((0,a.wg)(),(0,a.iD)("small",f," اسم الكتاب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",_,[v,(0,a.wy)((0,a._)("textarea",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>l.v$.bookForm.brief.$model=e),class:"form-control mb-0",id:"bookDescription",placeholder:"وصف الكتاب ",style:(0,r.j5)([{"padding-right":"1rem !important"},{direction:"rtl","max-height":"120px",resize:"none",overflow:"auto"}]),rows:1,ref:"bodyRef"},null,512),[[s.nr,l.v$.bookForm.brief.$model]]),l.v$.bookForm.brief.$error?((0,a.wg)(),(0,a.iD)("small",w,"وصف الكتاب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",$,[F,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=e=>l.v$.bookForm.writer.$model=e),class:"form-control mb-0",id:"bookAuther",placeholder:"اسم الكاتب "},null,512),[[s.nr,l.v$.bookForm.writer.$model]]),l.v$.bookForm.writer.$error?((0,a.wg)(),(0,a.iD)("small",B,"اسم الكاتب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",x,[q,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>l.v$.bookForm.publisher.$model=e),class:"form-control mb-0",id:"bookPublisher",placeholder:"دار النشر "},null,512),[[s.nr,l.v$.bookForm.publisher.$model]]),l.v$.bookForm.publisher.$error?((0,a.wg)(),(0,a.iD)("small",D,"دار النشر مطلوبة")):(0,a.kq)("",!0)]),(0,a._)("div",A,[C,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=e=>l.v$.bookForm.link.$model=e),class:"form-control mb-0",id:"bookLink",placeholder:"رابط الكتاب "},null,512),[[s.nr,l.v$.bookForm.link.$model]]),l.v$.bookForm.link.$error?((0,a.wg)(),(0,a.iD)("small",S,"رابط الكتاب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",V,[Z,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=e=>l.v$.bookForm.start_page.$model=e),class:"form-control mb-0",id:"bookStartPage",placeholder:"صفحة البداية "},null,512),[[s.nr,l.v$.bookForm.start_page.$model]]),l.v$.bookForm.start_page.$error?((0,a.wg)(),(0,a.iD)("small",U,"صفحة البداية مطلوبة")):(0,a.kq)("",!0)]),(0,a._)("div",T,[I,(0,a.wy)((0,a._)("input",{type:"number","onUpdate:modelValue":o[6]||(o[6]=e=>l.v$.bookForm.end_page.$model=e),class:"form-control mb-0",id:"bookEndPage",placeholder:"صفحة النهاية "},null,512),[[s.nr,l.v$.bookForm.end_page.$model]]),l.v$.bookForm.end_page.$error?((0,a.wg)(),(0,a.iD)("small",M,"صفحة النهاية مطلوبة")):(0,a.kq)("",!0)]),(0,a._)("div",R,[L,(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":o[7]||(o[7]=e=>l.v$.bookForm.type_id.$model=e),class:"form-select","data-trigger":"",name:"choices-single-default",id:"choices-single-default",disabled:!de.shouldfFill},[N,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.types,((e,o)=>((0,a.wg)(),(0,a.iD)("option",{key:o,value:e.id},(0,r.zw)(i.BOOK_Types[e.type]),9,O)))),128))],8,z),[[s.bM,l.v$.bookForm.type_id.$model]]),l.v$.bookForm.type_id.$error?((0,a.wg)(),(0,a.iD)("small",P,"نوع الكتاب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",K,[E,(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":o[8]||(o[8]=e=>l.v$.bookForm.level_id.$model=e),class:"form-select","data-trigger":"",name:"choices-single-default",id:"choices-single-default"},[H,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.bookLevels,((e,o)=>((0,a.wg)(),(0,a.iD)("option",{key:o,value:e.id},(0,r.zw)(e.arabic_level),9,W)))),128))],512),[[s.bM,l.v$.bookForm.level_id.$model]]),l.v$.bookForm.level_id.$error?((0,a.wg)(),(0,a.iD)("small",Y,"مستوى الكتاب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",j,[J,(0,a.wy)((0,a._)("select",{class:"form-select mt-2","data-trigger":"",name:"section",id:"section","onUpdate:modelValue":o[9]||(o[9]=e=>l.v$.bookForm.section_id.$model=e)},[G,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.sections,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.id,value:e.id},(0,r.zw)(e.section),9,Q)))),128))],512),[[s.bM,l.v$.bookForm.section_id.$model]]),l.v$.bookForm.section_id.$error?((0,a.wg)(),(0,a.iD)("small",X,"قسم الكتاب مطلوب")):(0,a.kq)("",!0)]),(0,a._)("div",ee,[oe,(0,a.wy)((0,a._)("select",{class:"form-select mt-2","data-trigger":"",name:"section",id:"section","onUpdate:modelValue":o[10]||(o[10]=e=>l.v$.bookForm.language_id.$model=e)},[te,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.languages,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.id,value:e.id},(0,r.zw)(i.LANUAGES[e.language]),9,ae)))),128))],512),[[s.bM,l.v$.bookForm.language_id.$model]])]),(0,a._)("div",re,[se,(0,a._)("input",{class:"form-control mt-2",type:"file",name:"book_media",id:"book_media",ref:"book_media",accept:"image/*",onChange:o[11]||(o[11]=(...e)=>de.uploadFile&&de.uploadFile(...e))},null,544)]),i.message?((0,a.wg)(),(0,a.iD)("p",le,(0,r.zw)(i.message),1)):(0,a.kq)("",!0),(0,a.Wm)(ce,{class:"mb-3 text-center d-block w-100",to:{name:"book.book-details",params:{book_id:this.$route.params.book_id}}},{default:(0,a.w5)((()=>[(0,a.Uk)(" عرض الكتاب "),ie])),_:1},8,["to"]),i.loading?((0,a.wg)(),(0,a.iD)("div",ne,ue)):((0,a.wg)(),(0,a.iD)("div",me,[(0,a._)("button",{type:"submit",class:"btn btn-primary float-end",disabled:i.loading}," تعديل ",8,be)]))],32)])])])),_:1})])}var ge=t(5705),he=t(10760),pe=t(34964),ye=t(45347),fe=t(65913),_e=t(94140),ve=t(92176),we=t(60351),$e=t(49579);const Fe=e=>e>0;var Be={name:"Update Book",setup(){return{v$:(0,ge.ZP)()}},async created(){this.setBook(),this.bookLevels=await _e.Z.getAll(),this.sections=await ve.Z.getAll(),this.sections=this.sections.data,this.languages=await fe.Z.getAll(),this.types=await ye.Z.getAllBookTypes()},watch:{bookBrief(){this.$refs.bodyRef.style.height="auto",this.$nextTick((()=>{this.$refs.bodyRef.style.height=this.$refs.bodyRef.scrollHeight+"px"}))}},computed:{shouldfFill(){return this.isAdmin||this.inBooksTeam},bookBrief(){return this.bookForm.brief},user(){return this.$store.getters.getUser},inBooksTeam(){return $e.Z.hasRole(this.user,"book_quality_team")},isAdmin(){return $e.Z.hasRole(this.user,"admin")}},data(){return{types:[],bookLevels:[],sections:[],languages:[],LANUAGES:we.jx,BOOK_Types:we.Wx,bookForm:{book_id:this.$route.params.book_id,book_media:null,name:"",writer:"",publisher:"",brief:"",link:"",start_page:0,end_page:0,section_id:0,level_id:0,type_id:0,language_id:0},message:"",loading:!1,currentMedia:null}},validations(){return{bookForm:{name:{required:he.C1},writer:{required:(0,he.CF)((function(){return!!this.shouldfFill}))},publisher:{required:(0,he.CF)((function(){return!!this.shouldfFill}))},brief:{required:(0,he.CF)((function(){return!!this.shouldfFill}))},link:{required:(0,he.CF)((function(){return!!this.shouldfFill}))},start_page:{required:he.C1,maxValue:Fe},end_page:{required:he.C1,maxValue:Fe},type_id:{required:(0,he.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem},level_id:{required:(0,he.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem},language_id:{required:(0,he.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem},section_id:{required:(0,he.CF)((function(){return!!this.shouldfFill})),maxValue:this.selectItem}}}},methods:{selectItem(e){return!this.isAdmin&&!this.inBooksTeam||e>0},async setBook(){const e=await pe.Z.showBasicInfo(this.$route.params.book_id);e&&(this.bookForm.name=e.book.name,this.bookForm.writer=e.book.writer,this.bookForm.publisher=e.book.publisher,this.bookForm.brief=e.book.brief,this.bookForm.link=e.book.link,this.bookForm.start_page=e.book.start_page,this.bookForm.end_page=e.book.end_page,this.bookForm.level_id=e.book.level.id,this.bookForm.language_id=e.book.language.id,this.bookForm.section_id=e.book.section.id,this.bookForm.type_id=e.book.type.id,this.currentMedia=e.book.media)},uploadFile(e){this.bookForm.book_media=e.target.files[0]},async onSubmit(){if(this.v$.$touch(),!this.v$.bookForm.$invalid){this.loading=!0;try{await pe.Z.update(this.bookForm),this.setBook(),this.message="تم التعديل",setTimeout((()=>{this.message=""}),1800)}catch(e){this.message="حصل خطأ - لم يتم التعديل!",console.log(e)}finally{this.loading=!1}}}}},xe=t(83744);const qe=(0,xe.Z)(Be,[["render",ke]]);var De=qe},8584:function(e,o,t){e.exports=t.p+"img/reading_list.1a92b0ea.png"}}]);
//# sourceMappingURL=5461.204b0fd7.js.map