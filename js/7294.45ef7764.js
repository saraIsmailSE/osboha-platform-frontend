"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[7294],{9847:function(t,s,a){var e=a(66252),r=a(24150);class o{async userMonthAchievement(t,s){try{const a=await r.hi.get(`marks/user-month-achievement/${t}/${s}`);return a.data.data}catch(a){(0,e.S3)(a)}}async userWeekAchievement(t,s){try{const a=await r.hi.get(`marks/user-week-achievement/${t}/${s}`);return a.data.data}catch(a){(0,e.S3)(a)}}async ambassadorMark(t,s){try{const a=await r.hi.get(`marks/ambassador-mark/${t}/${s}`);return a.data.data}catch(a){(0,e.S3)(a)}}async acceptSupport(t,s){try{const a=await r.hi.put(`marks/accept-support/user/${t}/${s}`);return a.data}catch(a){(0,e.S3)(a)}}async rejectSupport(t,s){try{const a=await r.hi.put(`marks/reject-support/user/${t}/${s}`);return a.data}catch(a){(0,e.S3)(a)}}async setSupportMarkForAll(t){try{const s=await r.hi.post("/marks/set-support-for-all",t,{headers:{"Content-type":"multipart/form-data"}});return s.data.data}catch(s){(0,e.S3)(s)}}async topUsersByMonth(){try{const t=await r.hi.get("marks/top-users-by-month");return t.data.data}catch(t){(0,e.S3)(t)}}async topUsersByWeek(){try{const t=await r.hi.get("marks/top-users-by-week");return t.data.data}catch(t){(0,e.S3)(t)}}}s.Z=new o},90069:function(t,s,a){a.r(s),a.d(s,{default:function(){return L}});a(76265);var e=a(66252),r=a(49963),o=a(3577),n=a(79885);const c={class:"row"},i={class:"col-lg-8 row m-0 p-0"},d={key:0,class:"col-sm-12"},l={key:1,class:"col-sm-12"},u={class:"form-group"},m={key:0,style:{color:"red"}},p={class:"form-group"},h=["disabled"],k={key:0,class:"col-sm-12 text-center"},y=(0,e._)("img",{src:n,alt:"loader",style:{height:"100px"}},null,-1),w=[y],g={key:1,class:"text-center mt-3 mb-3"};function b(t,s,a,n,y,b){const v=(0,e.up)("AddPost"),$=(0,e.up)("LazyLoadedPosts");return(0,e.wg)(),(0,e.iD)("div",c,[(0,e._)("div",i,[b.isAuthorized&&!y.lastSupportPost?((0,e.wg)(),(0,e.iD)("div",d,[(0,e.Wm)(v,{onAddPost:b.addPost,type:"support",timeline_id:1},null,8,["onAddPost"])])):(0,e.kq)("",!0),b.isAuthorized?((0,e.wg)(),(0,e.iD)("div",l,[y.showReason?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("button",{key:0,class:"btn btn-primary mb-3",onClick:s[0]||(s[0]=t=>y.showReason=!0)},"اعتماد العلامة للكل")),y.showReason?((0,e.wg)(),(0,e.iD)("button",{key:1,class:"btn btn-danger mb-3",onClick:s[1]||(s[1]=t=>y.showReason=!1)},"تراجع")):(0,e.kq)("",!0),y.showReason?((0,e.wg)(),(0,e.iD)("form",{key:2,onSubmit:s[3]||(s[3]=(0,r.iM)(((...t)=>b.setSupportMarkForAll&&b.setSupportMarkForAll(...t)),["prevent"])),class:"post-text ml-3 w-100 row"},[(0,e._)("div",u,[(0,e.wy)((0,e._)("textarea",{rows:"3",placeholder:"سبب الاعتماد",class:"rounded form-control mt-2 col-12",id:"reason","onUpdate:modelValue":s[2]||(s[2]=t=>n.v$.setMarkForm.reason.$model=t),name:"bio"},"\n                ",512),[[r.nr,n.v$.setMarkForm.reason.$model]]),n.v$.setMarkForm.reason.$error?((0,e.wg)(),(0,e.iD)("small",m," قم بادخال سبب عدد حروفه بين 10 و 500 ")):(0,e.kq)("",!0)]),(0,e._)("div",p,[(0,e._)("button",{type:"submit",disabled:y.message,class:"btn d-block btn-primary mt-1 mb-3 w-75 mx-auto"}," اعتماد ",8,h)]),y.loader?((0,e.wg)(),(0,e.iD)("div",k,w)):(0,e.kq)("",!0),y.message?((0,e.wg)(),(0,e.iD)("h4",g,(0,o.zw)(y.message),1)):(0,e.kq)("",!0)],32)):(0,e.kq)("",!0)])):(0,e.kq)("",!0),(0,e.Wm)($,{ref:"lazyLoadedPostsRef",type:"support",displayEmpty:!0},null,512)])])}var v=a(91627),$=a(44907),S=a(49579),f=a(8417),M=a(9847),P=a(5705),A=a(10760),F={name:"Support",setup(){return{v$:(0,P.ZP)()}},components:{AddPost:v.Z,LazyLoadedPosts:$.Z},data(){return{lastSupportPost:{},showReason:!1,setMarkForm:{reason:""},loader:!1,message:null}},validations(){return{setMarkForm:{reason:{required:A.C1,maxLength:(0,A.BS)(500),minLength:(0,A.Ei)(10)}}}},computed:{isAuthorized(){const t=this.$store.getters.getUser;return S.Z.hasRoles(t,["admin","consultant"])}},created(){f.Z.getLastSupportPost().then((t=>{this.lastSupportPost=t.data})).catch((t=>{console.log(t)}))},methods:{addPost(t){this.$refs.lazyLoadedPostsRef.addNewPost(t)},async setSupportMarkForAll(){if(this.v$.$touch(),!this.v$.setMarkForm.$invalid){this.message="",this.loader=!0;try{const t=await M.Z.setSupportMarkForAll(this.setMarkForm);this.loader=!1,this.message=t,this.v$.setMarkForm.$reset()}catch(t){console.log(t)}}}}},q=a(83744);const D=(0,q.Z)(F,[["render",b]]);var L=D}}]);
//# sourceMappingURL=7294.45ef7764.js.map