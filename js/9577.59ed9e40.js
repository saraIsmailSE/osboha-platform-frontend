"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[9577],{2985:function(e,t,a){var o=a(66252),r=a(79940),i=a(24150);class n{async create(e){try{const t=await i.hi.post("/userexception/create",e,{headers:{"Content-type":"multipart/form-data"}});return t.data.data}catch(t){(0,o.S3)(t)}}async setExceptionalFreez(e){try{const t=await i.hi.post("/userexception/set-exceptional-freez",e,{headers:{"Content-type":"multipart/form-data"}});return t.data.data}catch(t){(0,o.S3)(t)}}async setNewUser(e){try{const t=await i.hi.post("/userexception/set-new-user",e,{headers:{"Content-type":"multipart/form-data"}});return t.data.data}catch(t){(0,o.S3)(t)}}async getExceptionById(e){try{const t=await i.hi.get(`userexception/show/${e}`);return t.data.data}catch(t){(0,r.F)(t)}}async update(e,t){try{const a=await i.hi.patch(`userexception/${e}`,t,{headers:{"Content-type":"multipart/form-data"}});return a.data.data}catch(a){return a}}async updateStatus(e,t){try{const a=await i.hi.patch(`userexception/update-status/${e}`,{decision:t.decision,note:t.note,week_id:t.week_id});return a.data.data}catch(a){return a}}async updateExceptionTypeById(e,t){try{return await i.hi.post("/userexception/update",{id:e,type:t})}catch(a){return a}}async cancelException(e){try{return await i.hi.get(`userexception/cancel/${e}`)}catch(t){return t}}async getAllUserExceptions(e){try{const t=await i.hi.get(`userexception/user-exceptions/${e}`);return t.data.data}catch(t){return t}}async exceptionsFilter(e,t){try{const a=await i.hi.get(`userexception/exceptions-filter/${e}/${t}`);return a.data.data}catch(a){return a}}}t.Z=new n},79940:function(e,t,a){a.d(t,{F:function(){return r}});a(70560);var o=a(1120);function r(e,t=""){throw console.log(`[ERROR] ${t} =>`,e.response.data),404===e.response.data.statusCode?o.Z.push({name:"NotFound"}):403===e.response.data.statusCode&&o.Z.push({name:"NotAuthorized"}),e}},39577:function(e,t,a){a.r(t),a.d(t,{default:function(){return _e}});a(76265);var o=a(66252),r=a(49963),i=a(3577),n=a(55415),s=a(79885);const c={class:"col-sm-12 mt-3 text-center"},d=(0,o._)("div",{class:"iq-card-header-toolbar d-flex align-items-center mx-auto"},[(0,o._)("h3",{class:"text-center mt-3 mb-3"},"طلب اجازة")],-1),l={class:"iq-card-body p-3"},m=(0,o._)("div",{class:"image-block text-center"},[(0,o._)("img",{src:n,class:"img-fluid rounded w-50",alt:"blog-img"})],-1),p={class:"d-flex align-items-center mt-3"},u={class:"form-group col-12"},x=(0,o._)("h4",null,"نوع الاجازة",-1),y=["disabled"],_=(0,o._)("option",{value:"0",selected:""},"اختر نوع الاجازة",-1),h=["value"],g={key:0,class:"d-block text-start mt-1",style:{color:"red"}},w={key:0,class:"form-group col-12"},v=(0,o._)("h4",null,"تاريخ انتهاء الاجازة",-1),$=["disabled"],f={key:0,class:"d-block text-start mt-1",style:{color:"red"}},k={key:1,class:"d-block text-start mt-1",style:{color:"red"}},b={key:1,class:"form-group"},F=(0,o._)("h4",null,"المدة المطلوبة",-1),q={class:"form-group row"},D=["disabled"],E=(0,o._)("option",{value:"",selected:""},"اختر مدة الاجازة",-1),C=(0,o._)("option",{value:"أسبوع واحد"}," أسبوع واحد ",-1),T=(0,o._)("option",{value:"أسبوعين"}," أسبوعين ",-1),S=(0,o._)("option",{value:"ثلاثة أسابيع"}," ثلاثة أسابيع ",-1),U=[E,C,T,S],Z={key:0,class:"d-block text-start mt-1",style:{color:"red"}},z={key:2,class:"form-group"},A=(0,o._)("h4",null," أرفق جدول الامتحانات ",-1),B={class:"form-check mt-2 w-100 text-start"},I=["checked"],R=(0,o._)("label",{class:"form-check-label",for:"no_exam_media"}," لا امتلك جدول ثابت للامتحانات ",-1),V={key:0,class:"d-block text-start mt-1",style:{color:"red"}},N={class:"form-group"},O=(0,o._)("h4",null,"السبب",-1),M={class:"form-group row"},H=["disabled"],L={class:"mb-0"},Y={key:0,class:"d-block text-start mt-1",style:{color:"red"}},K=(0,o._)("hr",null,null,-1),P={class:"form-group"},W=["disabled"],j={key:3,class:"col-sm-12 text-center"},G=(0,o._)("img",{src:s,alt:"loader",style:{height:"100px"}},null,-1),J=[G],Q={key:4,class:"text-center mt-3 mb-3"},X={class:"d-flex align-items-center mt-3 row"},ee={class:"d-inline-block w-100 text-center col-12"},te=(0,o._)("span",null,"عودة للملف الشخصي",-1),ae=(0,o._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),oe=[te,ae];function re(e,t,a,n,s,E){const C=(0,o.up)("iq-card");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(C,{class:"iq-card"},{default:(0,o.w5)((()=>[d,(0,o._)("div",l,[m,(0,o._)("div",p,[(0,o._)("form",{onSubmit:t[6]||(t[6]=(0,r.iM)(((...e)=>E.submitException&&E.submitException(...e)),["prevent"])),class:"post-text ml-3 w-100 row"},[(0,o._)("div",u,[x,(0,o.wy)((0,o._)("select",{disabled:s.message,"onUpdate:modelValue":t[0]||(t[0]=e=>n.v$.exceptionForm.type_id.$model=e),class:"form-select mt-2","data-trigger":"",name:"type_id",id:"eceptionType"},[_,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.exceptionTypes,((e,t)=>((0,o.wg)(),(0,o.iD)("option",{key:t,value:e.id},(0,i.zw)(e.type),9,h)))),128))],8,y),[[r.bM,n.v$.exceptionForm.type_id.$model]]),n.v$.exceptionForm.type_id.$error?((0,o.wg)(),(0,o.iD)("small",g," * يرجى اختيار نوع الاجازة")):(0,o.kq)("",!0)]),E.isAdmin&&5==n.v$.exceptionForm.type_id.$model?((0,o.wg)(),(0,o.iD)("div",w,[v,(0,o.wy)((0,o._)("input",{disabled:s.message,type:"date",class:"form-control mt-2",id:"exceptionEndDate","onUpdate:modelValue":t[1]||(t[1]=e=>n.v$.exceptionForm.end_date.$model=e),name:"end_date"},null,8,$),[[r.nr,n.v$.exceptionForm.end_date.$model]]),n.v$.exceptionForm.end_date.$error?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[n.v$.exceptionForm.end_date.required.$invalid?((0,o.wg)(),(0,o.iD)("small",f," * يرجى اختيار تاريخ انتهاء الاجازة ")):(0,o.kq)("",!0),n.v$.exceptionForm.end_date.date_format.$invalid?((0,o.wg)(),(0,o.iD)("small",k," * يرجى اختيار تاريخ انتهاء الاجازة بتاريخ لا يقل عن اليوم ")):(0,o.kq)("",!0)],64)):(0,o.kq)("",!0)])):(0,o.kq)("",!0),3==s.exceptionForm.type_id||4==s.exceptionForm.type_id||5==s.exceptionForm.type_id?((0,o.wg)(),(0,o.iD)("div",b,[F,(0,o._)("div",q,[(0,o.wy)((0,o._)("select",{disabled:s.message,"onUpdate:modelValue":t[2]||(t[2]=e=>n.v$.exceptionForm.desired_duration.$model=e),class:"form-select mt-2","data-trigger":"",name:"desired_duration",id:"desired_duration"},U,8,D),[[r.bM,n.v$.exceptionForm.desired_duration.$model]])]),n.v$.exceptionForm.desired_duration.$error?((0,o.wg)(),(0,o.iD)("small",Z," * يرجى اختيار مدة الاجازة ")):(0,o.kq)("",!0)])):(0,o.kq)("",!0),3==s.exceptionForm.type_id||4==s.exceptionForm.type_id?((0,o.wg)(),(0,o.iD)("div",z,[A,(0,o._)("input",{class:"form-control mt-2",type:"file",name:"exam_media",id:"exam_media",ref:"exam_media",accept:"image/*",onChange:t[3]||(t[3]=(...e)=>E.uploadFile&&E.uploadFile(...e))},null,544),(0,o._)("div",B,[(0,o._)("input",{type:"checkbox",checked:s.no_exam_media,class:"form-check-input",id:"no_exam_media",ref:"no_exam_media",onClick:t[4]||(t[4]=e=>s.no_exam_media=!s.no_exam_media)},null,8,I),R]),n.v$.exceptionForm.exam_media.$invalid?((0,o.wg)(),(0,o.iD)("small",V," * يرجى ارفاق جدول الامتحانات في حال وجود جدول ثابت ")):(0,o.kq)("",!0)])):(0,o.kq)("",!0),(0,o._)("div",N,[O,(0,o._)("div",M,[(0,o.wy)((0,o._)("textarea",{disabled:s.message,rows:"5",placeholder:"سبب طلب الاجازة",class:"rounded form-control mt-2 col-12",id:"exceptionReason","onUpdate:modelValue":t[5]||(t[5]=e=>n.v$.exceptionForm.reason.$model=e),name:"reason"},"\r\n                ",8,H),[[r.nr,n.v$.exceptionForm.reason.$model]]),(0,o._)("p",L,[(0,o._)("span",{class:(0,i.C_)({"text-danger":n.v$.exceptionForm.reason.$error})},(0,i.zw)(n.v$.exceptionForm.reason.$model.length),3),(0,o.Uk)(" /250 ")])]),n.v$.exceptionForm.reason.$error?((0,o.wg)(),(0,o.iD)("small",Y," * قم بادخال سبب لا ينقص عن 10 حروف ولا يزيد عن 250 حرف ")):(0,o.kq)("",!0)]),K,(0,o._)("div",P,[(0,o._)("button",{type:"submit",disabled:s.message,class:"btn d-block btn-primary mt-3 mb-3 w-75 mx-auto"}," ارسال ",8,W)]),s.loader?((0,o.wg)(),(0,o.iD)("div",j,J)):(0,o.kq)("",!0),s.message?((0,o.wg)(),(0,o.iD)("h4",Q,(0,i.zw)(s.message),1)):(0,o.kq)("",!0)],32)]),(0,o._)("div",X,[(0,o._)("div",ee,[(0,o._)("a",{role:"button",onClick:t[7]||(t[7]=e=>E.back()),class:"d-block mt-3 mb-3 w-75 mx-auto"},oe)])])])])),_:1})])}a(70560);var ie=a(24150);class ne{async create(e){try{return await ie.hi.post("/exception-type/create",{type:e})}catch(t){throw t(t)}}async getAllExceptionTypes(){try{const e=await ie.hi.get("/exception-type");return e.data.data}catch(e){return e}}async getExceptionTypeById(e){try{const t=await ie.hi.post("/exception-type/show",{id:e});return t.data}catch(t){return t}}async updateExceptionTypeById(e,t){try{return await ie.hi.post("/exception-type/update",{id:e,type:t})}catch(a){return a}}async deleteExceptionTypeById(e){try{return await ie.hi.post("/exception-type/delete",{id:e})}catch(t){return t}}}var se=new ne,ce=a(2985),de=a(5705),le=a(10760),me=a(49579);const pe=e=>e>0;var ue={name:"New Exception",async created(){this.exceptionTypes=await se.getAllExceptionTypes()},components:{},setup(){return{v$:(0,de.ZP)()}},data(){return{loader:!1,exceptionForm:{reason:"",type_id:0,end_date:(new Date).toISOString().slice(0,10),desired_duration:"",exam_media:[]},no_exam_media:!0,exceptionTypes:null,message:null}},computed:{isAdmin(){return me.Z.hasRole(this.$store.getters.getUser,"admin")}},validations(){return{exceptionForm:{reason:{required:le.C1,minLength:(0,le.Ei)(10),maxLength:(0,le.BS)(250)},type_id:{required:le.C1,maxValue:pe},desired_duration:{required:(0,le.CF)((function(){return 3==this.exceptionForm.type_id||4==this.exceptionForm.type_id||5==this.exceptionForm.type_id}))},exam_media:{required:(0,le.CF)((function(){return!this.no_exam_media}))},end_date:{required:le.C1,date_format:e=>{const t=new Date,a=new Date(t);return a.setDate(a.getDate()-1),new Date(e)>a}}}}},methods:{async submitException(){if(this.v$.$touch(),!this.v$.exceptionForm.$invalid){this.message="",this.loader=!0;try{const e=await ce.Z.create(this.exceptionForm);this.message=e,this.v$.exceptionForm.$reset()}catch(e){console.log("[Exception request error]",e)}finally{this.loader=!1}}},uploadFile(){this.exceptionForm.exam_media=this.$refs.exam_media.files[0]},back(){this.$router.push({name:"user.profile",params:{user_id:this.$route.params.user_id}})}}},xe=a(83744);const ye=(0,xe.Z)(ue,[["render",re]]);var _e=ye},55415:function(e,t,a){e.exports=a.p+"img/update-forms.03f6433b.png"}}]);
//# sourceMappingURL=9577.59ed9e40.js.map