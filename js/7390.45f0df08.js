"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[7390],{2985:function(e,t,s){var a=s(66252),i=s(79940),o=s(24150);class n{async create(e){try{const t=await o.hi.post("/userexception/create",e,{headers:{"Content-type":"multipart/form-data"}});return t.data.data}catch(t){(0,a.S3)(t)}}async setExceptionalFreez(e){try{const t=await o.hi.post("/userexception/set-exceptional-freez",e,{headers:{"Content-type":"multipart/form-data"}});return t.data.data}catch(t){(0,a.S3)(t)}}async setNewUser(e){try{const t=await o.hi.post("/userexception/set-new-user",e,{headers:{"Content-type":"multipart/form-data"}});return t.data.data}catch(t){(0,a.S3)(t)}}async getExceptionById(e){try{const t=await o.hi.get(`userexception/show/${e}`);return t.data.data}catch(t){(0,i.F)(t)}}async update(e,t){try{const s=await o.hi.patch(`userexception/${e}`,t,{headers:{"Content-type":"multipart/form-data"}});return s.data.data}catch(s){return s}}async updateStatus(e,t){try{const s=await o.hi.patch(`userexception/update-status/${e}`,{decision:t.decision,note:t.note,week_id:t.week_id});return s.data.data}catch(s){return s}}async updateExceptionTypeById(e,t){try{return await o.hi.post("/userexception/update",{id:e,type:t})}catch(s){return s}}async cancelException(e){try{return await o.hi.get(`userexception/cancel/${e}`)}catch(t){return t}}async getAllUserExceptions(e){try{const t=await o.hi.get(`userexception/user-exceptions/${e}`);return t.data.data}catch(t){return t}}async exceptionsFilter(e,t){try{const s=await o.hi.get(`userexception/exceptions-filter/${e}/${t}`);return s.data.data}catch(s){return s}}}t.Z=new n},79940:function(e,t,s){s.d(t,{F:function(){return i}});s(70560);var a=s(1120);function i(e,t=""){throw console.log(`[ERROR] ${t} =>`,e.response.data),404===e.response.data.statusCode?a.Z.push({name:"NotFound"}):403===e.response.data.statusCode&&a.Z.push({name:"NotAuthorized"}),e}},47390:function(e,t,s){s.r(t),s.d(t,{default:function(){return vt}});var a=s(66252);function i(e,t,s,i,o,n){const l=(0,a.up)("listOne",!0);return(0,a.wg)(),(0,a.j4)(l,{exception:o.exception,last_freez:o.last_freez,last_exam:o.last_exam,weeks:o.weeks,last_exceptional_freez:o.last_exceptional_freez,authInGroup:o.authInGroup,onUpdate_exception:n.updateException},null,8,["exception","last_freez","last_exam","weeks","last_exceptional_freez","authInGroup","onUpdate_exception"])}s(76265);var o=s(3577),n=s(49963),l=s(79885);const c={key:0,class:"col-sm-12 mt-3 text-center"},r={class:"iq-card-header-toolbar d-flex align-items-center mx-auto"},d={class:"text-center mt-3 mb-3"},u={class:"iq-card-body"},p={class:"image-block text-center"},m={class:"profile-img"},_={class:"text-center mt-3 mb-3"},h={class:"iq-card-body ps-3 pe-3 mt-1"},x={class:"mb-2"},g={key:0,class:"m-auto"},w=(0,a._)("span",{class:"badge bg-warning"},"تحت المراجعة",-1),y=[w],k={key:1,class:"m-auto"},f=(0,a._)("span",{class:"badge bg-primary"},"مقبول",-1),b=[f],v={key:2,class:"m-auto"},$=(0,a._)("span",{class:"badge bg-danger"},"مرفوض",-1),z=[$],D={key:3,class:"m-auto"},q=(0,a._)("span",{class:"badge bg-success"},"منتهي",-1),E=[q],F={key:4,class:"m-auto"},C=(0,a._)("span",{class:"badge bg-danger"},"ملغي",-1),W=[C],I={class:"m-auto"},Z=(0,a._)("h4",{class:"mb-2"},"السبب",-1),G={class:"m-auto"},O=(0,a._)("h4",{class:"mb-2"},"المدة المطلوبة",-1),j={class:"m-auto"},U={key:0},B=(0,a._)("h4",{class:"mb-2"},"جدول الامتحانات",-1),S=["src"],V={key:1,class:"m-auto"},M={key:1,class:"table w-100"},T=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"المسؤول"),(0,a._)("th",{scope:"col",colspan:"3"},"ملاحظاته")])],-1),L={key:2,class:"alert alert-danger mt-2"},A=(0,a._)("h4",null,"أخر الاجازات",-1),N={key:0},R=(0,a._)("h5",null,"أخر تجميد",-1),P={key:1},H=(0,a._)("h5",null,"أخر نظام امتحانات",-1),J={key:2},K=(0,a._)("h5",null,"أخر تجميد استثنائي",-1),Q={key:0},X=(0,a._)("h3",{class:"text-center mt-3 mb-3"},"الاجراء المناسب",-1),Y={key:0},ee={class:"form-group text-start ms-3"},te=(0,a._)("h4",{class:"mt-3 mb-3"},"اختر الأسبوع",-1),se={class:"form-check form-check-inline"},ae=["value"],ie={class:"form-check-label fs-4",for:"currentWeek"},oe={class:"form-check form-check-inline"},ne=["value"],le={class:"form-check-label fs-4",for:"previousWeek"},ce={key:0,style:{color:"red"}},re={key:0,class:"d-flex align-items-center mt-3"},de={class:"form-group col-12"},ue=["disabled"],pe=(0,a._)("option",{value:"-1",selected:""},"اختر الاجراء المناسب",-1),me=(0,a._)("option",{value:"1"},"اعفاء الأسبوع الحالي",-1),_e=(0,a._)("option",{value:"2"},"اعفاء الأسبوع القادم",-1),he=(0,a._)("option",{value:"3"}," اعفاء الأسبوعين القادمين [ الحالي + القادم] ",-1),xe=(0,a._)("option",{value:"0"},"رفض",-1),ge=[pe,me,_e,he,xe],we={key:0,style:{color:"red"}},ye={class:"form-group col-12"},ke=(0,a._)("label",{class:"form-label",for:"note"},"ملاحظاتك",-1),fe=["disabled"],be={key:0,style:{color:"red"}},ve={class:"form-group"},$e=["disabled"],ze={key:0,class:"col-sm-12 text-center"},De=(0,a._)("img",{src:l,alt:"loader",style:{height:"100px"}},null,-1),qe=[De],Ee={key:1,class:"text-center mt-3 mb-3"},Fe={key:1,class:"d-flex align-items-center mt-3"},Ce={class:"form-group col-12"},We=["disabled"],Ie=(0,a._)("option",{value:"-1",selected:""},"اختر الاجراء المناسب",-1),Ze=(0,a._)("option",{value:"1"},"اعفاء الأسبوع الحالي",-1),Ge=(0,a._)("option",{value:"2"},"اعفاء الأسبوع القادم",-1),Oe=(0,a._)("option",{value:"3"}," اعفاء الأسبوعين القادمين [ الحالي + القادم] ",-1),je=(0,a._)("option",{value:"4"}," اعفاء ثلاثة أسابيع [ الحالي + القادم + الذي يليه] ",-1),Ue=(0,a._)("option",{value:"0"},"رفض",-1),Be=[Ie,Ze,Ge,Oe,je,Ue],Se={key:0,style:{color:"red"}},Ve={class:"form-group col-12"},Me=(0,a._)("label",{class:"form-label",for:"note"},"ملاحظاتك",-1),Te=["disabled"],Le={key:0,style:{color:"red"}},Ae={class:"form-group"},Ne=["disabled"],Re={key:0,class:"col-sm-12 text-center"},Pe=(0,a._)("img",{src:l,alt:"loader",style:{height:"100px"}},null,-1),He=[Pe],Je={key:1,class:"text-center mt-3 mb-3"},Ke={key:2,class:"d-inline-flex justify-content-center alert alert-success mt-2 w-75"},Qe=(0,a._)("h5",null,"يتطلب هذا الاجراء موافقة موجه المجموعة",-1),Xe=[Qe],Ye={key:1,class:"d-inline-flex justify-content-center alert alert-success mt-2 w-75"},et=(0,a._)("h5",null,"تم اتخاذ الاجراء مسبقًا",-1),tt=(0,a._)("hr",null,null,-1),st=[et,tt],at={key:1,class:"d-inline-flex justify-content-center w-100"},it={class:"d-flex align-items-center mt-3 row"},ot={class:"d-inline-block w-100 text-center col-12"},nt=(0,a._)("span",null,"عودة",-1),lt=(0,a._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),ct=[nt,lt];function rt(e,t,s,i,l,w){const f=(0,a.up)("BaseAvatar"),$=(0,a.up)("iq-card");return s.exception?((0,a.wg)(),(0,a.iD)("div",c,[(0,a.Wm)($,{class:"iq-card"},{default:(0,a.w5)((()=>{var c,$;return[(0,a._)("div",r,[(0,a._)("h3",d," طلب: "+(0,o.zw)(s.exception.type.type),1)]),(0,a._)("div",u,[(0,a._)("div",p,[(0,a._)("div",m,[(0,a.Wm)(f,{profileImg:s.exception.user.user_profile.profile_picture,profile_id:s.exception.user.user_profile.id,dimensions:"512x512",title:null===(c=s.exception.user)||void 0===c?void 0:c.name,gender:null===($=s.exception.user)||void 0===$?void 0:$.gender,avatarClass:"avatar-130 img-fluid",containerClass:"flex-shrink-0"},null,8,["profileImg","profile_id","title","gender"]),(0,a._)("h4",_,(0,o.zw)(s.exception.user.name),1)])]),(0,a._)("div",h,[(0,a._)("h4",x,["pending"==s.exception.status?((0,a.wg)(),(0,a.iD)("p",g,y)):(0,a.kq)("",!0),"accepted"==s.exception.status?((0,a.wg)(),(0,a.iD)("p",k,b)):(0,a.kq)("",!0),"rejected"==s.exception.status?((0,a.wg)(),(0,a.iD)("p",v,z)):(0,a.kq)("",!0),"finished"==s.exception.status?((0,a.wg)(),(0,a.iD)("p",D,E)):(0,a.kq)("",!0),"cancelled"==s.exception.status?((0,a.wg)(),(0,a.iD)("p",F,W)):(0,a.kq)("",!0)]),(0,a._)("p",I," تاريخ الطلب: "+(0,o.zw)(e.formatFullDate(s.exception.created_at)),1),Z,(0,a._)("p",G,(0,o.zw)(s.exception.reason),1),O,(0,a._)("p",j,(0,o.zw)(s.exception.desired_duration),1),"نظام امتحانات - شهري"==s.exception.type.type||"نظام امتحانات - فصلي"==s.exception.type.type?((0,a.wg)(),(0,a.iD)("div",U,[B,s.exception.media?((0,a.wg)(),(0,a.iD)("img",{key:0,class:"img-fluid w-75",src:w.showMedia(s.exception.media.id)},null,8,S)):((0,a.wg)(),(0,a.iD)("p",V," لا يوجد جدول ثابت للامتحانات "))])):(0,a.kq)("",!0),s.exception.reviewer?((0,a.wg)(),(0,a.iD)("table",M,[T,(0,a._)("tbody",null,[(0,a._)("tr",null,[(0,a._)("td",null,(0,o.zw)(s.exception.reviewer.name),1),(0,a._)("td",null,(0,o.zw)(s.exception.note),1)])])])):(0,a.kq)("",!0),s.last_freez||s.last_exam||s.last_exceptional_freez?((0,a.wg)(),(0,a.iD)("div",L,[A,(0,a._)("ul",null,[s.last_freez?((0,a.wg)(),(0,a.iD)("li",N,[R,(0,a._)("p",null,(0,o.zw)(s.last_freez.end_at),1)])):(0,a.kq)("",!0),s.last_exam?((0,a.wg)(),(0,a.iD)("li",P,[H,(0,a._)("p",null,(0,o.zw)(s.last_exam.end_at),1)])):(0,a.kq)("",!0),s.last_exceptional_freez?((0,a.wg)(),(0,a.iD)("li",J,[K,(0,a._)("p",null,(0,o.zw)(s.last_exceptional_freez.end_at),1)])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)]),s.authInGroup&&"ambassador"!=s.authInGroup.user_type?((0,a.wg)(),(0,a.iD)("div",Q,[X,"pending"==s.exception.status?((0,a.wg)(),(0,a.iD)("div",Y,[(0,a._)("div",ee,[te,(0,a._)("div",se,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"radio",name:"weeks",id:"currentWeek","onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedWeek=e),value:`${s.weeks[0].id}`,onChange:t[1]||(t[1]=e=>l.selectedWeekError="")},null,40,ae),[[n.G2,l.selectedWeek]]),(0,a._)("label",ie,(0,o.zw)(s.weeks[0].title)+" [الأسبوع الحالي]",1)]),(0,a._)("div",oe,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"radio",name:"weeks",id:"previousWeek","onUpdate:modelValue":t[2]||(t[2]=e=>l.selectedWeek=e),value:`${s.weeks[1].id}`,onChange:t[3]||(t[3]=e=>l.selectedWeekError="")},null,40,ne),[[n.G2,l.selectedWeek]]),(0,a._)("label",le,(0,o.zw)(s.weeks[1].title),1)]),l.selectedWeekError?((0,a.wg)(),(0,a.iD)("small",ce," * "+(0,o.zw)(l.selectedWeekError),1)):(0,a.kq)("",!0)]),"تجميد استثنائي"!=s.exception.type.type?((0,a.wg)(),(0,a.iD)("div",re,[(0,a._)("form",{onSubmit:t[6]||(t[6]=(0,n.iM)(((...e)=>w.submitDecision&&w.submitDecision(...e)),["prevent"])),class:"post-text m-auto w-100 row"},[(0,a._)("div",de,[(0,a.wy)((0,a._)("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=e=>i.v$.decideForm.decision.$model=e),disabled:l.message},ge,8,ue),[[n.bM,i.v$.decideForm.decision.$model]]),i.v$.decideForm.decision.$error?((0,a.wg)(),(0,a.iD)("small",we," هذا الخيار مطلوب ")):(0,a.kq)("",!0)]),(0,a._)("div",ye,[ke,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>i.v$.decideForm.note.$model=e),rows:"5",placeholder:"... اكتب ملاحظة",class:"rounded form-control",id:"note",disabled:l.message},null,8,fe),[[n.nr,i.v$.decideForm.note.$model]]),i.v$.decideForm.note.$error?((0,a.wg)(),(0,a.iD)("small",be," * ملاحظاتك مطلوبة ")):(0,a.kq)("",!0)]),(0,a._)("div",ve,[(0,a._)("button",{type:"submit",disabled:l.message,class:"btn d-block btn-primary mt-3 mb-3 w-75 mx-auto"}," اعتماد ",8,$e)]),l.loader?((0,a.wg)(),(0,a.iD)("div",ze,qe)):(0,a.kq)("",!0),l.message?((0,a.wg)(),(0,a.iD)("h4",Ee,(0,o.zw)(l.message),1)):(0,a.kq)("",!0)],32)])):"تجميد استثنائي"!=s.exception.type.type||!s.authInGroup||"admin"!=s.authInGroup.user_type&&"advisor"!=s.authInGroup.user_type?((0,a.wg)(),(0,a.iD)("div",Ke,Xe)):((0,a.wg)(),(0,a.iD)("div",Fe,[(0,a._)("form",{onSubmit:t[9]||(t[9]=(0,n.iM)(((...e)=>w.submitDecision&&w.submitDecision(...e)),["prevent"])),class:"post-text m-auto w-100 row"},[(0,a._)("div",Ce,[(0,a.wy)((0,a._)("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=e=>i.v$.decideForm.decision.$model=e),disabled:l.message},Be,8,We),[[n.bM,i.v$.decideForm.decision.$model]]),i.v$.decideForm.decision.$error?((0,a.wg)(),(0,a.iD)("small",Se," هذا الخيار مطلوب ")):(0,a.kq)("",!0)]),(0,a._)("div",Ve,[Me,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>i.v$.decideForm.note.$model=e),rows:"5",placeholder:"... اكتب ملاحظة",class:"rounded form-control",id:"note",disabled:l.message},null,8,Te),[[n.nr,i.v$.decideForm.note.$model]]),i.v$.decideForm.note.$error?((0,a.wg)(),(0,a.iD)("small",Le," * ملاحظاتك مطلوبة ")):(0,a.kq)("",!0)]),(0,a._)("div",Ae,[(0,a._)("button",{type:"submit",disabled:l.message,class:"btn d-block btn-primary mt-3 w-75 mx-auto"}," اعتماد ",8,Ne)]),l.loader?((0,a.wg)(),(0,a.iD)("div",Re,He)):(0,a.kq)("",!0),l.message?((0,a.wg)(),(0,a.iD)("h4",Je,(0,o.zw)(l.message),1)):(0,a.kq)("",!0)],32)]))])):((0,a.wg)(),(0,a.iD)("div",Ye,st))])):(0,a.kq)("",!0),s.exception.user.id!=w.auth.id||"accepted"!=s.exception.status&&"pending"!=s.exception.status?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",at,[(0,a._)("button",{onClick:t[10]||(t[10]=e=>w.cancelException(s.exception.id)),class:"btn btn-danger d-block w-75"}," الغاء ")])),(0,a._)("div",it,[(0,a._)("div",ot,[(0,a._)("a",{role:"button",onClick:t[11]||(t[11]=t=>e.$router.go(-1)),class:"d-block mt-3 mb-3 w-75 mx-auto"},ct)])])])]})),_:1})])):(0,a.kq)("",!0)}var dt=s(43144),ut=s(2985),pt=s(5705),mt=s(10760),_t=(s(49579),s(8209)),ht=s(89314);const xt=e=>e>-1;var gt={name:"List One Exception",setup(){return{v$:(0,pt.ZP)()}},props:{exception:{type:Object},last_freez:{type:Object},last_exam:{type:Object},last_exceptional_freez:{type:Object},authInGroup:{type:Object},weeks:{type:Object}},data(){return{decideForm:{note:"",decision:-1,week_id:0},message:null,loader:!1,selectedWeek:null,selectedWeekError:""}},computed:{auth(){return this.$store.getters.getUser}},validations(){return{decideForm:{note:{required:mt.C1,minLength:(0,mt.Ei)(10),maxLength:(0,mt.BS)(250)},decision:{required:mt.C1,maxValue:xt}}}},methods:(0,dt.Z)((0,dt.Z)({},_t.Z),{},{async submitDecision(){if(this.selectedWeekError="",this.selectedWeek){if(this.v$.$touch(),!this.v$.decideForm.$invalid){this.message="",this.loader=!0;try{this.decideForm.week_id=this.selectedWeek;const e=await ut.Z.updateStatus(this.exception.id,this.decideForm);this.loader=!1,this.message=e,_t.Z.toggleToast(this.message,"success"),this.$emit("update_exception"),this.v$.decideForm.$reset()}catch(e){console.log(e)}}}else this.selectedWeekError="يجب اختيار الأسبوع"},cancelException(e){const t=this.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-primary btn-lg ms-2"},buttonsStyling:!1});t.fire({title:"هل أنت متأكد؟",text:"موافقتك تعني الغاء هذا الاعفاء وحساب علامتك لهذا الاسبوع ",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم قم بالالغاء",cancelButtonText:"تراجع  ",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then((t=>{t.isConfirmed&&(this.loader=!0,ut.Z.cancelException(e).then((()=>{this.loader=!1,_t.Z.toggleToast("تم الغاء الاعفاء","success"),this.$emit("update_exception")})).catch((e=>{console.log(e)})))}))},showMedia(e){return ht.Z.show(e)}})},wt=s(83744);const yt=(0,wt.Z)(gt,[["render",rt]]);var kt=yt,ft={name:"List Exceptions",created(){this.getException()},components:{listOne:kt},data(){return{exception:null,last_freez:null,last_exam:null,last_exceptional_freez:null,authInGroup:null,exception_id:this.$route.params.exception_id,weeks:null}},methods:{updateException(){this.getException()},async getException(){const e=await ut.Z.getExceptionById(this.exception_id);this.exception=e.user_exception,this.weeks=e.weeks,this.last_freez=e.last_freez,this.last_exam=e.last_exam,this.last_exceptional_freez=e.last_exceptional_freez,this.authInGroup=e.authInGroup}}};const bt=(0,wt.Z)(ft,[["render",i]]);var vt=bt}}]);
//# sourceMappingURL=7390.45f0df08.js.map