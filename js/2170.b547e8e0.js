"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[2170],{9847:function(t,e,a){var s=a(66252),r=a(24150);class o{async userMonthAchievement(t,e){try{const a=await r.hi.get(`marks/user-month-achievement/${t}/${e}`);return a.data.data}catch(a){(0,s.S3)(a)}}async userWeekAchievement(t,e){try{const a=await r.hi.get(`marks/user-week-achievement/${t}/${e}`);return a.data.data}catch(a){(0,s.S3)(a)}}async ambassadorMark(t,e){try{const a=await r.hi.get(`marks/ambassador-mark/${t}/${e}`);return a.data.data}catch(a){(0,s.S3)(a)}}async acceptSupport(t,e){try{const a=await r.hi.put(`marks/accept-support/user/${t}/${e}`);return a.data}catch(a){(0,s.S3)(a)}}async rejectSupport(t,e){try{const a=await r.hi.put(`marks/reject-support/user/${t}/${e}`);return a.data}catch(a){(0,s.S3)(a)}}async setSupportMarkForAll(t){try{const e=await r.hi.post("/marks/set-support-for-all",t,{headers:{"Content-type":"multipart/form-data"}});return e.data.data}catch(e){(0,s.S3)(e)}}async topUsersByMonth(){try{const t=await r.hi.get("marks/top-users-by-month");return t.data.data}catch(t){(0,s.S3)(t)}}async topUsersByWeek(){try{const t=await r.hi.get("marks/top-users-by-week");return t.data.data}catch(t){(0,s.S3)(t)}}}e.Z=new o},2985:function(t,e,a){var s=a(66252),r=a(79940),o=a(24150);class n{async create(t){try{const e=await o.hi.post("/userexception/create",t,{headers:{"Content-type":"multipart/form-data"}});return e.data.data}catch(e){(0,s.S3)(e)}}async setExceptionalFreez(t){try{const e=await o.hi.post("/userexception/set-exceptional-freez",t,{headers:{"Content-type":"multipart/form-data"}});return e.data.data}catch(e){(0,s.S3)(e)}}async setNewUser(t){try{const e=await o.hi.post("/userexception/set-new-user",t,{headers:{"Content-type":"multipart/form-data"}});return e.data.data}catch(e){(0,s.S3)(e)}}async getExceptionById(t){try{const e=await o.hi.get(`userexception/show/${t}`);return e.data.data}catch(e){(0,r.F)(e)}}async update(t,e){try{const a=await o.hi.patch(`userexception/${t}`,e,{headers:{"Content-type":"multipart/form-data"}});return a.data.data}catch(a){return a}}async updateStatus(t,e){try{const a=await o.hi.patch(`userexception/update-status/${t}`,{decision:e.decision,note:e.note,week_id:e.week_id});return a.data.data}catch(a){return a}}async updateExceptionTypeById(t,e){try{return await o.hi.post("/userexception/update",{id:t,type:e})}catch(a){return a}}async cancelException(t){try{return await o.hi.get(`userexception/cancel/${t}`)}catch(e){return e}}async getAllUserExceptions(t){try{const e=await o.hi.get(`userexception/user-exceptions/${t}`);return e.data.data}catch(e){return e}}async exceptionsFilter(t,e){try{const a=await o.hi.get(`userexception/exceptions-filter/${t}/${e}`);return a.data.data}catch(a){return a}}}e.Z=new n},79940:function(t,e,a){a.d(e,{F:function(){return r}});a(70560);var s=a(1120);function r(t,e=""){throw console.log(`[ERROR] ${e} =>`,t.response.data),404===t.response.data.statusCode?s.Z.push({name:"NotFound"}):403===t.response.data.statusCode&&s.Z.push({name:"NotAuthorized"}),t}},39356:function(t,e,a){a.d(e,{Z:function(){return I}});a(76265);var s=a(66252),r=a(49963),o=a(3577),n=a(79885);const i=t=>((0,s.dD)("data-v-c2455b6a"),t=t(),(0,s.Cn)(),t),c={class:"card-body"},l={class:"blog-description"},u={class:"form-group mt-3 mb-1"},d=i((()=>(0,s._)("h4",null,"السبب",-1))),p={class:"form-group row"},m={class:"mb-0"},h={key:0,class:"d-block text-start mt-1",style:{color:"red"}},w={class:"form-group"},k=["disabled"],g={class:"form-check mt-2 w-100 text-start"},y=["checked"],b=i((()=>(0,s._)("h4",{class:"form-check-label",for:"allow_submit_is_new"}," هذا العضو جديد وفي اسبوعه الأول أو الثاني ",-1))),_={class:"form-group"},x=["disabled"],v={key:0,class:"col-sm-12 text-center"},f=i((()=>(0,s._)("img",{src:n,alt:"loader",style:{height:"100px"}},null,-1))),$=[f],S={key:1,class:"text-center mt-3 mb-3"};function F(t,e,a,n,i,f){return(0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",l,[(0,s._)("button",{class:"btn mr-2 mt-1 w-75 btn-freez",onClick:e[0]||(e[0]=()=>{i.showExceptionForm=!i.showExceptionForm,i.showIsNewForm=!1})}," طلب تجميد استثنائي "),f.isnew&&t.mark.reading_mark+t.mark.writing_mark+t.mark.support<=50?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-success ms-2 mt-1 w-75",onClick:e[1]||(e[1]=()=>{i.showIsNewForm=!i.showIsNewForm,i.showExceptionForm=!1})}," تعيين عضو جديد ")):(0,s.kq)("",!0)]),(0,s.wy)((0,s._)("form",{onSubmit:e[3]||(e[3]=(0,r.iM)(((...t)=>f.submitException&&f.submitException(...t)),["prevent"])),class:"post-text ml-3 w-100 row"},[(0,s._)("div",u,[d,(0,s._)("div",p,[(0,s.wy)((0,s._)("textarea",{rows:"5",placeholder:"سبب التجميد الاستثنائي",class:"rounded form-control mt-2 col-12",id:"exceptionReason","onUpdate:modelValue":e[2]||(e[2]=t=>n.v$.exceptionForm.reason.$model=t),name:"reason"},"\r\n                        ",512),[[r.nr,n.v$.exceptionForm.reason.$model]]),(0,s._)("p",m,[(0,s._)("span",{class:(0,o.C_)({"text-danger":n.v$.exceptionForm.reason.$error})},(0,o.zw)(n.v$.exceptionForm.reason.$model.length),3),(0,s.Uk)(" /250 ")])]),n.v$.exceptionForm.reason.$error?((0,s.wg)(),(0,s.iD)("small",h," * قم بادخال سبب لا ينقص عن 10 حروف ولا يزيد عن 250 حرف ")):(0,s.kq)("",!0)]),(0,s._)("div",w,[(0,s._)("button",{type:"submit",disabled:i.message,class:"btn d-block btn-freez float-end mx-auto"}," تجميد ",8,k)])],544),[[r.F8,i.showExceptionForm]]),(0,s.wy)((0,s._)("form",{onSubmit:e[5]||(e[5]=(0,r.iM)(((...t)=>f.submitIsNew&&f.submitIsNew(...t)),["prevent"])),class:"mt-3 post-text ml-3 w-100 row"},[(0,s._)("div",g,[(0,s._)("input",{type:"checkbox",checked:i.allowSubmitIsNew,class:"form-check-input",id:"allow_submit_is_new",ref:"allow_submit_is_new",onClick:e[4]||(e[4]=t=>i.allowSubmitIsNew=!i.allowSubmitIsNew)},null,8,y),b]),(0,s._)("div",_,[(0,s._)("button",{type:"submit",disabled:!i.allowSubmitIsNew,class:"btn d-block btn-primary float-end mx-auto"}," اعتماد عضو جديد ",8,x)])],544),[[r.F8,i.showIsNewForm]]),i.loader?((0,s.wg)(),(0,s.iD)("div",v,$)):(0,s.kq)("",!0),i.message?((0,s.wg)(),(0,s.iD)("h4",S,(0,o.zw)(i.message),1)):(0,s.kq)("",!0)])}var C=a(2985),D=a(5705),N=a(10760),Z={name:"List Reading",setup(){return{v$:(0,D.ZP)()}},created(){this.exceptionForm.user_id=this.user.id,this.exceptionForm.week_id=this.$route.params.week_id},props:{user:{type:Object,required:!0}},data(){return{exceptionForm:{reason:"",user_id:0,week_id:0},showExceptionForm:!1,showIsNewForm:!1,allowSubmitIsNew:!1,loader:!1,message:null}},validations(){return{exceptionForm:{reason:{required:N.C1,minLength:(0,N.Ei)(10),maxLength:(0,N.BS)(250)}}}},methods:{async submitException(){if(this.v$.$touch(),!this.v$.exceptionForm.$invalid){this.message="",this.loader=!0;try{const t=await C.Z.setExceptionalFreez(this.exceptionForm);this.message=t,this.showExceptionForm=!1,this.v$.exceptionForm.$reset()}catch(t){console.log("[Exception request error]",t)}finally{this.loader=!1}}},async submitIsNew(){this.message="",this.loader=!0;try{this.exceptionForm.reason="عضو جديد";const t=await C.Z.setNewUser(this.exceptionForm);this.message=t,this.showIsNewForm=!1,this.v$.exceptionForm.$reset()}catch(t){console.log("[submit new user error]",t)}finally{this.loader=!1}}},computed:{isnew(){if(this.user){const t=new Date(this.user.created_at),e=new Date,a=new Date;return a.setDate(e.getDate()-14),a.setHours(0,0,0,0),t.setHours(0,0,0,0),t>=a&&t<=e}return!1}}},q=a(83744);const E=(0,q.Z)(Z,[["render",F],["__scopeId","data-v-c2455b6a"]]);var I=E},83616:function(t,e,a){a.r(e),a.d(e,{default:function(){return et}});var s=a(66252);const r={class:"col-sm-12 mt-3"},o={class:"iq-card-body p-3"},n={class:"d-flex align-items-center mt-3"},i={key:0,class:"col-12"},c={class:"card card-block card-stretch card-height blog"},l=(0,s._)("div",{class:"card-header"},[(0,s._)("h2",null,"اجراءات أخرى")],-1),u={class:"d-flex align-items-center mt-3 row"},d={class:"d-inline-block w-100 text-center col-12"},p=(0,s._)("span",null,"إنجازات الفريق",-1),m=(0,s._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1);function h(t,e,a,h,w,k){const g=(0,s.up)("count-down"),y=(0,s.up)("AchievementCard"),b=(0,s.up)("Check"),_=(0,s.up)("Support"),x=(0,s.up)("OtherActions"),v=(0,s.up)("router-link"),f=(0,s.up)("iq-card");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",r,[w.week?((0,s.wg)(),(0,s.j4)(g,{key:0,week:w.week,timer_type:"modify_timer"},null,8,["week"])):(0,s.kq)("",!0),w.mark?((0,s.wg)(),(0,s.j4)(f,{key:1,class:"iq-card"},{default:(0,s.w5)((()=>{var t;return[(0,s._)("div",o,[(0,s.Wm)(y,{mark:w.mark,group:w.group},null,8,["mark","group"]),(0,s._)("div",n,[(0,s.Wm)(b,{theses:w.theses},null,8,["theses"])]),(0,s.Wm)(_,{expired:w.expired,support:w.support,supportMark:null===(t=w.mark)||void 0===t?void 0:t.support,week:w.week,onUpdateSupportMark:k.updateSupportMark},null,8,["expired","support","supportMark","week","onUpdateSupportMark"]),w.expired?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",c,[l,(0,s.Wm)(x,{user:w.mark.user},null,8,["user"])])])),(0,s._)("div",u,[(0,s._)("div",d,[w.group&&w.week?((0,s.wg)(),(0,s.j4)(v,{key:0,to:{name:"group.ambassadors-reading",params:{group_id:w.group.id,week_id:w.week.id}},class:"d-block mt-3 mb-3 w-75 mx-auto"},{default:(0,s.w5)((()=>[p,m])),_:1},8,["to"])):(0,s.kq)("",!0)])])])]})),_:1})):(0,s.kq)("",!0)])])}a(278),a(70560);var w=a(74615),k=a(16319),g=a(9847),y=a(26667),b=(a(76265),a(3577));const _=t=>((0,s.dD)("data-v-13cc3ae1"),t=t(),(0,s.Cn)(),t),x={class:"col-12"},v={class:"card card-block card-stretch card-height blog"},f=_((()=>(0,s._)("div",{class:"card-header"},[(0,s._)("h2",null,"اعرف مشروعك")],-1))),$={class:"card-body"},S={class:"blog-description"},F={key:0,class:"table w-100"},C=_((()=>(0,s._)("thead",null,[(0,s._)("tr",{class:"text-center"},[(0,s._)("th",{scope:"col"},"التفاعل"),(0,s._)("th",{scope:"col"},"التصويت"),(0,s._)("th",{scope:"col"},"المنشور"),(0,s._)("th",{scope:"col"},"العلامة"),(0,s._)("th",{scope:"col"},"التحكم")])],-1))),D={class:"text-center"},N={key:0},Z=["src","alt"],q=_((()=>(0,s._)("span",{class:"material-symbols-outlined",style:{"font-size":"1rem"}}," link ",-1))),E=["rowspan"],I=_((()=>(0,s._)("span",{class:"text-danger-modified font-weight-600"},"لا يوجد دعم بعد",-1))),M=[I],z=["rowspan"],R=["src"],U=["disabled"],j=["disabled"],A=_((()=>(0,s._)("tr",null,[(0,s._)("th",{colspan:"4"},"التعليقات")],-1))),B={colspan:"4"},O={key:0,class:"rounded-pill badge bg-info px-2 ms-1"},W={key:0,class:"text-center"},L=_((()=>(0,s._)("td",{colspan:"3"},"لا يوجد تعليقات",-1))),T=[L],H={class:"text-danger-modified font-weight-600",style:{direction:"rtl !important"}};function V(t,e,r,o,n,i){var c;const l=(0,s.up)("font-awesome-icon"),u=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",x,[(0,s._)("div",v,[f,(0,s._)("div",$,[(0,s._)("div",S,[i.noSupportPost?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("table",F,[C,(0,s._)("tbody",null,[(0,s._)("tr",D,[(0,s._)("td",null,[i.noReaction?((0,s.wg)(),(0,s.iD)("span",N,"لا يوجد")):"like"===r.support.reaction.type?((0,s.wg)(),(0,s.j4)(l,{key:1,icon:["fas","thumbs-up"],size:"xl",class:"text-primary"})):((0,s.wg)(),(0,s.iD)("img",{key:2,src:r.support.reaction.media.path,alt:r.support.reaction.type,class:"reaction-img",height:"20",width:"20"},null,8,Z))]),(0,s._)("td",null,(0,b.zw)(i.noVote?"لا يوجد":r.support.vote.option),1),(0,s._)("td",null,[(0,s.Wm)(u,{to:{name:"osboha.post",params:{post_id:r.support.post_id,user_id:t.$route.params.ambassador_id}},class:"d-flex align-items-center justify-content-center"},{default:(0,s.w5)((()=>[q,(0,s.Uk)(" عرض ")])),_:1},8,["to"])]),(0,s._)("td",null,(0,b.zw)(r.supportMark),1),i.noReaction&&i.noVote&&i.noComments?((0,s.wg)(),(0,s.iD)("td",{key:0,rowspan:i.managementRowSpan,class:"align-middle"},M,8,E)):((0,s.wg)(),(0,s.iD)("td",{key:1,rowspan:i.managementRowSpan,class:"align-middle"},[n.loading?((0,s.wg)(),(0,s.iD)("img",{key:0,src:a(79885),alt:"loader",style:{height:"50px"}},null,8,R)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[0===r.supportMark?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-success",onClick:e[0]||(e[0]=(...t)=>i.handleSupport&&i.handleSupport(...t)),disabled:r.expired}," قبول ",8,U)):((0,s.wg)(),(0,s.iD)("button",{key:1,class:"btn btn-danger-modified",onClick:e[1]||(e[1]=t=>i.handleSupport(!1)),disabled:r.expired}," رفض ",8,j))],64))],8,z))]),A,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.support.comments,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",B,[(0,s.Uk)((0,b.zw)(t.body)+" ",1),t.comment_id>0?((0,s.wg)(),(0,s.iD)("span",O,"رد ")):(0,s.kq)("",!0)])])))),128)),i.noComments?((0,s.wg)(),(0,s.iD)("tr",W,T)):(0,s.kq)("",!0)])])),(0,s._)("p",H,(0,b.zw)(null===(c=r.support)||void 0===c?void 0:c.supportError),1)])])])])}var P=a(8209),Y={name:"Support",props:{support:{type:Object,required:!0},week:{type:Object,required:!0},supportMark:{type:Number,default:0},expired:{type:Boolean,required:!0}},emits:["updateSupportMark"],data(){return{ambassador_id:this.$route.params.ambassador_id,loading:!1}},created(){},computed:{noSupportPost(){var t;return null!==(null===(t=this.support)||void 0===t?void 0:t.supportError)},noReaction(){var t;return null===(null===(t=this.support)||void 0===t?void 0:t.reaction)},noVote(){var t;return null===(null===(t=this.support)||void 0===t?void 0:t.vote)},noComments(){var t;return 0===(null===(t=this.support)||void 0===t||null===(t=t.comments)||void 0===t?void 0:t.length)},managementRowSpan(){var t;return this.noComments?3:(null===(t=this.support)||void 0===t||null===(t=t.comments)||void 0===t?void 0:t.length)+2}},methods:{async handleSupport(t=!0){if(this.loading)return;const e=t?"سيتم قبول انجاز اعرف مشروعك وإضافة العلامة للسفير":"سيتم رفض انجاز اعرف مشروعك وخصم العلامة من السفير",a=this.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-danger btn-lg ms-2"},buttonsStyling:!1});a.fire({title:"هل أنت متأكد؟",text:e,icon:"warning",showCancelButton:!0,confirmButtonText:"نعم!",cancelButtonText:"تراجع",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then((async e=>{if(e.isConfirmed){this.loading=!0;try{let e;if(e=t?await g.Z.acceptSupport(this.ambassador_id,this.week.id):await g.Z.rejectSupport(this.ambassador_id,this.week.id),200===e.statusCode){const e=t?"قبول":"رفض";P.Z.toggleToast(`تم ${e} انجاز اعرف مشروعك بنجاح`,"success"),this.$emit("updateSupportMark",t?10:0)}}catch(a){console.log(a.response.data)}finally{this.loading=!1}}}))}}},K=a(83744);const G=(0,K.Z)(Y,[["render",V],["__scopeId","data-v-13cc3ae1"]]);var J=G,Q=a(39356),X={name:"List Reading",components:{Check:k.Z,AchievementCard:w.Z,CountDown:y.Z,Support:J,OtherActions:Q.Z},data(){return{theses:[],support:null,group:null,week:null,mark:null,loader:!1,message:null,date:null,now:null,expired:!0}},async created(){try{const t=await g.Z.ambassadorMark(this.$route.params.ambassador_id,this.$route.params.week_id);this.mark=t.mark,this.theses=t.theses.reduce(((t,e)=>{const a=t[e.book.name]||[];return a["title"]=e.book.name,a.push(e),t[e.book.name]=a,t}),{}),this.group=t.group,this.week=t.currentWeek,this.support=t.support;const e=(new Date).toLocaleString("en-US",{timeZone:"Asia/Riyadh"});this.now=new Date(e),this.date=new Date(this.week.modify_timer),this.expired=this.time<0}catch(t){const e=t.response.data;401===e.statusCode?this.$router.push({name:"NotAuthorized"}):404===e.statusCode?this.$router.push({name:"NotFound"}):P.Z.toggleToast("حدث خطأ ما","error")}},methods:{updateSupportMark(t){this.mark.support=t}},computed:{time(){return this.date-this.now}}};const tt=(0,K.Z)(X,[["render",h]]);var et=tt}}]);
//# sourceMappingURL=2170.b547e8e0.js.map