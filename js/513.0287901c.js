"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[513],{26045:function(e,t,s){var a=s(24150),i=s(66252);class n{async getThesisById(e){try{const t=await a.hi.get(`/theses/${e}`);return t.data.data}catch(t){(0,i.S3)(t)}}async getBookThesis(e,t){try{const s=await a.hi.get(`/theses/book/${e}/thesis/${t}`);return s.data}catch(s){(0,i.S3)(s)}}async getThesesByBookId(e,t,s=""){try{const i=await a.hi.get(`/theses/book/${e}/user/${s}?page=${t}`);return i.data}catch(n){(0,i.S3)(n)}}async getThesisByUser(e,t){try{const s=await a.hi.get(`/theses/user/${e}?page=${t}`);return s.data}catch(s){(0,i.S3)(s)}}async getThesisByWeek(e){try{const t=await a.hi.get(`/theses/week/${e}`);return t.data}catch(t){(0,i.S3)(t)}}}t.Z=new n},60513:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ce}});s(76265);var a=s(66252),i=s(49963),n=s(3577),l=s(55415);const r={class:"col-sm-12 mt-3 text-center"},o=(0,a._)("div",{class:"iq-card-header-toolbar d-flex align-items-center mx-auto"},[(0,a._)("h3",{class:"text-center mt-3 mb-3"},"تدقيق أطروحة")],-1),d={class:"iq-card-body p-3"},c=(0,a._)("div",{class:"image-block text-center"},[(0,a._)("img",{src:l,class:"img-fluid rounded w-50",alt:"blog-img"})],-1),h={key:0,class:"d-flex align-items-center mt-3"},u={class:"form-group row"},m={class:"col-4 form-group"},g=(0,a._)("label",{class:"form-label"},"صفحة البداية",-1),p={class:"form-control-plaintext"},w={class:"col-4 form-group"},_=(0,a._)("label",{class:"form-label"},"صفحة النهاية",-1),b={class:"form-control-plaintext"},y={class:"col-4 form-group"},f=(0,a._)("label",{class:"form-label"},"العدد الكلي ",-1),x={class:"form-control-plaintext"},v={class:"form-group row"},k={class:"col-12"},D={class:"form-control-plaintext"},$={class:"me-2"},C={key:0,class:"col-md-12 form-group"},S={style:{"white-space":"pre-wrap",direction:"rtl"},class:"form-control-plaintext"},z={class:"col-12 row justify-content-center"},B=["href"],T=["src"],q=(0,a._)("hr",null,null,-1),E={key:0,class:"form-group row w-75 m-auto"},U={class:"col-12 col-md-6"},j=(0,a._)("option",{class:"bg-white text-dark",value:"",selected:""}," الحالة ",-1),A=(0,a._)("option",{class:"bg-white text-dark",value:"accepted"}," مقبولة ",-1),Z=(0,a._)("option",{class:"bg-white text-dark",value:"rejected"}," خصم علامة الأطروحة كاملة ",-1),O=(0,a._)("option",{class:"bg-white text-dark",value:"one_thesis"}," حساب علامة أطروحة واحدة ",-1),I=[j,A,Z,O],M={class:"col-12 col-md-6"},R=["disabled"],W=(0,a._)("option",{class:"bg-white text-dark",value:"",selected:""}," السبب ",-1),F=["value"],L={key:0,class:"col-12 mt-2 text-center"},H=["src"],K={key:1,class:"col-12 mt-2"},N=["disabled"],P={key:2,class:"col-12"},V={class:"form-control-plaintext text-center",style:{color:"#ff0000"}},Y={key:1,class:"alert alert-danger d-flex align-items-center justify-content-center"},G={class:"me-2"},J={key:0},Q={key:1},X={key:2},ee={class:"d-flex align-items-center mt-3 row"},te={class:"d-inline-block w-100 text-center col-12"},se=(0,a._)("span",null,"انجاز القارىء",-1),ae=(0,a._)("span",{class:"align-middle material-symbols-outlined"}," keyboard_return ",-1),ie=[se,ae];function ne(e,t,l,j,A,Z){const O=(0,a.up)("ExpandedCard"),se=(0,a.up)("font-awesome-icon"),ae=(0,a.up)("iq-card");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(ae,{class:"iq-card"},{default:(0,a.w5)((()=>[o,(0,a._)("div",d,[c,A.thesis?((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,i.iM)(((...e)=>Z.submitAudit&&Z.submitAudit(...e)),["prevent"])),class:"post-text ml-3 w-100 row"},[(0,a._)("div",u,[(0,a._)("div",m,[g,(0,a._)("label",p,(0,n.zw)(A.thesis.start_page),1)]),(0,a._)("div",w,[_,(0,a._)("label",b,(0,n.zw)(A.thesis.end_page),1)]),(0,a._)("div",y,[f,(0,a._)("label",x,(0,n.zw)(Z.totalPages),1)]),(0,a._)("div",v,[(0,a._)("div",k,[(0,a._)("label",D,[(0,a._)("span",$,(0,n.zw)(Z.thesisType),1),(0,a._)("span",{class:(0,n.C_)(["rounded-pill px-2 py-1 text-white",Z.thesisStatus.className])},(0,n.zw)(Z.thesisStatus.status),3)])])]),A.thesis.comment.body?((0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("p",S,(0,n.zw)(A.thesis.comment.body),1)])):(0,a.kq)("",!0),Z.media.length>0?((0,a.wg)(),(0,a.j4)(O,{key:1,title:"الاقتباسات",defaultExpanding:Z.media.length<=3},{default:(0,a.w5)((()=>[(0,a._)("div",z,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Z.media,((t,s)=>((0,a.wg)(),(0,a.iD)("div",{class:"col-lg-3 col-md-6 col-sm-12 mb-2",key:s},[(0,a._)("a",{href:`${e.getAssetsUrl()}/${t.media}`,target:"_blank"},[(0,a._)("img",{class:"img-fluid rounded w-100 h-100",src:`${e.getAssetsUrl()}/${t.media}`,alt:"thesis screenshot",style:{"object-fit":"cover"}},null,8,T)],8,B)])))),128))])])),_:1},8,["defaultExpanding"])):(0,a.kq)("",!0)]),q,!A.expired&&Z.pending&&Z.authUserAllowed&&!Z.readOnly?((0,a.wg)(),(0,a.iD)("div",E,[(0,a._)("div",U,[(0,a.wy)((0,a._)("select",{class:"form-select w-100 mt-2","onUpdate:modelValue":t[0]||(t[0]=e=>A.status=e)},I,512),[[i.bM,A.status]])]),(0,a._)("div",M,[(0,a.wy)((0,a._)("select",{class:"form-select w-100 mt-2","onUpdate:modelValue":t[1]||(t[1]=e=>A.reason=e),disabled:"accepted"===A.status},[W,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.reasons,(e=>((0,a.wg)(),(0,a.iD)("option",{class:"bg-white text-dark",key:e.id,value:e.id},(0,n.zw)(e.reason),9,F)))),128))],8,R),[[i.bM,A.reason]])]),A.loader?((0,a.wg)(),(0,a.iD)("div",L,[(0,a._)("img",{src:s(79885),alt:"loader",style:{height:"50px"}},null,8,H)])):((0,a.wg)(),(0,a.iD)("div",K,[(0,a._)("button",{type:"submit",class:"btn btn-primary w-100",disabled:Z.message.length>0}," اعتماد ",8,N)])),Z.message?((0,a.wg)(),(0,a.iD)("div",P,[(0,a._)("p",V,(0,n.zw)(Z.message),1)])):(0,a.kq)("",!0)])):((0,a.wg)(),(0,a.iD)("div",Y,[(0,a._)("div",G,[(0,a.Wm)(se,{icon:["fas","circle-exclamation"],size:"lg"})]),A.expired?((0,a.wg)(),(0,a.iD)("div",J,"لقد انتهت فترة المراجعة")):Z.pending?Z.authUserAllowed?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",X,"غير مسموح لك بالمراجعة")):((0,a.wg)(),(0,a.iD)("div",Q,"لقد تمت المراجعة من قبل"))]))],32)])):(0,a.kq)("",!0),(0,a._)("div",ee,[(0,a._)("div",te,[(0,a._)("a",{role:"button",onClick:t[3]||(t[3]=t=>e.$router.go(-1)),class:"d-block mt-3 mb-3 w-75 mx-auto"},ie)])])])])),_:1})])}var le=s(43144),re=(s(70560),s(32320),s(26045)),oe=s(24150);class de{async getReasonsForLeader(){try{const e=await oe.hi.get("modification-reasons/leader");return e.data.data}catch(e){(0,a.S3)(e)}}}var ce=new de;class he{async create(e){const t=new FormData;null!==e.reason_id&&t.append("modifier_reason_id",e.reason_id),t.append("thesis_id",e.thesis_id),t.append("status",e.status),t.append("week_id",e.week_id);try{const e=await oe.hi.post("/modified-theses",t);return e.data}catch(s){(0,a.S3)(s)}}}var ue=new he,me=s(8209),ge=s(49579);const pe={class:"card"},we={class:"text-light mt-0 text-center",style:{direction:"rtl !important"}},_e={class:"d-flex justify-content-center"},be={key:0,class:"card-body row d-flex justify-content-center",style:{"box-shadow":"none"}};function ye(e,t,s,i,l,r){return(0,a.wg)(),(0,a.iD)("div",pe,[(0,a._)("div",{class:"card-header rounded-0 p-1",style:(0,n.j5)({backgroundColor:s.bgColor})},[(0,a._)("h5",we,[(0,a._)("div",_e,[(0,a._)("span",{role:"button",class:"material-symbols-outlined",onClick:t[0]||(t[0]=e=>l.expanding=!l.expanding)},(0,n.zw)(l.expanding?"expand_less":"expand_more"),1),(0,a.Uk)(" "+(0,n.zw)(s.title),1)])])],4),l.expanding?((0,a.wg)(),(0,a.iD)("div",be,[(0,a.WI)(e.$slots,"default")])):(0,a.kq)("",!0)])}var fe={name:"ExpandedCard",data(){return{expanding:!1}},props:{title:{type:String,required:!0},bgColor:{type:String,default:"#1d1a55"},defaultExpanding:{type:Boolean,default:!1}},created(){this.expanding=this.defaultExpanding}},xe=s(83744);const ve=(0,xe.Z)(fe,[["render",ye]]);var ke=ve,De={name:"List One Thesis",components:{ExpandedCard:ke},async created(){var e,t;const s=await re.Z.getThesisById(this.$route.params.thesis_id);this.reasons=await ce.getReasonsForLeader(),this.thesis=s,this.week=null===(e=s.mark)||void 0===e?void 0:e.week,this.expired=new Date(null===(t=this.week)||void 0===t?void 0:t.modify_timer)<new Date},data(){return{thesis:null,reasons:[],loader:!1,status:"",reason:"",week:null,expired:!1,expand:!1}},computed:{authUserAllowed(){return ge.Z.hasRoles(this.$store.getters.getUser,["leader","supervisor","advisor","admin","consultant"])},thesisStatus(){let e="",t="bg-primary";return"pending"===this.thesis.status||""===this.thesis.status||null===this.thesis.status?(e="بحاجة للمراجعة",t="bg-warning"):"accepted"===this.thesis.status?(e="مقبول",t="bg-success"):"rejected"===this.thesis.status?(e="مرفوض",t="bg-danger"):"one_thesis"===this.thesis.status&&(e="علامة أطروحة واحدة",t="bg-info"),{status:e,className:t}},pending(){return"pending"===this.thesis.status||null===this.thesis.status||""===this.thesis.status},readOnly(){return"accepted"===this.thesis.status&&0==this.thesis.max_length&&0==this.thesis.total_screenshots},message(){return"accepted"===this.status||this.reason?"":"لا يمكنك الاعتماد بدون اختيار السبب والحالة في حالة الرفض"},media(){let e=[];const t=s=>{s.forEach((s=>{var a;s.media&&"screenshot"===s.type&&e.push(s.media),(null===(a=s.replies)||void 0===a?void 0:a.length)>0&&t(s.replies)}))};var s;this.thesis&&(this.thesis.comment.media&&e.push(this.thesis.comment.media),(null===(s=this.thesis.comment.replies)||void 0===s?void 0:s.length)>0&&t(this.thesis.comment.replies));return e},thesisType(){let e="";return this.thesis.max_length>0&&this.thesis.max_length>400?e="شاملة":this.thesis.max_length>0&&this.thesis.max_length<400?e="غير شاملة":0==this.thesis.max_length&&this.thesis.total_screenshots>0?e="اقتباسات":0==this.thesis.max_length&&0==this.thesis.total_screenshots&&(e="قراءة فقط"),e},totalPages(){const e=this.thesis.end_page-this.thesis.start_page;return e>0?e+1:0}},methods:(0,le.Z)((0,le.Z)({},me.Z),{},{async submitAudit(){if(this.message.length>0)return;const e=this.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-danger btn-lg ms-2"},buttonsStyling:!1});e.fire({title:"هل أنت متأكد؟",text:"لن تتمكن من التراجع عن هذا الإجراء!",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم، قم بالإعتماد!",cancelButtonText:"تراجع",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then((async e=>{if(e.isConfirmed){this.loader=!0;try{const e=await ue.create({thesis_id:this.thesis.id,reason_id:this.reason?parseInt(this.reason):null,status:this.status,week_id:this.week.id});200===e.statusCode&&(this.handleSuccessSwal(e.data),setTimeout((()=>{this.$router.push({name:"group.listOneAmbassadorReading",params:{ambassador_id:this.thesis.comment.user.id,week_id:this.week.id}})}),1800))}catch(t){406===t.response.data.statusCode?this.handleErrorSwal(t.response.data.data):this.handleErrorSwal("حدث خطأ ما، حاول مرة أخرى"),console.log("[Modify thesis error]",t)}finally{this.loader=!1}}}))}})};const $e=(0,xe.Z)(De,[["render",ne]]);var Ce=$e},55415:function(e,t,s){e.exports=s.p+"img/update-forms.03f6433b.png"}}]);
//# sourceMappingURL=513.0287901c.js.map