"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[3813],{96444:function(e,t,n){var r=n(50124),i=n(48534),o=n(13087),s=n(62833),a=n(66252),l=n(24150),u=function(){function e(){(0,o.Z)(this,e)}return(0,s.Z)(e,[{key:"getAllFriends",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.get("friends/user/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFriendsRequests",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.get("/friends/un-accepted");case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"create",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.post("/friends/create",{friend_id:t});case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFriendshipById",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.post("/friends/show",{friendship_id:t});case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"accept",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.get("/friends/accept/".concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"acceptAll",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.get("/friends/accept-all");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"deleteAllUnAccepted",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.get("/friends/delete-all-unaccepted");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,a.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,o;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=new FormData,i.append("user_id",t),i.append("friend_id",n),e.prev=3,e.next=6,l.hi.post("/friends/delete",i);case 6:return o=e.sent,e.abrupt("return",o.data);case 10:e.prev=10,e.t0=e["catch"](3),(0,a.S3)(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));function t(t,n){return e.apply(this,arguments)}return t}()}]),e}();t.Z=new u},53186:function(e,t,n){n.d(t,{Z:function(){return m}});n(76801),n(43843);var r=n(66252),i={class:"preview-images"},o=["onClick"],s=(0,r._)("span",null," x ",-1),a=[s],l=["src"],u=["src"];function c(e,t,n,s,c,d){return(0,r.wg)(),(0,r.iD)("div",i,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(c.previewUrls,(function(e,t){return(0,r.wg)(),(0,r.iD)("div",{class:"image-container",key:e.url},[(0,r._)("div",{class:"delete-image",onClick:function(e){return d.removeMedia(t)}},a,8,o),e.type.includes("image")?((0,r.wg)(),(0,r.iD)("img",{key:0,src:e.url},null,8,l)):((0,r.wg)(),(0,r.iD)("video",{key:1,src:e.url,autoplay:""},null,8,u))])})),128))])}var d=n(89584),p=(n(60228),n(47522),n(70560),n(62506),{name:"ImagePreviewer",props:{media:{type:[Array,FileList],default:function(){return[]}}},emits:["remove-media"],data:function(){return{previewUrls:[]}},methods:{previewMedia:function(){var e=this;this.previewUrls=[];var t=(0,d.Z)(this.media);t.forEach((function(t){var n=new FileReader;n.onload=function(){e.previewUrls.push({url:n.result,type:t.type})},n.readAsDataURL(t)}))},removeMedia:function(e){this.previewUrls.splice(e,1),this.$emit("remove-media",e)},clearMedia:function(){this.previewUrls=[]}},mounted:function(){this.previewMedia()},watch:{media:function(){this.previewMedia()}}}),f=n(83744);const h=(0,f.Z)(p,[["render",c]]);var m=h},44907:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(66252),i=n(3577),o={ref:"listContainer"},s={key:0,class:"d-flex align-items-center justify-content-center"},a={class:"me-2"},l={key:1,class:"col-sm-12 text-center"},u=["src"];function c(e,t,c,d,p,f){var h=(0,r.up)("font-awesome-icon"),m=(0,r.up)("Post");return(0,r.wg)(),(0,r.iD)("div",o,[p.emptyMessage&&c.displayEmpty?((0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",a,[(0,r.Wm)(h,{icon:["fas","circle-exclamation"],size:"xl"})]),(0,r._)("div",null,(0,i.zw)(p.emptyMessage),1)])):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(p.announcements,(function(e){return(0,r.wg)(),(0,r.j4)(m,{key:e.id,post:e,showPin:c.showPin},null,8,["post","showPin"])})),128)),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(p.posts,(function(e){return(0,r.wg)(),(0,r.j4)(m,{key:e.id,post:e,showPin:c.showPin},null,8,["post","showPin"])})),128)),p.loading?((0,r.wg)(),(0,r.iD)("div",l,[(0,r._)("img",{src:n(79885),alt:"loader",style:{height:"100px"}},null,8,u)])):(0,r.kq)("",!0)],512)}var d=n(89584),p=n(50124),f=n(48534),h=(n(79288),n(34338),n(25728),n(60228),n(91719),n(38077),n(62506),n(97195),n(20867)),m=n(8417),v=(n(49579),n(31025)),g=n(9669),w=n.n(g),y={name:"LazyLoadedPosts",components:{Post:h.Z},props:{timeline_id:{type:Number,default:null},isMain:{type:Boolean,default:!1},type:{type:String,default:null},showPin:{type:Boolean,default:!1},displayEmpty:{type:Boolean,default:!1}},provide:function(){return{incrementCommentsCount:this.incrementCommentsCount,decrementCommentsCount:this.decrementCommentsCount,postDelete:this.deletePost,voteOnPost:this.voteOnPost,closePostComments:this.closePostComments,pinPost:this.pinPost,reactToPost:this.reactToPost,cancelToken:this.cancelToken}},emits:{},data:function(){return{posts:[],announcements:[],page:1,totalPages:1,loading:!1,pendingRequest:!1,hasMore:!0,emptyMessage:"",cancelToken:w().CancelToken.source()}},computed:{hasMoreToLoad:function(){return this.page<=this.totalPages&&this.hasMore}},created:function(){return(0,f.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},mounted:function(){var e=this;return(0,f.Z)((0,p.Z)().mark((function t(){return(0,p.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loadPosts(),window.addEventListener("scroll",e.handleScroll);case 2:case"end":return t.stop()}}),t)})))()},beforeUnmount:function(){window.removeEventListener("scroll",this.handleScroll),this.cancelToken.cancel()},methods:{loadPosts:function(){var e=this;return(0,f.Z)((0,p.Z)().mark((function t(){var n,r,i,o,s;return(0,p.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.pendingRequest){t.next=2;break}return t.abrupt("return");case 2:if(e.pendingRequest=!0,e.loading=!0,t.prev=4,!e.isMain){t.next=11;break}return t.next=8,m.Z.getPostsForMainPage(e.page,e.cancelToken);case 8:i=t.sent,t.next=26;break;case 11:if("announcement"!==e.type){t.next=17;break}return t.next=14,m.Z.getAnnouncements(e.page);case 14:i=t.sent,t.next=26;break;case 17:if("support"!==e.type){t.next=23;break}return t.next=20,m.Z.getSupportPosts(e.page);case 20:i=t.sent,t.next=26;break;case 23:return t.next=25,m.Z.postsByTimelineId(e.timeline_id,e.page);case 25:i=t.sent;case 26:if(200===i.statusCode){t.next=29;break}return v.Z.toggleToast("حدث خطأ أثناء تحميل المنشورات, حاول مرة أخرى","error"),t.abrupt("return");case 29:if(200!==i.statusCode||i.data){t.next=33;break}return e.emptyMessage="لا يوجد منشورات",e.hasMore=!1,t.abrupt("return");case 33:e.isMain&&1===e.page&&(e.announcements=null!==(o=null===(s=i.data)||void 0===s?void 0:s.announcements)&&void 0!==o?o:[]),e.posts=[].concat((0,d.Z)(e.posts),(0,d.Z)(i.data.posts)),e.totalPages=null!==(n=null===(r=i.data)||void 0===r?void 0:r.last_page)&&void 0!==n?n:1,e.page++,t.next=42;break;case 39:t.prev=39,t.t0=t["catch"](4),400!==t.t0.response.status&&401!==t.t0.response.status&&401!==t.t0.response.status&&v.Z.toggleToast("حدث خطأ أثناء تحميل المنشورات, حاول مرة أخرى","error");case 42:return t.prev=42,e.loading=!1,e.pendingRequest=!1,t.finish(42);case 46:case"end":return t.stop()}}),t,null,[[4,39,42,46]])})))()},isAtBottomOfPage:function(){var e=this.$refs.listContainer.getBoundingClientRect(),t=e.bottom,n=window.innerHeight;return t<=n},handleScroll:function(){this.hasMoreToLoad&&this.isAtBottomOfPage()&&this.loadPosts()},incrementCommentsCount:function(e){var t;t=this.posts.find((function(t){return t.id==e})),t||(t=this.announcements.find((function(t){return t.id==e}))),t.comments_count++},decrementCommentsCount:function(e){var t;t=this.posts.find((function(t){return t.id==e})),t||(t=this.announcements.find((function(t){return t.id==e}))),t.comments_count--},addNewPost:function(e){this.posts.unshift(e)},deletePost:function(e){this.posts=this.posts.filter((function(t){return t.id!=e})),this.announcements=this.announcements.filter((function(t){return t.id!=e}))},voteOnPost:function(e){var t,n=e.option_id,r=e.post_id,i=e.old_option_id,o=e.status;t=this.posts.find((function(e){return e.id==r})),t||(t=this.announcements.find((function(e){return e.id==r})));var s=t.pollOptions.find((function(e){return e.id===n})),a=t.pollOptions.find((function(e){return e.id===i}));"created"===o?t.votes_count++:"updated"===o&&(a.votes_count--,a.selected_by_user=!1),s.votes_count++,s.selected_by_user=!0},closePostComments:function(e){var t=this.posts.find((function(t){return t.id===e}));t.allow_comments=!t.allow_comments},pinPost:function(e,t){var n;if(t){n=this.posts.find((function(t){return t.id===e}));var r=this.posts[0];r.is_pinned&&this.posts.splice(this.posts.indexOf(r),1),r=this.posts.find((function(e){return e.is_pinned})),r&&(r.is_pinned=!1),this.posts.unshift(n)}else n=this.posts.find((function(t){return t.id===e&&t.is_pinned})),this.posts.splice(this.posts.indexOf(n),1);n.is_pinned=t},reactToPost:function(e,t){var n;n=this.posts.find((function(t){return t.id==e})),n||(n=this.announcements.find((function(t){return t.id==e}))),t?(n.reactions_count++,n.reacted_by_user=!0):(n.reactions_count--,n.reacted_by_user=!1)}}},b=n(83744);const _=(0,b.Z)(y,[["render",c]]);var k=_},91627:function(e,t,n){n.d(t,{Z:function(){return xe}});var r=n(66252),i=n(49963),o=n(3577),s=function(e){return(0,r.dD)("data-v-0a8a958d"),e=e(),(0,r.Cn)(),e},a=s((function(){return(0,r._)("h4",{class:"card-title"},"منشور جديد",-1)})),l={class:"d-flex align-items-center"},u={class:"post-text ml-3 w-100"},c=s((function(){return(0,r._)("h5",{class:"modal-title",id:"modalsLabel"},"منشور جديد",-1)})),d=s((function(){return(0,r._)("span",{class:"material-symbols-outlined"},"close",-1)})),p=[d],f={class:"d-flex align-items-start"},h={class:"post-text ml-3 w-100"},m=s((function(){return(0,r._)("hr",null,null,-1)})),v={class:"post-opt-block d-flex list-inline m-0 p-0 flex-wrap"},g={class:"me-2 mb-2"},w=s((function(){return(0,r._)("span",{class:"material-symbols-outlined me-2"},"photo_camera",-1)})),y={class:"me-2 mb-2"},b=s((function(){return(0,r._)("span",{class:"material-symbols-outlined me-2"},"person_add",-1)})),_={class:"me-2 mb-2"},k=s((function(){return(0,r._)("span",{class:"material-symbols-outlined me-2"},"poll",-1)})),x=s((function(){return(0,r._)("hr",null,null,-1)})),P={key:0,class:"w-100 text-right",style:{color:"red"}},Z={key:1,class:"w-100 text-center py-1",style:{color:"red"}},C={key:2,class:"col-sm-12 text-center"},M=["src"],O=["disabled"],F=s((function(){return(0,r._)("h5",{class:"modal-title",id:"friendsModalLabel"},"إشارة إلى صديق",-1)})),T=s((function(){return(0,r._)("span",{class:"material-symbols-outlined"}," arrow_back_ios_new ",-1)})),D=[T],A={class:"iq-search-bar device-search w-main my-2 d-flex"},L={action:"#",class:"searchbox",style:{width:"100% !important"}},R=s((function(){return(0,r._)("a",{class:"search-link",href:"#"},[(0,r._)("span",{class:"material-symbols-outlined"},"search")],-1)})),S=s((function(){return(0,r._)("hr",null,null,-1)}));function q(e,t,s,d,T,q){var $=(0,r.up)("BaseAvatar"),U=(0,r.up)("iq-card"),I=(0,r.up)("model-header"),W=(0,r.up)("PostUser"),B=(0,r.up)("PostPoll"),E=(0,r.up)("ImagePreviewer"),H=(0,r.up)("model-body"),j=(0,r.up)("model-footer"),Y=(0,r.up)("modal"),K=(0,r.up)("FriendsList");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(U,{id:"post-modal-data","body-class":"iq-card iq-card-block iq-card-stretch iq-card-height"},{headerTitle:(0,r.w5)((function(){return[a]})),body:(0,r.w5)((function(){var e,n,o,s;return[(0,r._)("div",l,[(0,r.Wm)($,{profileImg:null===(e=q.auth)||void 0===e||null===(e=e.user_profile)||void 0===e?void 0:e.profile_picture,profile_id:null===(n=q.auth)||void 0===n||null===(n=n.user_profile)||void 0===n?void 0:n.id,title:null===(o=q.auth)||void 0===o?void 0:o.name,gender:null===(s=q.auth)||void 0===s?void 0:s.gender,avatarClass:"avatar-60 rounded-circle"},null,8,["profileImg","profile_id","title","gender"]),(0,r._)("form",u,[(0,r._)("input",{type:"text",placeholder:"ماذا تريد أن تكتب...",class:"rounded form-control",style:{border:"none"},onClick:t[0]||(t[0]=(0,i.iM)((function(e){return q.showModal(T.postModal)}),["prevent"]))})])])]})),_:1}),(0,r.Wm)(Y,{ref:"postModalRef",id:"postModal",dialogClass:"modal-lg modal-dialog-centered modal-dialog-scrollable",tabindex:"-1",title:"Create Post","aria-labelledby":"modalsLabel","aria-hidden":!0},{default:(0,r.w5)((function(){return[(0,r.Wm)(I,null,{default:(0,r.w5)((function(){return[c,(0,r._)("a",{href:"#",class:"lh-1",onClick:t[1]||(t[1]=(0,i.iM)((function(e){return q.hideModal(T.postModal)}),["prevent"]))},p)]})),_:1}),(0,r.Wm)(H,{class:"post-modal-body"},{default:(0,r.w5)((function(){return[(0,r._)("div",f,[(0,r.Wm)(W,{post:{user:q.auth,taggedFriends:T.selectedFriends}},null,8,["post"])]),(0,r._)("div",null,[(0,r._)("form",h,[(0,r.wy)((0,r._)("textarea",{id:"editor",placeholder:"ماذا تريد أن تكتب...",class:"rounded form-control",style:{border:"none",direction:"rtl"},"onUpdate:modelValue":t[2]||(t[2]=function(e){return T.post.body=e}),ref:"bodyRef"},"\n            ",512),[[i.nr,T.post.body,void 0,{trim:!0}]]),(0,r._)("input",{type:"file",onChange:t[3]||(t[3]=function(e){return q.previewMedia(e)}),multiple:"",accept:"image/*",class:"d-none",ref:"fileRef"},null,544)])]),(0,r.Wm)(B,{showPoll:T.showPoll,pollOptions:T.pollOptions,onClosePoll:t[4]||(t[4]=function(e){return T.showPoll=!1}),onAddPollOption:q.addPollOption,onRemovePollOption:q.removePollOption,onCheckSimilarPollOptions:q.checkSimilarPollOptions},null,8,["showPoll","pollOptions","onAddPollOption","onRemovePollOption","onCheckSimilarPollOptions"]),m,(0,r._)("ul",v,[(0,r._)("li",g,[(0,r._)("button",{class:"btn btn-soft-primary d-flex align-items-center",onClick:t[5]||(t[5]=function(){return q.openFilePicker&&q.openFilePicker.apply(q,arguments)})},[w,(0,r.Uk)(" صورة/فيديو ")])]),(0,r._)("li",y,[(0,r._)("button",{class:"btn btn-soft-primary d-flex align-items-center",onClick:t[6]||(t[6]=(0,i.iM)((function(e){return q.showModal(T.friendsListModal)}),["prevent"]))},[b,(0,r.Uk)(" إشارة إلى صديق ")])]),(0,r._)("li",_,[(0,r._)("button",{class:"btn btn-soft-primary d-flex align-items-center",onClick:t[7]||(t[7]=(0,i.iM)((function(){return q.openPoll&&q.openPoll.apply(q,arguments)}),["prevent"]))},[k,(0,r.Uk)(" إضافة استعلام ")])])]),T.post.media.length>0?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[x,(0,r.Wm)(E,{media:T.post.media,onRemoveMedia:q.removeMedia},null,8,["media","onRemoveMedia"])],64)):(0,r.kq)("",!0)]})),_:1}),(0,r.Wm)(j,{class:"p-0 px-2"},{default:(0,r.w5)((function(){return[T.showPoll?((0,r.wg)(),(0,r.iD)("div",P," ملاحظة: نص المنشور مطلوب مع الاستعلام, والخيارات لا يمكن أن تكون أقل من 2 ولا تزيد عن 10 ")):(0,r.kq)("",!0),T.errorMessage?((0,r.wg)(),(0,r.iD)("div",Z,(0,o.zw)(T.errorMessage),1)):(0,r.kq)("",!0),T.loader?((0,r.wg)(),(0,r.iD)("div",C,[(0,r._)("img",{src:n(79885),alt:"loader",style:{height:"100px"}},null,8,M)])):((0,r.wg)(),(0,r.iD)("button",{key:3,class:"btn btn-primary btn-block my-3 w-100 flex-grow-1",onClick:t[8]||(t[8]=function(e){return q.addNewPost()}),disabled:!q.allowPosting}," نشـــر ",8,O))]})),_:1})]})),_:1},512),(0,r.Wm)(Y,{ref:"friendsListModalRef",id:"friendsListModal",tabindex:"-1","aria-labelledby":"friendsModalLabel","aria-hidden":!0,dialogClass:"modal-lg modal-dialog-centered"},{default:(0,r.w5)((function(){return[(0,r.Wm)(I,null,{default:(0,r.w5)((function(){return[F,(0,r._)("a",{href:"#",class:"lh-1",onClick:t[9]||(t[9]=(0,i.iM)((function(e){return q.hideModal(T.friendsListModal)}),["prevent"]))},D)]})),_:1}),(0,r.Wm)(H,null,{default:(0,r.w5)((function(){return[(0,r._)("div",A,[(0,r._)("form",L,[R,(0,r.wy)((0,r._)("input",{type:"text",class:"text search-input form-control bg-soft-primary",placeholder:"ابحث هنا...","onUpdate:modelValue":t[10]||(t[10]=function(e){return T.searchQuery=e}),onKeyup:t[11]||(t[11]=function(){return q.searchFriends&&q.searchFriends.apply(q,arguments)})},null,544),[[i.nr,T.searchQuery,void 0,{trim:!0}]])]),(0,r._)("a",{href:"#",class:"btn btn-primary ms-2",onClick:t[12]||(t[12]=(0,i.iM)((function(e){return q.hideModal(T.friendsListModal)}),["prevent"]))}," اعتماد ")]),S,(0,r.Wm)(K,{friends:T.friends,handleCheckboxChange:q.handleCheckboxChange},null,8,["friends","handleCheckboxChange"])]})),_:1})]})),_:1},512)])}var $=n(95082),U=n(89584),I=n(50124),W=n(48534),B=(n(79288),n(62506),n(25728),n(60228),n(32320),n(70560),n(38077),n(97195),n(76801),n(43843),n(50886),n(47522),n(53186)),E=function(e){return(0,r.dD)("data-v-09c8084c"),e=e(),(0,r.Cn)(),e},H={key:0,class:"card my-3 border-1 rounded poll"},j={class:"card-header d-flex justify-content-between align-items-center"},Y=E((function(){return(0,r._)("h5",{class:"mb-0 text-primary"},"إضافة استعلام",-1)})),K={class:"card-body"},Q=["onUpdate:modelValue","placeholder","onChange"],z=["onClick"],N=["disabled"],V=E((function(){return(0,r._)("span",{class:"material-symbols-outlined"},"add",-1)})),G=E((function(){return(0,r._)("span",null,"إضافة خيار",-1)})),J=[V,G];function X(e,t,n,o,s,a){return n.showPoll?((0,r.wg)(),(0,r.iD)("div",H,[(0,r._)("div",j,[Y,(0,r._)("i",{class:"material-symbols-outlined",role:"button",onClick:t[0]||(t[0]=(0,i.iM)((function(t){return e.$emit("closePoll")}),["prevent"]))},"close")]),(0,r._)("div",K,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.pollOptions,(function(t,n){return(0,r.wg)(),(0,r.iD)("div",{class:"d-flex align-items-center my-2",key:t.id},[(0,r.wy)((0,r._)("input",{type:"text",class:"form-control rounded","onUpdate:modelValue":function(e){return t.value=e},placeholder:"خيار ".concat(n+1),onChange:function(n){return e.$emit("checkSimilarPollOptions",t.id)}},null,40,Q),[[i.nr,t.value]]),(0,r._)("i",{class:"material-symbols-outlined ms-2",role:"button",onClick:(0,i.iM)((function(n){return e.$emit("removePollOption",t.id)}),["prevent"])},"close",8,z)])})),128)),(0,r._)("button",{class:"btn btn-secondary d-block w-100 mt-3 d-flex justify-content-center align-items-center",onClick:t[1]||(t[1]=(0,i.iM)((function(t){return e.$emit("addPollOption")}),["prevent"])),disabled:!a.allowAddingPollOption},J,8,N)])])):(0,r.kq)("",!0)}var ee={name:"PostPoll",props:{showPoll:{type:Boolean,default:!1},pollOptions:{type:Array,default:function(){return[]}}},computed:{allowAddingPollOption:function(){var e=!0;return this.pollOptions.forEach((function(t){""===t.value&&(e=!1)})),e}}},te=n(83744);const ne=(0,te.Z)(ee,[["render",X],["__scopeId","data-v-09c8084c"]]);var re=ne,ie={key:0,class:"text-center text-primary"},oe={key:1,class:"p-3 friends-list"},se={class:"d-flex align-items-center flex-grow-1"},ae={class:"user-img"},le=["src"],ue={class:"user-info ms-3 flex-grow-1"},ce={class:"mb-0"},de=["id","name"];function pe(e,t,i,s,a,l){return(0,r.wg)(),(0,r.iD)(r.HY,null,[i.friends.length?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",ie," لا يوجد أصدقاء لعرضهم ")),i.friends.length?((0,r.wg)(),(0,r.iD)("div",oe,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.friends,(function(e){var s;return(0,r.wg)(),(0,r.iD)("div",{key:e.id,class:"d-flex pb-3 align-items-center"},[(0,r._)("div",se,[(0,r._)("div",ae,[(0,r._)("img",{class:"avatar-40 rounded-circle",src:null!==(s=e.profile.profile_picture)&&void 0!==s?s:n(23062)},null,8,le)]),(0,r._)("div",ue,[(0,r._)("h6",ce,(0,o.zw)(e.name),1)])]),(0,r._)("input",{id:e.id,class:"form-check-input",type:"checkbox",name:e.name,onChange:t[0]||(t[0]=function(){return i.handleCheckboxChange&&i.handleCheckboxChange.apply(i,arguments)}),style:{width:"1.5em !important",height:"1.5em !important"}},null,40,de)])})),128))])):(0,r.kq)("",!0)],64)}var fe={name:"FriendsList",props:{friends:{type:Array,default:function(){return[]}},handleCheckboxChange:{type:Function,required:!0}}};const he=(0,te.Z)(fe,[["render",pe],["__scopeId","data-v-6dfed0e0"]]);var me=he,ve=n(19947),ge=n(79909),we=n(8417),ye=n(96444),be=n(31025),_e={name:"AddPost",components:{ImagePreviewer:B.Z,PostPoll:re,FriendsList:me,PostUser:ve.Z},props:{type:{type:String,default:"normal"},timeline_id:{type:Number,required:!0}},emits:["add-post"],data:function(){return{postModal:null,friendsListModal:null,friends:[],friendsTemp:[],selectedFriends:[],pollOptions:[],post:{body:"",media:[],tags:[],votes:[]},showPoll:!1,minmaxOptions:{min:2,max:10},loader:!1,errorMessage:"",searchQuery:""}},computed:{auth:function(){return this.$store.getters.getUser},allowPosting:function(){var e=!0;return""===this.post.body&&0===this.post.media.length&&(e=!1),""===this.post.body&&this.pollOptions.length>0&&(e=!1),this.pollOptions.length>0&&this.pollOptions.length<this.minmaxOptions.min&&(e=!1),e},postBody:function(){return this.post.body},profile_picture:function(){var e,t=n(29822),r=n(48934),i=null===(e=this.auth)||void 0===e?void 0:e.gender.toLowerCase();return"female"===i?t:r}},watch:{postBody:function(){var e=this;this.$refs.bodyRef.style.height="auto",this.$nextTick((function(){e.$refs.bodyRef.style.height=e.$refs.bodyRef.scrollHeight+"px"}))}},created:function(){return(0,W.Z)((0,I.Z)().mark((function e(){return(0,I.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},mounted:function(){var e=this;return(0,W.Z)((0,I.Z)().mark((function t(){return(0,I.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.postModal=new ge.u_(e.$refs.postModalRef.$el),e.friendsListModal=new ge.u_(e.$refs.friendsListModalRef.$el);case 2:case"end":return t.stop()}}),t)})))()},methods:{onChange:function(e){this.post.body=e,console.log(e)},openFilePicker:function(){this.$refs.fileRef.click()},previewMedia:function(e){var t=(0,U.Z)(e.target.files);this.post.media=t},removeMedia:function(e){var t=(0,U.Z)(this.post.media);t.splice(e,1),this.post.media=t,0===this.post.media.length&&(this.$refs.fileRef.value=null)},showModal:function(e){e===this.postModal&&this.getFriends(),e.show()},hideModal:function(e){e.hide()},getFriends:function(){var e=this;return(0,W.Z)((0,I.Z)().mark((function t(){var n;return(0,I.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ye.Z.getAllFriends(e.auth.id);case 3:n=t.sent,null!==n?(e.friends=n.allFriends,e.friendsTemp=n.allFriends):e.friends=[],t.next=12;break;case 7:return t.prev=7,t.t0=t["catch"](0),e.friends=[],e.friendsTemp=[],t.abrupt("return");case 12:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleCheckboxChange:function(e){var t=e.target,n=t.checked,r=t.id,i=this.friends.find((function(e){return e.id===parseInt(r)}));n?(this.post.tags.push(parseInt(r)),this.selectedFriends.push({id:this.selectedFriends.length+1,user:i})):(this.post.tags=this.post.tags.filter((function(e){return e!==parseInt(r)})),this.selectedFriends=this.selectedFriends.filter((function(e){return e.id!==parseInt(r)})))},openPoll:function(){this.showPoll=!0,this.addPollOption()},addPollOption:function(){this.pollOptions.length>=this.minmaxOptions.max||this.pollOptions.push({id:this.pollOptions.length+1,value:""})},checkSimilarPollOptions:function(e){var t=this.pollOptions.find((function(t){return t.id===e})),n=this.pollOptions.find((function(n){return n.value===t.value&&n.id!==e}));n&&(t.value="")},removePollOption:function(e){var t=this.pollOptions.find((function(t){return t.id===e})),n=this.pollOptions.indexOf(t);this.pollOptions.splice(n,1)},searchFriends:function(){var e=this;""!==this.searchQuery?this.friends=this.friendsTemp.filter((function(t){return t.name.toLowerCase().includes(e.searchQuery.toLowerCase())})):this.friends=this.friendsTemp},addNewPost:function(){var e=this;return(0,W.Z)((0,I.Z)().mark((function t(){var n,r,i;return(0,I.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.pollOptions.filter((function(e){return""!==e.value})),r=(0,$.Z)((0,$.Z)({},e.post),{},{votes:n.map((function(e){return e.value})),timeline_id:e.timeline_id,type:e.type}),e.loader=!0,t.prev=3,t.next=6,we.Z.create(r);case 6:if(i=t.sent,200===i.statusCode){t.next=10;break}return be.Z.toggleToast("حدث خطأ ما, حاول مرة أخرى","error"),t.abrupt("return");case 10:null!==i.data.is_approved&&e.$emit("add-post",i.data),e.resetPostForm(),e.postModal.hide(),be.Z.toggleToast(i.message?i.message:"تم النشر بنجاح","success"),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](3),console.log("[AddPost error]",t.t0),be.Z.toggleToast("حدث خطأ ما, حاول مرة أخرى","error");case 20:return t.prev=20,e.loader=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[3,16,20,23]])})))()},resetPostForm:function(){this.post={body:"",media:[],tags:[],votes:[]},this.pollOptions=[],this.showPoll=!1,this.selectedFriends=[],this.searchQuery="",this.friends=this.friendsTemp,this.$nextTick((function(){var e=document.querySelectorAll(".friends-list input[type=checkbox]");e.forEach((function(e){e.checked=!1}))})),this.$refs.fileRef.value=null}}};const ke=(0,te.Z)(_e,[["render",q],["__scopeId","data-v-0a8a958d"]]);var xe=ke},27413:function(e,t,n){var r=n(44201),i=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(r){}}return!1}},42124:function(e,t,n){var r=n(91245),i=TypeError;e.exports=function(e){if(r(e))throw new i("The method doesn't accept regular expressions");return e}},76801:function(e,t,n){var r=n(79989),i=n(84328).includes,o=n(3689),s=n(87370),a=o((function(){return!Array(1).includes()}));r({target:"Array",proto:!0,forced:a},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("includes")},97195:function(e,t,n){var r=n(79989),i=n(46576),o=n(84328).indexOf,s=n(16834),a=i([].indexOf),l=!!a&&1/a([1],1,-0)<0,u=l||!s("indexOf");r({target:"Array",proto:!0,forced:u},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return l?a(this,e,t)||0:o(this,e,t)}})},91719:function(e,t,n){var r=n(79989),i=n(90690),o=n(6310),s=n(5649),a=n(98494),l=n(55565),u=1!==[].unshift(0),c=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},d=u||!c();r({target:"Array",proto:!0,arity:1,forced:d},{unshift:function(e){var t=i(this),n=o(t),r=arguments.length;if(r){l(n+r);var u=n;while(u--){var c=u+r;u in t?t[c]=t[u]:a(t,c)}for(var d=0;d<r;d++)t[d]=arguments[d]}return s(t,n+r)}})},43843:function(e,t,n){var r=n(79989),i=n(68844),o=n(42124),s=n(74684),a=n(34327),l=n(27413),u=i("".indexOf);r({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~u(a(s(this)),a(o(e)),arguments.length>1?arguments[1]:void 0)}})},89584:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(49227);function i(e){if(Array.isArray(e))return(0,r.Z)(e)}n(59749),n(86544),n(60228),n(84254),n(21694),n(76265),n(77049);function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n(12780);n(21057);function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return i(e)||o(e)||(0,s.Z)(e)||a()}}}]);
//# sourceMappingURL=3813-legacy.7777ddc6.js.map