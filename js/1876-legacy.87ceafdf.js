(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[1876],{20425:function(e){!function(t,n){e.exports=n()}(0,(function(){var e="__v-click-outside",t="undefined"!=typeof window,n="undefined"!=typeof navigator,r=t&&("ontouchstart"in window||n&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],o=function(e){var t=e.event,n=e.handler;(0,e.middleware)(t)&&n(t)},a=function(t,n){var a=function(e){var t="function"==typeof e;if(!t&&"object"!=typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||function(e){return e},events:e.events||r,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}}(n.value),i=a.handler,s=a.middleware,c=a.detectIframe,u=a.capture;if(a.isActive){if(t[e]=a.events.map((function(e){return{event:e,srcTarget:document.documentElement,handler:function(e){return function(e){var t=e.el,n=e.event,r=e.handler,a=e.middleware,i=n.path||n.composedPath&&n.composedPath();(i?i.indexOf(t)<0:!t.contains(n.target))&&o({event:n,handler:r,middleware:a})}({el:t,event:e,handler:i,middleware:s})},capture:u}})),c){var l={event:"blur",srcTarget:window,handler:function(e){return function(e){var t=e.el,n=e.event,r=e.handler,a=e.middleware;setTimeout((function(){var e=document.activeElement;e&&"IFRAME"===e.tagName&&!t.contains(e)&&o({event:n,handler:r,middleware:a})}),0)}({el:t,event:e,handler:i,middleware:s})},capture:u};t[e]=[].concat(t[e],[l])}t[e].forEach((function(n){var r=n.event,o=n.srcTarget,a=n.handler;return setTimeout((function(){t[e]&&o.addEventListener(r,a,u)}),0)}))}},i=function(t){(t[e]||[]).forEach((function(e){return e.srcTarget.removeEventListener(e.event,e.handler,e.capture)})),delete t[e]},s=t?{beforeMount:a,updated:function(e,t){var n=t.value,r=t.oldValue;JSON.stringify(n)!==JSON.stringify(r)&&(i(e),a(e,{value:n}))},unmounted:i}:{};return{install:function(e){e.directive("click-outside",s)},directive:s}}))},44106:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});n(59749),n(86544),n(60228),n(84254),n(21694),n(76265),n(21057);var r=n(12780);function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(c)throw i}}}}var a=n(50124),i=n(48534),s=n(13087),c=n(62833),u=(n(34338),n(66252)),l=n(24150),m=function(){function e(){(0,s.Z)(this,e)}return(0,c.Z)(e,[{key:"create",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,r,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=new FormData,n.append("type",t.type),t.post_id&&n.append("post_id",t.post_id),t.book_id&&n.append("book_id",t.book_id),t.comment_id&&n.append("comment_id",t.comment_id),t.body&&n.append("body",t.body),t.screenShots&&t.screenShots.length>0)for(r=0;r<t.screenShots.length;r++)n.append("screenShots[]",t.screenShots[r]);return t.start_page&&n.append("start_page",t.start_page),t.end_page&&n.append("end_page",t.end_page),t.image&&n.append("image",t.image),e.prev=10,e.next=13,l.hi.post("/comments",n,{headers:{"Content-type":"multipart/form-data"}});case 13:return o=e.sent,e.abrupt("return",o.data);case 17:e.prev=17,e.t0=e["catch"](10),(0,u.S3)(e.t0);case 20:case"end":return e.stop()}}),e,null,[[10,17]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getPostComments",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n){var r,o,i=arguments;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:"",e.prev=1,e.next=4,l.hi.get("/comments/post/".concat(t,"/").concat(r,"?page=").concat(n));case 4:return o=e.sent,e.abrupt("return",o.data);case 8:e.prev=8,e.t0=e["catch"](1),(0,u.S3)(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getPostCommentsUsers",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.get("/comments/post/".concat(t,"/users"));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var n,r,i,s,c,m;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=new FormData,n.append("u_comment_id",t.u_comment_id),t.body&&n.append("body",t.body),t.screenShots&&t.screenShots.length>0)for(r=0;r<t.screenShots.length;r++)n.append("screenShots[]",t.screenShots[r]);t.start_page&&n.append("start_page",t.start_page),t.end_page&&n.append("end_page",t.end_page),t.image&&n.append("image",t.image),i=o(n.entries());try{for(i.s();!(s=i.n()).done;)c=s.value,console.log("".concat(c[0],", ").concat(c[1]))}catch(a){i.e(a)}finally{i.f()}return e.prev=9,e.next=12,l.hi.post("/comments/update",n,{"Content-type":"multipart/form-data"});case 12:return m=e.sent,e.abrupt("return",m.data);case 16:e.prev=16,e.t0=e["catch"](9),(0,u.S3)(e.t0);case 19:case"end":return e.stop()}}),e,null,[[9,16]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.hi.delete("/comments/".concat(t));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e["catch"](0),(0,u.S3)(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),d=new m},80932:function(e,t,n){"use strict";var r=n(50124),o=n(48534),a=n(13087),i=n(62833),s=(n(69358),n(34338),n(66252)),c=n(24150),u=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"getAllReactionTypes",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.hi.get("/reactions/types");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,s.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getStoredReactions",value:function(){return JSON.parse(localStorage.getItem("reactions"))}},{key:"reactOnPost",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var o;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.hi.get("/reactions/posts/".concat(t,"/types/").concat(n));case 3:return o=e.sent,e.abrupt("return",o.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,s.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"reactOnComment",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var o;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.hi.get("/reactions/comments/".concat(t,"/types/").concat(n));case 3:return o=e.sent,e.abrupt("return",o.data);case 7:e.prev=7,e.t0=e["catch"](0),(0,s.S3)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getPostReactionsUsers",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,o,a=arguments;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",e.prev=1,e.next=4,c.hi.get("/reactions/posts/".concat(t,"/users/").concat(n));case 4:return o=e.sent,e.abrupt("return",o.data);case 8:e.prev=8,e.t0=e["catch"](1),(0,s.S3)(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t.Z=new u},60351:function(e,t,n){"use strict";n.d(t,{So:function(){return r},Wx:function(){return a},b5:function(){return s},gg:function(){return i},jx:function(){return o}});var r={ambassador:"سفير",leader:"قائد",supervisor:"مراقب",advisor:"موجه",consultant:"مستشار",admin:"ادارة",book_quality_team:"جودة الكتب"},o={arabic:"اللغة العربية",english:"اللغة الانجليزية"},a={normal:"منهج",ramadan:"رمضان",young:"يافعين",kids:"أطفال",tafseer:"تفسير",free:"كتاب حر"},i={January:"يناير",February:"فبراير",March:"مارس",April:"ابريل",May:"مايو",June:"يونيو",July:"يوليو",August:"أغسطس",September:"سبتمبر",October:"أكتوبر",November:"نوفمبر",December:"ديسمبر"},s={"01":"يناير","02":"فبراير","03":"مارس","04":"ابريل","05":"مايو","06":"يونيو","07":"يوليو","08":"أغسطس","09":"سبتمبر",10:"أكتوبر",11:"نوفمبر",12:"ديسمبر"}},73210:function(e,t,n){"use strict";n.d(t,{Z:function(){return te}});var r=n(66252),o=n(3577),a=n(49963),i=function(e){return(0,r.dD)("data-v-460b2d5e"),e=e(),(0,r.Cn)(),e},s={class:"blog-description"},c={class:"row"},u={key:0,class:"row"},l={class:"col-6 form-group"},m={class:"form-control-plaintext"},d={class:"col-6 form-group"},p={class:"form-control-plaintext"},f={key:0},h={key:0,class:"text-muted text-sm ms-1",style:{"font-size":"0.7rem"}},v={key:0,style:{"white-space":"pre-wrap",direction:"rtl"}},g=["data-bs-target"],w={class:"d-flex flex-wrap align-items-center comment-activity"},y={href:"javascript:void();"},b={key:0,class:"me-1"},k={key:0,class:"comment-list"},x={class:"post-comments list-inline p-0 m-0"},_=i((function(){return(0,r._)("a",{href:"javascript:void(0);",class:"lh-1","data-bs-dismiss":"modal"},[(0,r._)("span",{class:"material-symbols-outlined"},"close")],-1)}));function C(e,t,n,i,C,Z){var D=(0,r.up)("CommentHeader"),R=(0,r.up)("CreateComment"),E=(0,r.up)("BaseImage"),S=(0,r.up)("tooltip"),$=(0,r.up)("Comment",!0),T=(0,r.up)("model-header"),B=(0,r.up)("model-body"),I=(0,r.up)("modal");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(D,{comment:n.comment,onTriggerEditBox:Z.triggerEditBox},null,8,["comment","onTriggerEditBox"]),(0,r._)("div",s,[(0,r._)("div",c,[n.comment.thesis?((0,r.wg)(),(0,r.iD)("div",u,[(0,r._)("div",l,[(0,r._)("label",m,"صفحة البداية: "+(0,o.zw)(n.comment.thesis.start_page),1)]),(0,r._)("div",d,[(0,r._)("label",p,"صفحة النهاية: "+(0,o.zw)(n.comment.thesis.end_page),1)])])):(0,r.kq)("",!0)]),n.totalThesisPages>0?((0,r.wg)(),(0,r.iD)("h6",f,[(0,r.Uk)(" الصفحات المنجزة: "+(0,o.zw)(n.totalThesisPages)+" ",1),n.comment.body||n.comment.media?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("span",h,"قراءة فقط"))])):(0,r.kq)("",!0),C.showEditBox?((0,r.wg)(),(0,r.j4)(R,{key:1,isEdit:!0,ref:"commentEditRef",comment:n.comment,onEditComment:Z.editComment,onCancelEdit:Z.cancelEdit},null,8,["comment","onEditComment","onCancelEdit"])):((0,r.wg)(),(0,r.iD)(r.HY,{key:2},[n.comment.body?((0,r.wg)(),(0,r.iD)("p",v,[(0,r.Uk)((0,o.zw)(C.briefBody)+" ",1),n.comment.body.length>C.briefBody.length?((0,r.wg)(),(0,r.iD)("a",{key:0,class:"load-btn",href:"#",onClick:t[0]||(t[0]=(0,a.iM)((function(e){return C.briefBody=n.comment.body}),["prevent"]))},"عرض المزيد")):(0,r.kq)("",!0)])):(0,r.kq)("",!0),n.comment.media?((0,r.wg)(),(0,r.iD)("div",{key:1,class:"image-block mt-3 mb-3","data-bs-toggle":"modal","data-bs-target":"#imgModal-".concat(n.comment.id)},[(0,r.Wm)(E,{mediaID:n.comment.media.id,classes:"img-fluid rounded w-50 comment-image",alt:"blog-img"},null,8,["mediaID"])],8,g)):(0,r.kq)("",!0),(0,r._)("div",w,[(0,r.Wm)(S,{tag:"span",class:"text-muted small",tooltipPlacement:"bottom","data-bs-toggle":"tooltip",title:e.formatFullDate(n.comment.created_at)},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,o.zw)(e.formatDateToWritten(n.comment.created_at)),1)]})),_:1},8,["title"]),(0,r.Uk)("    "),(0,r._)("a",y,[n.comment.reactions_count>0?((0,r.wg)(),(0,r.iD)("span",b,(0,o.zw)(n.comment.reactions_count),1)):(0,r.kq)("",!0),(0,r._)("span",{style:(0,o.j5)({color:"like"===C.selectedReaction.type?n.comment.is_liked?C.selectedReaction.text_color:"#555770":C.selectedReaction.text_color}),onClick:t[1]||(t[1]=(0,a.iM)((function(e){return Z.reactOnComment(C.selectedReaction.id)}),["prevent"]))},(0,o.zw)(C.selectedReaction.title),5)]),n.allowComment?((0,r.wg)(),(0,r.iD)("a",{key:0,href:"javascript:void();",onClick:t[2]||(t[2]=function(){return Z.showReply&&Z.showReply.apply(Z,arguments)}),style:{color:"#555770"}},(0,o.zw)(C.showReplyBox?"إخفاء":"رد"),1)):(0,r.kq)("",!0)]),Z.hasReplies?((0,r.wg)(),(0,r.iD)("a",{key:2,role:"button",class:"load-btn",onClick:t[3]||(t[3]=function(){return Z.toggleShowReplies&&Z.toggleShowReplies.apply(Z,arguments)})},(0,o.zw)(C.showReplies?"إخفاء ".concat(Z.totalReplies," من الردود"):"عرض ".concat(Z.totalReplies," من الردود")),1)):(0,r.kq)("",!0)],64))]),n.comment.replies&&C.showReplies?((0,r.wg)(),(0,r.iD)("div",k,[(0,r._)("ul",x,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.comment.replies,(function(e){return(0,r.wg)(),(0,r.iD)("li",{class:"mb-2",key:e.id},[(0,r.Wm)($,{allowComment:n.allowComment,comment:e,onAddComment:Z.addComment,onEditComment:Z.editComment,onReactToComment:Z.reactToComment},null,8,["allowComment","comment","onAddComment","onEditComment","onReactToComment"])])})),128))])])):(0,r.kq)("",!0),C.showReplyBox?((0,r.wg)(),(0,r.j4)(R,{key:1,ref:"commentReplyRef",comment:n.comment,type:"reply",onAddComment:Z.addComment},null,8,["comment","onAddComment"])):(0,r.kq)("",!0),(0,r.Wm)(I,{id:"imgModal-".concat(n.comment.id),dialogClass:"modal-dialog-centered modal-lg",tabindex:"-1","aria-labelledby":"displayImageLabel","aria-hidden":!1},{default:(0,r.w5)((function(){return[(0,r.Wm)(T,null,{default:(0,r.w5)((function(){return[_]})),_:1}),(0,r.Wm)(B,null,{default:(0,r.w5)((function(){return[n.comment.media?((0,r.wg)(),(0,r.j4)(E,{key:0,mediaID:n.comment.media.id,class:"img-fluid rounded w-100",alt:"blog-img"},null,8,["mediaID"])):(0,r.kq)("",!0)]})),_:1})]})),_:1},8,["id"])],64)}var Z=n(50124),D=n(48534),R=n(95082);n(79288),n(60228),n(47522);var E=n(83744);var S=n(19250);var $=n(20425),T=n.n($);T().directive;n(28436);var B=function(e){return(0,r.dD)("data-v-535f7722"),e=e(),(0,r.Cn)(),e},I={class:"d-flex align-items-center justify-content-center mb-3"},q={class:"ms-3 flex-grow-1"},A={key:0,class:"mt-1"},M={key:0,class:"card-post-toolbar d-flex align-items-center"},O=["data-bs-target"],j=B((function(){return(0,r._)("span",{class:"material-symbols-outlined me-2 md-18"}," edit ",-1)})),z=[j],P=B((function(){return(0,r._)("span",{class:"material-symbols-outlined me-2 md-18"}," edit ",-1)})),U=[P],L=B((function(){return(0,r._)("span",{class:"material-symbols-outlined me-2 md-18"}," delete ",-1)})),W=[L];function F(e,t,n,i,s,c){var u,l,m,d,p,f,h,v=(0,r.up)("BaseAvatar");return(0,r.wg)(),(0,r.iD)("div",I,[(0,r.Wm)(v,{profileImg:null===(u=n.comment.user)||void 0===u?void 0:u.user_profile.profile_picture,profile_id:null===(l=n.comment.user)||void 0===l?void 0:l.user_profile.id,title:null===(m=n.comment.user)||void 0===m?void 0:m.name,gender:null===(d=n.comment.user)||void 0===d?void 0:d.gender,avatarClass:"rounded-circle avatar-50"},null,8,["profileImg","profile_id","title","gender"]),(0,r._)("div",q,[(0,r._)("h5",{role:"button",class:"author-name hover-undelined",onClick:t[0]||(t[0]=(0,a.iM)((function(e){return c.sendToProfile(n.comment.user.id)}),["prevent"]))},(0,o.zw)(null===(p=n.comment.user)||void 0===p?void 0:p.name),1),(null===(f=n.comment.user)||void 0===f||null===(f=f.roles)||void 0===f?void 0:f.length)>0?((0,r.wg)(),(0,r.iD)("div",A,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(null===(h=n.comment.user)||void 0===h?void 0:h.roles,(function(e){return(0,r.wg)(),(0,r.iD)("span",{class:"badge bg-primary rounded-pill ms-1 px-2",key:e.name},(0,o.zw)(s.ARABIC_ROLES[e.name]),1)})),128))])):(0,r.kq)("",!0)]),c.authorized&&c.showOptions?((0,r.wg)(),(0,r.iD)("div",M,[(0,r._)("div",null,[c.canEdit?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},["thesis"===n.comment.type||"screenshot"===n.comment.type?((0,r.wg)(),(0,r.iD)("a",{key:0,class:"d-flex align-items-center",href:"#","data-bs-toggle":"modal","data-bs-target":"#editThesis-".concat("screenshot"===n.comment.type.trim()?n.comment.comment_id:n.comment.id)},z,8,O)):((0,r.wg)(),(0,r.iD)("a",{key:1,class:"d-flex align-items-center",href:"#",onClick:t[1]||(t[1]=(0,a.iM)((function(){return c.editCmnt&&c.editCmnt.apply(c,arguments)}),["prevent"]))},U))],64)):(0,r.kq)("",!0),c.canDelete?((0,r.wg)(),(0,r.iD)("a",{key:1,class:"d-flex align-items-center",href:"#",onClick:t[2]||(t[2]=(0,a.iM)((function(){return c.deleteCmnt&&c.deleteCmnt.apply(c,arguments)}),["prevent"]))},W)):(0,r.kq)("",!0)])])):(0,r.kq)("",!0)])}n(70560);var H=n(49579),N=n(31025),J=n(44106),Y=n(60351),K={name:"CommentUser",inject:{deleteComment:{default:function(){}}},props:{comment:{type:Object,required:!0}},emits:["triggerEditBox"],data:function(){return{showDropdown:!1,deleteLoading:!1,confirmationText:"",successText:"",ARABIC_ROLES:Y.So}},computed:{authorized:function(){return this.canEdit||this.canDelete},canEdit:function(){var e;return(null===(e=this.comment)||void 0===e||null===(e=e.user)||void 0===e?void 0:e.id)==this.$store.getters.getUser.id},canDelete:function(){var e,t=this.$store.getters.getUser;return(null===(e=this.comment)||void 0===e||null===(e=e.user)||void 0===e?void 0:e.id)===t.id&&H.Z.hasPermission(t,"delete comment")||H.Z.hasRole(t,"admin")},showOptions:function(){var e,t,n,r="thesis"===(null===(e=this.comment)||void 0===e?void 0:e.type)||"screenshot"===(null===(t=this.comment)||void 0===t?void 0:t.type);if(!r)return!0;var o=new Date(null===(n=this.comment)||void 0===n?void 0:n.created_at),a=new Date(this.$store.state.week_start_date),i=new Date(this.$store.state.main_timer);return o>=a&&o<=i}},created:function(){this.confirmationText="thesis"===this.comment.type||"screenshot"===this.comment.type?"سيتم حذف الأطروحة نهائياً, وخصم علامتها!":"سيتم حذف التعليق نهائياً!",this.successText="thesis"===this.comment.type||"screenshot"===this.comment.type?"تم حذف الأطروحة نهائياً, وخصم علامتها!":"تم حذف التعليق!"},methods:{resolve_img_url:function(e){return e||n(23062)},toggleDropdown:function(){this.showDropdown=!this.showDropdown},hideDropdown:function(){this.showDropdown=!1},deleteCmnt:function(){var e=this;return(0,D.Z)((0,Z.Z)().mark((function t(){var n;return(0,Z.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-danger btn-lg ms-2"},buttonsStyling:!1}),!e.canDelete){t.next=7;break}if(!e.deleteLoading){t.next=4;break}return t.abrupt("return");case 4:n.fire({title:"هل أنت متأكد؟",text:e.confirmationText,icon:"warning",showCancelButton:!0,confirmButtonText:"نعم, احذف!",cancelButtonText:"تراجع",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then(function(){var t=(0,D.Z)((0,Z.Z)().mark((function t(n){return(0,Z.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.isConfirmed){t.next=16;break}return e.deleteLoading=!0,t.prev=2,t.next=5,J.Z.delete(e.comment.id);case 5:e.deleteComment(e.comment.id),N.Z.handleSuccessSwal(e.successText),"thesis"!==e.comment.type&&"screenshot"!==e.comment.type||setTimeout((function(){return location.reload()}),1800),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),N.Z.handleErrorSwal("حدث خطأ أثناء الحذف, يرجى المحاولة مرة أخرى!");case 13:return t.prev=13,e.deleteLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[2,10,13,16]])})));return function(e){return t.apply(this,arguments)}}()),t.next=9;break;case 7:return N.Z.toggleToast("لا يمكنك حذف هذا التعليق","error"),t.abrupt("return");case 9:case"end":return t.stop()}}),t)})))()},editCmnt:function(){var e=this;return(0,D.Z)((0,Z.Z)().mark((function t(){return(0,Z.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.showDropdown=!1,e.$emit("triggerEditBox");case 2:case"end":return t.stop()}}),t)})))()},sendToProfile:function(e){this.$router.push({name:"user.profile",params:{user_id:e}})}}};const V=(0,E.Z)(K,[["render",F],["__scopeId","data-v-535f7722"]]);var G=V,Q=n(80932),X={name:"Comment",components:{CreateComment:S.Z,CommentHeader:G},emits:["addComment","editComment","reactToComment"],props:{comment:{type:Object,required:!0},totalThesisPages:{type:Number,required:!1},allowComment:{type:[Boolean,Number],default:!0}},data:function(){return{showReplies:!1,showReplyBox:!1,showEditBox:!1,selectedReaction:{id:1,title:"إعجاب",type:"like",text_color:"#278036"},pendingRequest:!1,briefBody:""}},computed:{hasReplies:function(){var e,t;return(null===(e=this.comment)||void 0===e?void 0:e.replies)&&(null===(t=this.comment)||void 0===t?void 0:t.replies.length)>0},totalReplies:function(){var e,t=function e(t,n){return n=n||0,t.length>0&&(n+=t.length,t.forEach((function(t){t.replies.length>0&&(n=e(t.replies,n))}))),n};return t(null===(e=this.comment)||void 0===e?void 0:e.replies)}},created:function(){this.briefBody=this.comment.body?this.comment.body.length>200?this.comment.body.substring(0,200)+"...":this.comment.body:""},methods:(0,R.Z)((0,R.Z)({},N.Z),{},{toggleShowReplies:function(){this.showReplies=!this.showReplies},showReply:function(){var e=this;this.showReplyBox=!this.showReplyBox,this.showReplyBox&&this.$nextTick((function(){e.$refs.commentReplyRef.focusInput()}))},addComment:function(e,t){this.$emit("addComment",e,t),this.showReplies=!0,this.showReplyBox=!1},triggerEditBox:function(){var e=this;this.showEditBox||(this.showEditBox=!0,this.$nextTick((function(){e.$refs.commentEditRef.focusInput()})))},editComment:function(e){var t=this;return(0,D.Z)((0,Z.Z)().mark((function n(){return(0,Z.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$emit("editComment",e),t.showEditBox=!1;case 2:case"end":return n.stop()}}),n)})))()},cancelEdit:function(){this.showEditBox=!1},reactToComment:function(e,t){this.$emit("reactToComment",e,t)},reactOnComment:function(e){var t=this;return(0,D.Z)((0,Z.Z)().mark((function n(){var r;return(0,Z.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.pendingRequest){n.next=2;break}return n.abrupt("return");case 2:return t.pendingRequest=!0,n.prev=3,n.next=6,Q.Z.reactOnComment(t.comment.id,e);case 6:if(r=n.sent,200===r.statusCode){n.next=10;break}return N.Z.toggleToast("حدث خطأ ما, يرجى المحاولة لاحقاً","error"),n.abrupt("return");case 10:t.$emit("reactToComment",t.comment.id,r.data),n.next=17;break;case 13:n.prev=13,n.t0=n["catch"](3),console.log("[comment reaction error]",n.t0.response),N.Z.toggleToast("حدث خطأ ما, يرجى المحاولة لاحقاً","error");case 17:return n.prev=17,t.pendingRequest=!1,n.finish(17);case 20:case"end":return n.stop()}}),n,null,[[3,13,17,20]])})))()}})};const ee=(0,E.Z)(X,[["render",C],["__scopeId","data-v-460b2d5e"]]);var te=ee},19250:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(66252),o=n(49963),a=n(3577),i=function(e){return(0,r.dD)("data-v-64cfee5d"),e=e(),(0,r.Cn)(),e},s={class:"d-flex flex-column"},c=["rows"],u={key:0,class:"comment-attagement right d-flex mb-1"},l=["disabled"],m={class:"comment-attagement d-flex mb-1"},d={key:0,class:"preview-images"},p={class:"image-container"},f=i((function(){return(0,r._)("span",null," x ",-1)})),h=[f],v=["src"],g={key:1,class:"mt-2"},w=["disabled"];function y(e,t,n,i,f,y){return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("form",{class:"comment-text d-flex align-items-end mt-3",onSubmit:t[3]||(t[3]=(0,o.iM)((function(){return y.addComment&&y.addComment.apply(y,arguments)}),["prevent"]))},[(0,r.wy)((0,r._)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return i.v$.commentData.body.$model=e}),class:"form-control rounded",placeholder:"أضف تعليق",style:(0,a.j5)([{"padding-right":n.isEdit?"1rem !important":"3rem !important"},{direction:"rtl","max-height":"120px",resize:"none",overflow:"auto"}]),rows:n.isEdit?4:1,ref:"bodyRef"},null,12,c),[[o.nr,i.v$.commentData.body.$model,void 0,{trim:!0}]]),n.isEdit?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",u,[(0,r._)("button",{type:"submit",class:(0,a.C_)(["material-symbols-outlined ms-2 border-0 bg-transparent",{"text-primary":!i.v$.commentData.$invalid,disabled:i.v$.commentData.$invalid}]),disabled:i.v$.commentData.$invalid||f.loading}," Send ",10,l)])),(0,r._)("div",m,[(0,r._)("input",{type:"file",ref:"imageInput",class:"d-none",onChange:t[1]||(t[1]=function(){return y.uploadImage&&y.uploadImage.apply(y,arguments)}),accept:"image/*"},null,544),(0,r._)("a",{href:"javascript:void(0);",class:"material-symbols-outlined me-3",onClick:t[2]||(t[2]=function(){return y.chooseImage&&y.chooseImage.apply(y,arguments)})}," photo_camera ")])],32),f.fileSrc?((0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("div",p,[(0,r._)("div",{class:"delete-image",onClick:t[4]||(t[4]=function(){return y.removeMedia&&y.removeMedia.apply(y,arguments)})},h),(0,r._)("img",{src:f.fileSrc},null,8,v)])])):(0,r.kq)("",!0),n.isEdit?((0,r.wg)(),(0,r.iD)("div",g,[(0,r._)("button",{class:"btn btn-primary btn-sm me-2",onClick:t[5]||(t[5]=(0,o.iM)((function(){return y.editComment&&y.editComment.apply(y,arguments)}),["prevent"])),disabled:f.loading}," تعديل ",8,w),(0,r._)("button",{class:"btn btn-danger btn-sm",onClick:t[6]||(t[6]=(0,o.iM)((function(t){return e.$emit("cancelEdit")}),["prevent"]))}," إلغاء ")])):(0,r.kq)("",!0)])}var b=n(50124),k=n(48534),x=(n(79288),n(5705)),_=n(10760),C=n(44106),Z=n(31025),D={name:"CreateComment",setup:function(){var e=(0,x.ZP)();return{v$:e}},emits:["addComment","editComment","cancelEdit"],props:{comment:{type:Object,default:function(){return{}}},type:{type:String,default:""},post_id:{type:Number,default:null},isEdit:{type:Boolean,default:!1}},data:function(){var e,t,n,r,o;return{fileSrc:this.isEdit&&null!==(e=null===(t=this.comment)||void 0===t||null===(t=t.media)||void 0===t?void 0:t.path)&&void 0!==e?e:"",loading:!1,commentData:{body:this.isEdit&&null!==(n=null===(r=this.comment)||void 0===r?void 0:r.body)&&void 0!==n?n:"",image:null,book_id:this.$route.params.book_id,comment_id:this.comment.id,post_id:null!==(o=this.comment.post_id)&&void 0!==o?o:this.post_id,type:this.type}}},computed:{commentBody:function(){return this.commentData.body}},watch:{commentBody:function(){var e=this;this.$refs.bodyRef.style.height="auto",this.$nextTick((function(){e.$refs.bodyRef.style.height=e.$refs.bodyRef.scrollHeight+"px"}))}},methods:{focusInput:function(){this.$refs.commentInput.focus()},chooseImage:function(){this.$refs.imageInput.click()},uploadImage:function(e){var t=this,n=e.target.files[0];this.commentData.image=n;var r=new FileReader;r.onload=function(){t.fileSrc=r.result},r.readAsDataURL(n)},removeMedia:function(){this.fileSrc="",this.$refs.imageInput.value=null},addComment:function(){var e=this;return(0,k.Z)((0,b.Z)().mark((function t(){var n,r;return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:if(e.v$.$touch(),e.v$.commentData.$invalid){t.next=30;break}return e.loading=!0,t.prev=5,t.next=8,C.Z.create(e.commentData);case 8:if(r=t.sent,200===r.statusCode){t.next=12;break}return Z.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى"),t.abrupt("return");case 12:e.$emit("addComment",r.data,null===(n=e.comment)||void 0===n?void 0:n.id),e.commentData.body="",e.commentData.image=null,e.$refs.imageInput.value="",e.fileSrc="",e.v$.$reset(),Z.Z.toggleToast("تم إضافة التعليق ","success"),t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](5),console.log("[add comment error]",t.t0),Z.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى");case 25:return t.prev=25,e.loading=!1,t.finish(25);case 28:t.next=31;break;case 30:Z.Z.toggleToast("يرجى إدخال البيانات","error");case 31:case"end":return t.stop()}}),t,null,[[5,21,25,28]])})))()},editComment:function(){var e=this;return(0,k.Z)((0,b.Z)().mark((function t(){var n,r;return(0,b.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:if(e.v$.$touch(),e.v$.commentData.$invalid){t.next=25;break}return e.loading=!0,t.prev=5,n={body:e.commentData.body,u_comment_id:e.comment.id,image:e.commentData.image},t.next=9,C.Z.update(n);case 9:if(r=t.sent,200===r.statusCode){t.next=13;break}return Z.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى"),t.abrupt("return");case 13:e.$emit("editComment",r.data),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),Z.Z.handleErrorSwal("حدث خطأ ما, حاول مرة أخرى");case 19:return t.prev=19,e.loading=!1,t.finish(19);case 22:Z.Z.toggleToast("تم تعديل التعليق ","success"),t.next=26;break;case 25:Z.Z.toggleToast("يرجى إدخال البيانات","error");case 26:case"end":return t.stop()}}),t,null,[[5,16,19,22]])})))()}},validations:function(){var e=this;return{commentData:{body:{required:(0,_.CF)((function(){return!e.commentData.image}))},image:{required:(0,_.CF)((function(){return!e.commentData.body}))}}}}},R=n(83744);const E=(0,R.Z)(D,[["render",y],["__scopeId","data-v-64cfee5d"]]);var S=E},23062:function(e,t,n){"use strict";e.exports=n.p+"img/avatar-01.304828cc.jpg"},98494:function(e,t,n){"use strict";var r=n(23691),o=TypeError;e.exports=function(e,t){if(!delete e[t])throw new o("Cannot delete property "+r(t)+" of "+r(e))}},62506:function(e,t,n){"use strict";var r=n(79989),o=n(90690),a=n(27578),i=n(68700),s=n(6310),c=n(5649),u=n(55565),l=n(27120),m=n(76522),d=n(98494),p=n(29042),f=p("splice"),h=Math.max,v=Math.min;r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,p,f,g,w,y=o(this),b=s(y),k=a(e,b),x=arguments.length;for(0===x?n=r=0:1===x?(n=0,r=b-k):(n=x-2,r=v(h(i(t),0),b-k)),u(b+n-r),p=l(y,r),f=0;f<r;f++)g=k+f,g in y&&m(p,f,y[g]);if(p.length=r,n<r){for(f=k;f<b-r;f++)g=f+r,w=f+n,g in y?y[w]=y[g]:d(y,w);for(f=b;f>b-r+n;f--)d(y,f-1)}else if(n>r)for(f=b-r;f>k;f--)g=f+r-1,w=f+n-1,g in y?y[w]=y[g]:d(y,w);for(f=0;f<n;f++)y[f+k]=arguments[f+2];return c(y,b-r+n),p}})}}]);
//# sourceMappingURL=1876-legacy.87ceafdf.js.map